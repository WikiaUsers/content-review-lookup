var themehouse=themehouse||{};
themehouse.holidayFirework={config:{initialLoad:0,startAfter:0,endAfter:5,fireworkAcceleration:1.05,fireworkBrightnessMin:50,fireworkBrightnessMax:70,fireworkSpeed:5,fireworkTrailLength:3,fireworkTargetIndicator:!1,particleBrightnessMin:50,particleBrightnessMax:80,particleCount:80,particleDecayMin:.015,particleDecayMax:.03,particleFriction:.95,particleGravity:.7,particleHueVariance:20,particleTransparency:1,particleSpeedMin:1,particleSpeedMax:10,particleTrailLength:5,canvasCleanupAlpha:.15,hueStepIncrease:.5,
ticksPerFireworkMin:5,ticksPerFireworkAutomatedMin:20,ticksPerFireworkAutomatedMax:80},parent:null,context:null,width:0,height:0,isMouseDown:!1,hue:120,active:!1,animationFrame:!1,ticksSinceFireworkAutomated:0,ticksSinceFirework:0,fireworks:[],particles:[],random:function(a,b){return Math.random()*(b-a)+a},calculateDistance:function(a,b,c,d){return Math.sqrt(Math.pow(a-c,2)+Math.pow(b-d,2))},resize:function(){themehouse.holidayFirework.width=themehouse.holidayFirework.parent.width=window.innerWidth;
themehouse.holidayFirework.height=themehouse.holidayFirework.parent.height=window.innerHeight},init:function(a){Object.assign(themehouse.holidayFirework.config,a);if(themehouse.holidayFirework.config.initialLoad)if(1!=XF.LocalStorage.get("th_fireworks_fired"))XF.LocalStorage.set("th_fireworks_fired",1);else return!0;themehouse.holidayFirework.parent=document.getElementById("fest_canvas");themehouse.holidayFirework.context=themehouse.holidayFirework.parent.getContext("2d");themehouse.holidayFirework.resize();
window.addEventListener("resize",function(){themehouse.holidayFirework.resize()});themehouse.holidayFirework.parent.addEventListener("mousemove",function(a){themehouse.holidayFirework.mouseX=a.pageX-themehouse.holidayFirework.parent.offsetLeft;themehouse.holidayFirework.mouseY=a.pageY-themehouse.holidayFirework.parent.offsetTop});themehouse.holidayFirework.parent.addEventListener("mousedown",function(a){a.preventDefault();themehouse.holidayFirework.isMouseDown=!0});themehouse.holidayFirework.parent.addEventListener("mouseup",
function(a){a.preventDefault();themehouse.holidayFirework.isMouseDown=!1});setTimeout(function(){themehouse.holidayFirework.active=themehouse.holidayFirework.animationFrame=!0;setTimeout(function(){themehouse.holidayFirework.active=!1;setTimeout(function(){themehouse.holidayFirework.animationFrame=!1},7500)},1E3*themehouse.holidayFirework.config.endAfter);themehouse.holidayFirework.frame()},1E3*themehouse.holidayFirework.config.startAfter)},frame:function(){themehouse.holidayFirework.hue+=themehouse.holidayFirework.config.hueStepIncrease;
themehouse.holidayFirework.cleanCanvas();themehouse.holidayFirework.updateFireworks();themehouse.holidayFirework.updateParticles();themehouse.holidayFirework.active&&(themehouse.holidayFirework.launchAutomatedFirework(),themehouse.holidayFirework.launchManualFirework());themehouse.holidayFirework.animationFrame&&window.requestAnimationFrame(function(){themehouse.holidayFirework.frame()})},updateFireworks:function(){for(var a=themehouse.holidayFirework.fireworks.length-1;0<=a;--a)themehouse.holidayFirework.fireworks[a].draw(),
themehouse.holidayFirework.fireworks[a].update(a)},updateParticles:function(){for(var a=themehouse.holidayFirework.particles.length-1;0<=a;--a)themehouse.holidayFirework.particles[a].draw(),themehouse.holidayFirework.particles[a].update(a)},cleanCanvas:function(){themehouse.holidayFirework.context.globalCompositeOperation="destination-out";themehouse.holidayFirework.context.fillStyle="rgba(0, 0, 0, "+themehouse.holidayFirework.config.canvasCleanupAlpha+")";themehouse.holidayFirework.context.fillRect(0,
0,themehouse.holidayFirework.width,themehouse.holidayFirework.height);themehouse.holidayFirework.context.globalCompositeOperation="lighter"},launchManualFirework:function(){themehouse.holidayFirework.ticksSinceFirework>=themehouse.holidayFirework.config.ticksPerFireworkMin?themehouse.holidayFirework.isMouseDown&&(themehouse.holidayFirework.fireworks.push(new themehouse.holidayFirework.firework(themehouse.holidayFirework.width/2,themehouse.holidayFirework.height,themehouse.holidayFirework.mouseX,themehouse.holidayFirework.mouseY)),
themehouse.holidayFirework.ticksSinceFirework=0):themehouse.holidayFirework.ticksSinceFirework++},launchAutomatedFirework:function(){if(themehouse.holidayFirework.ticksSinceFireworkAutomated>=themehouse.holidayFirework.random(themehouse.holidayFirework.config.ticksPerFireworkAutomatedMin,themehouse.holidayFirework.config.ticksPerFireworkAutomatedMax)){if(!themehouse.holidayFirework.isMouseDown){var a=themehouse.holidayFirework.width/2,b=themehouse.holidayFirework.height,c=themehouse.holidayFirework.random(0,
themehouse.holidayFirework.width),d=themehouse.holidayFirework.random(0,themehouse.holidayFirework.height/2);themehouse.holidayFirework.fireworks.push(new themehouse.holidayFirework.firework(a,b,c,d));themehouse.holidayFirework.ticksSinceFireworkAutomated=0}}else themehouse.holidayFirework.ticksSinceFireworkAutomated++}};themehouse.holidayFirework.firework=function(a,b,c,d){this.__construct(a,b,c,d)};
themehouse.holidayFirework.firework.prototype={__construct:function(a,b,c,d){this.x=a;this.y=b;this.startX=a;this.startY=b;this.endX=c;this.endY=d;this.distanceToEnd=themehouse.holidayFirework.calculateDistance(a,b,c,d);this.distanceTraveled=0;this.trail=[];for(this.trailLength=themehouse.holidayFirework.config.fireworkTrailLength;this.trailLength--;)this.trail.push([this.x,this.y]);this.angle=Math.atan2(d-b,c-a);this.speed=themehouse.holidayFirework.config.fireworkSpeed;this.acceleration=themehouse.holidayFirework.config.fireworkAcceleration;
this.brightness=themehouse.holidayFirework.random(themehouse.holidayFirework.config.fireworkBrightnessMin,themehouse.holidayFirework.config.fireworkBrightnessMax);this.targetRadius=2.5},update:function(a){this.trail.pop();this.trail.unshift([this.x,this.y]);themehouse.holidayFirework.config.fireworkTargetIndicator&&(this.targetRadius=8>this.targetRadius?this.targetRadius+.3:1);this.speed*=this.acceleration;var b=Math.cos(this.angle)*this.speed,c=Math.sin(this.angle)*this.speed;this.distanceTraveled=
themehouse.holidayFirework.calculateDistance(this.startX,this.startY,this.x+b,this.y+c);this.distanceTraveled>=this.distanceToEnd?(themehouse.holidayFirework.fireworks.splice(a,1),this.createParticles(this.endX,this.endY)):(this.x+=b,this.y+=c)},draw:function(){themehouse.holidayFirework.context.beginPath();themehouse.holidayFirework.context.moveTo(this.trail[this.trail.length-1][0],this.trail[this.trail.length-1][1]);themehouse.holidayFirework.context.lineTo(this.x,this.y);themehouse.holidayFirework.context.strokeStyle=
"hsl("+themehouse.holidayFirework.hue+", 100%, "+this.brightness+"%)";themehouse.holidayFirework.context.stroke();themehouse.holidayFirework.config.fireworkTargetIndicator&&(themehouse.holidayFirework.context.beginPath(),themehouse.holidayFirework.context.arc(this.endX,this.endY,this.targetRadius,0,2*Math.PI),themehouse.holidayFirework.context.stroke())},createParticles:function(a,b){for(var c=themehouse.holidayFirework.config.particleCount;c--;)themehouse.holidayFirework.particles.push(new themehouse.holidayFirework.particle(a,
b))}};themehouse.holidayFirework.particle=function(a,b){this.__construct(a,b)};
themehouse.holidayFirework.particle.prototype={__construct:function(a,b){this.x=a;this.y=b;this.angle=themehouse.holidayFirework.random(0,2*Math.PI);this.friction=themehouse.holidayFirework.config.particleFriction;this.gravity=themehouse.holidayFirework.config.particleGravity;this.hue=themehouse.holidayFirework.random(themehouse.holidayFirework.hue-themehouse.holidayFirework.config.particleHueVariance,themehouse.holidayFirework.hue+themehouse.holidayFirework.config.particleHueVariance);this.brightness=
themehouse.holidayFirework.random(themehouse.holidayFirework.config.particleBrightnessMin,themehouse.holidayFirework.config.particleBrightnessMax);this.decay=themehouse.holidayFirework.random(themehouse.holidayFirework.config.particleDecayMin,themehouse.holidayFirework.config.particleDecayMax);this.speed=themehouse.holidayFirework.random(themehouse.holidayFirework.config.particleSpeedMin,themehouse.holidayFirework.config.particleSpeedMax);this.trail=[];for(this.trailLength=themehouse.holidayFirework.config.particleTrailLength;this.trailLength--;)this.trail.push([this.x,
this.y]);this.transparency=themehouse.holidayFirework.config.particleTransparency},update:function(a){this.trail.pop();this.trail.unshift([this.x,this.y]);this.speed*=this.friction;this.x+=Math.cos(this.angle)*this.speed;this.y+=Math.sin(this.angle)*this.speed+this.gravity;this.transparency-=this.decay;this.transparency<=this.decay&&themehouse.holidayFirework.particles.splice(a,1)},draw:function(){themehouse.holidayFirework.context.beginPath();themehouse.holidayFirework.context.moveTo(this.trail[this.trail.length-
1][0],this.trail[this.trail.length-1][1]);themehouse.holidayFirework.context.lineTo(this.x,this.y);themehouse.holidayFirework.context.strokeStyle="hsla("+this.hue+", 100%, "+this.brightness+"%, "+this.transparency+")";themehouse.holidayFirework.context.stroke()}};
"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(a,b){if(null==a)throw new TypeError("Cannot convert undefined or null to object");for(var c=Object(a),d=1;d<arguments.length;d++){var e=arguments[d];if(null!=e)for(var f in e)Object.prototype.hasOwnProperty.call(e,f)&&(c[f]=e[f])}return c},writable:!0,configurable:!0});