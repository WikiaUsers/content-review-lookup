// Copied from https://wikiplus-app.smartgslb.com/Main.min.js
"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function MoeNotification(){var a=this;this.display=function(b,c,d){var e=d||function(){},f=b||"å–µ~",g=c||"success";$("#MoeNotification").append($("<div>").addClass("MoeNotification-notice").addClass("MoeNotification-notice-"+g).append("<span>"+f+"</span>")),$("#MoeNotification").find(".MoeNotification-notice").last().fadeIn(300),a.bind(),a.clear(),e($("#MoeNotification").find(".MoeNotification-notice").last())},this.create={success:function(b,c){var d=c||function(){};a.display(b,"success",d)},warning:function(b,c){var d=c||function(){};a.display(b,"warning",d)},error:function(b,c){var d=c||function(){};a.display(b,"error",d)}},this.clear=function(){return $(".MoeNotification-notice").length>=10?($("#MoeNotification").children().first().fadeOut(150,function(){$(this).remove()}),void setTimeout(a.clear,300)):!1},this.empty=function(a){$(".MoeNotification-notice").each(function(b){if($.isFunction(a)){var c=this;setTimeout(function(){a($(c))},200*b)}else $(this).delay(200*b).fadeOut("fast",function(){$(this).remove()})})},this.bind=function(){$(".MoeNotification-notice").mouseover(function(){a.slideLeft($(this))})},this.slideLeft=function(a,b){a.css("position","relative"),a.animate({left:"-200%"},b||150,function(){$(this).fadeOut("fast",function(){$(this).remove()})})},this.init=function(){$("body").append('<div id="MoeNotification"></div>')},$("#MoeNotification").length>0||this.init()}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();$(function(){function a(a){$.ajax({url:g+"/languages/get.php?lang="+a,dataType:"json",success:function(a){a.__language&&a.__version&&(f[a.__language]?a.__version>=f[a.__language].__version&&(f[a.__language]=a,console.log("æ›´æ–°è¯­è¨€ç‰ˆæœ¬"+a.___language+"è‡³"+a.___version)):f[a.__language]=a,localStorage.Wikiplus_i18nCache=JSON.stringify(f))},error:function(b){console.log("æ— æ³•åŠ è½½è¯­è¨€"+a)}})}function b(a){var b;try{b=JSON.parse(localStorage.Wikiplus_Settings).language||window.navigator.language.toLowerCase()}catch(c){b=window.navigator.language.toLowerCase()}return f[b]&&f[b][a]?f[b][a]:f["en-us"][a]?f["en-us"][a]:"undefined"}function c(a){var c={unknown_error_name:{number:1001,message:b("unknown_error_name")},api_unaccessiable:{number:1002},api_unwriteable:{number:1003},fail_to_get_timestamp:{number:1004},fail_to_get_edittoken:{number:1005},fail_to_get_pageinfo:{number:1006},not_autoconfirmed_user:{number:1007},hit_abusefilter:{number:1008},unknown_edit_error:{number:1009},unknown_edit_error_message:{number:1010},notitle:{number:1011},notext:{number:1012},notoken:{number:1013},invalidsection:{number:1014},protectedtitle:{number:1015},cantcreate:{number:1016},cantcreate_anon:{number:1017},articleexists:{number:1018},noimageredirect_anon:{number:1019},noimageredirect:{number:1020},spamdetected:{number:1021},filtered:{number:1022},contenttoobig:{number:1023},noedit_anon:{number:1025},noedit:{number:1026},pagedeleted:{number:1027},emptypage:{number:1028},emptynewsection:{number:1029},editconflict:{number:1030},revwrongpage:{number:1031},undofailure:{number:1032},missingtitle:{number:1033},mustbeposted:{number:1034},readapidenied:{number:1035},writeapidenied:{number:1036},noapiwrite:{number:1037},badtoken:{number:1038},missingparam:{number:1039},invalidparammix:{number:1040},invalidtitle:{number:1041},nosuchpageid:{number:1042},pagecannotexist:{number:1043},nosuchrevid:{number:1044},badmd5:{number:1045},hookaborted:{number:1046},parseerror:{number:1047},summaryrequired:{number:1048},blocked:{number:1049},ratelimited:{number:1050},unknownerror:{number:1051},nosuchsection:{number:1052},sectionsnotsupported:{number:1053},editnotsupported:{number:1054},appendnotsupported:{number:1055},redirect_appendonly:{number:1056},badformat:{number:1057},customcssprotected:{number:1058},customjsprotected:{number:1059},cascadeprotected:{number:1060},network_edit_error:{number:1061},need_init:{number:1062},fail_to_get_wikitext:{number:1063},fail_to_init_quickedit:{number:1064},fail_to_get_wikitext_when_edit:{number:1065},cant_parse_wikitext:{number:1066},empty_page_confirm:{number:1067},uninited:{number:1068},cant_parse_i18ncache:{number:1069},cant_load_language:{number:1070}};return c[a]?c[a].message?{number:c[a].number,message:c[a].message}:"undefined"!==b(a)?{number:c[a].number,message:b(a)}:{number:c[a].number,message:b("unknownerror")}:{number:c.unknown_error_name.number,message:c.unknown_error_name.message}}function d(a){var b=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return-1===$.inArray(a,b)?!1:!0}function e(a,b){var d=c(a),e=new Error;return e.number=d.number,e.message=b||d.message,console.log("%cè‡´å‘½é”™è¯¯["+e.number+"]:"+e.message,"color:red"),console.log(e),e}var f={},g=location.protocol+"//wikiplus-app.smartgslb.com";f["zh-cn"]={__language:"zh-cn",__author:["Eridanus Sora"],__version:"210",unknown_error_name:"æœªçŸ¥çš„é”™è¯¯å",api_unaccessiable:"æ— å¯ç”¨çš„API",api_unwriteable:"æ— å¯ç”¨çš„å†™å…¥API",fail_to_get_timestamp:"æ— æ³•èŽ·å¾—é¡µé¢ç¼–è¾‘èµ·å§‹æ—¶é—´æˆ³",fail_to_get_edittoken:"æ— æ³•èŽ·å¾—é¡µé¢ç¼–è¾‘æƒæ ‡",fail_to_get_pageinfo:"æ— æ³•èŽ·å¾—é¡µé¢ä¿¡æ¯",not_autoconfirmed_user:"éžè‡ªåŠ¨ç¡®è®¤ç”¨æˆ·",hit_abusefilter:"è¢«é˜²æ»¥ç”¨è¿‡æ»¤å™¨æ‹¦æˆª",unknown_edit_error:"æœªçŸ¥ç¼–è¾‘é”™è¯¯",unknown_edit_error_message:"æœªçŸ¥ç¼–è¾‘é”™è¯¯($1)",notitle:"æ— æ³•ç¼–è¾‘ç©ºæ ‡é¢˜é¡µé¢",notext:"ç¼ºå°‘é¡µé¢å†…å®¹",notoken:"ç©ºç¼–è¾‘æƒæ ‡",invalidsection:"æ®µè½ç¼–å·éžæ³•",protectedtitle:"è¯¥æ ‡é¢˜è¢«ä¿æŠ¤ï¼Œæ— æ³•åˆ›å»º",cantcreate:"æ— æ–°å»ºé¡µé¢æƒé™",cantcreate_anon:"åŒ¿åç”¨æˆ·æ— æ–°å»ºé¡µé¢æƒé™",articleexists:"æ— æ³•åˆ›å»ºå·²ç»å­˜åœ¨çš„é¡µé¢",noimageredirect_anon:"åŒ¿åç”¨æˆ·æ— æ–°å»ºæ–‡ä»¶é‡å®šå‘æƒé™",noimageredirect:"æ— æ–°å»ºæ–‡ä»¶é‡å®šå‘æƒé™",spamdetected:"æ–‡æœ¬å«æœ‰æ•æ„Ÿå†…å®¹ï¼Œè¢«SPAMè¿‡æ»¤å™¨æ‹¦æˆª",filtered:"ç¼–è¾‘è¢«è¿‡æ»¤å™¨æ‹¦æˆª",contenttoobig:"æ–‡æœ¬è¶…è¿‡æœ€å¤§é•¿åº¦é™åˆ¶",noedit_anon:"åŒ¿åç”¨æˆ·æ— ç¼–è¾‘é¡µé¢æƒé™",noedit:"æ— ç¼–è¾‘é¡µé¢æƒé™",pagedeleted:"ç¼–è¾‘æ—¶ï¼Œæ­¤é¡µé¢è¢«åˆ é™¤",emptypage:"æ— æ³•æ–°å»ºç©ºå†…å®¹é¡µé¢",emptynewsection:"æ— æ³•æ–°å»ºç©ºå†…å®¹æ®µè½",editconflict:"ç¼–è¾‘å†²çªï¼Œè¯·æ‰‹å·¥æ£€æŸ¥é¡µé¢å½“å‰å†…å®¹ä¸Žæäº¤å†…å®¹å·®å¼‚å¹¶ä¿®æ­£åŽï¼Œåˆ·æ–°é¡µé¢æäº¤",revwrongpage:"ç¼–è¾‘çš„ä¿®è®¢ç‰ˆæœ¬ä¸Žç¼–è¾‘çš„é¡µé¢ä¸åŒ¹é…",undofailure:"ç”±äºŽå­˜åœ¨å†²çªçš„ä¸­é—´ç‰ˆæœ¬ï¼Œæ— æ³•æ’¤é”€ç¼–è¾‘",missingtitle:"æ— æ³•åˆ›å»ºæˆ–ç¼–è¾‘ç©ºæ ‡é¢˜é¡µé¢",mustbeposted:"å¿…é¡»ä½¿ç”¨POSTæ–¹å¼æäº¤ç¼–è¾‘",readapidenied:"æ— è¯»å–APIä½¿ç”¨æƒé™",writeapidenied:"æ— é€šè¿‡APIç¼–è¾‘é¡µé¢æƒé™",noapiwrite:"æœ¬Wikiæœªå¼€å¯å¯ç”¨çš„å†™å…¥API",badtoken:"éžæ³•çš„ç¼–è¾‘æƒæ ‡",missingparam:"ç¼ºå°‘å¿…è¦å‚æ•°ï¼Œé¡µé¢åå’Œé¡µé¢IDä¸èƒ½å‡ä¸ºç©º",invalidparammix:"å‚æ•°é‡å¤ï¼Œé¡µé¢åå’Œé¡µé¢IDä¸èƒ½åŒæ—¶ç»™å®š",invalidtitle:"éžæ³•çš„æ ‡é¢˜",nosuchpageid:"ä¸å­˜åœ¨çš„é¡µé¢ID",pagecannotexist:"è¯¥åç§°ç©ºé—´ä¸å…è®¸æ–°å»ºä¸€èˆ¬é¡µé¢",nosuchrevid:"ä¸å­˜åœ¨çš„ä¿®è®¢ç‰ˆæœ¬",badmd5:"éžæ³•çš„MD5å€¼",hookaborted:"ç¼–è¾‘è¢«æ‰©å±•Hookæ‹¦æˆª",parseerror:"æ— æ³•è§£æžé¡µé¢æ–‡æœ¬",summaryrequired:"ç¼–è¾‘æ‘˜è¦ä¸èƒ½ä¸ºç©º",blocked:"å·²è¢«å°ç¦",ratelimited:"è¾¾åˆ°æ“ä½œé€ŸçŽ‡ä¸Šé™ï¼Œè¯·ç¨åŽé‡è¯•",unknownerror:"æœªçŸ¥é”™è¯¯",nosuchsection:"æ— æ³•ç¼–è¾‘ä¸å­˜åœ¨çš„æ®µè½",sectionsnotsupported:"è¯¥é¡µé¢ä¸æ”¯æŒæ®µè½ç¼–è¾‘",editnotsupported:"è¯¥é¡µé¢ä¸æ”¯æŒé€šè¿‡APIç¼–è¾‘",appendnotsupported:"è¯¥é¡µé¢æ— æ³•åœ¨å‰åŽæ’å…¥æ–‡æœ¬",redirect_appendonly:"åœ¨éµå¾ªé‡å®šå‘çš„æƒ…å†µä¸‹ï¼Œåªèƒ½è¿›è¡Œå‰åŽæ’å…¥æˆ–åˆ›å»ºæ–°æ®µè½",badformat:"æ–‡æœ¬æ ¼å¼é”™è¯¯",customcssprotected:"æ— æ³•ç¼–è¾‘ç”¨æˆ·CSSé¡µ",customjsprotected:"æ— æ³•ç¼–è¾‘ç”¨æˆ·JSé¡µ",cascadeprotected:"è¯¥é¡µé¢è¢«çº§è”ä¿æŠ¤",network_edit_error:"ç”±äºŽç½‘ç»œåŽŸå› ç¼–è¾‘å¤±è´¥",redirect_to_summary:"é‡å®šå‘é¡µé¢è‡³ [[$1]] // Wikiplus",redirect_from_summary:"å°†[[$1]]é‡å®šå‘è‡³[[$2]] // Wikiplus",need_init:"é¡µé¢ç±»æœªåŠ è½½å®Œæˆ",fail_to_get_wikitext:"æ— æ³•èŽ·å¾—é¡µé¢æ–‡æœ¬",quickedit_topbtn:"å¿«é€Ÿç¼–è¾‘",quickedit_sectionbtn:"å¿«é€Ÿç¼–è¾‘",fail_to_init_quickedit:"æ— æ³•åŠ è½½å¿«é€Ÿç¼–è¾‘",back:"è¿”å›ž",goto_editbox:"åˆ°ç¼–è¾‘æ¡†",summary_placehold:"è¯·è¾“å…¥ç¼–è¾‘æ‘˜è¦",submit:"æäº¤",publish_page:"å‘å¸ƒé¡µé¢",publish_change:"å‘å¸ƒæ›´æ”¹",preview:"é¢„è§ˆ",cancel:"å–æ¶ˆ",mark_minoredit:"æ ‡è®°ä¸ºå°ç¼–è¾‘",onclose_confirm:"[Wikiplus] æ‚¨ç¡®è®¤è¦å…³é—­/åˆ·æ–°é¡µé¢å— è¿™ä¼šå¯¼è‡´æ‚¨çš„ç¼–è¾‘æ•°æ®ä¸¢å¤±",fail_to_get_wikitext_when_edit:"æ— æ³•èŽ·å¾—é¡µé¢æ–‡æœ¬ä»¥ç¼–è¾‘",cant_parse_wikitext:"æ— æ³•è§£æžç»´åŸºæ–‡æœ¬",loading_preview:"æ­£åœ¨è¯»å–é¢„è§ˆ",submitting_edit:"æ­£åœ¨æäº¤ç¼–è¾‘",edit_success:"ç¼–è¾‘æˆåŠŸ ç”¨æ—¶$1ms",empty_page_confirm:"æ‚¨å‘ç¼–è¾‘å‡½æ•°ä¼ å…¥äº†ç©ºå†…å®¹å‚æ•° è¿™å°†æ¸…ç©ºé¡µé¢\r\nç”±äºŽè¯¥è¡Œä¸ºå±é™© è¯·å°†configå‚æ•°çš„emptyé”®å€¼è®¾å®šä¸ºtrueæ¥ç¡®è®¤",cross_page_edit:"ç¼–è¾‘ç›®æ ‡ä½äºŽå…¶ä»–é¡µé¢ æ­£åœ¨èŽ·å–åŸºç¡€ä¿¡æ¯",cross_page_edit_submit:"åŸºç¡€ä¿¡æ¯èŽ·å–æˆåŠŸ æ­£åœ¨æäº¤ç¼–è¾‘",cross_page_edit_error:"æ— æ³•èŽ·å¾—åŸºç¡€ä¿¡æ¯>.<",install_tip:"æ‚¨æ˜¯å¦å…è®¸Wikiplusé‡‡é›†éžæ•æ„Ÿæ•°æ®ç”¨äºŽæ”¹è¿›WikiplusåŠä¸ºå½“å‰Wiki: $1 æä¾›æ”¹è¿›å»ºè®®?",accept:"æŽ¥å—",decline:"æ‹’ç»",install_finish:"Wikipluså®‰è£…å®Œæ¯•",loading:"æ­£åœ¨è½½å…¥",cant_add_funcbtn:"æ— æ³•å¢žåŠ åŠŸèƒ½æŒ‰é’®",wikiplus_settings:"Wikiplusè®¾ç½®",wikiplus_settings_desc:"è¯·åœ¨ä¸‹æ–¹æŒ‰è§„èŒƒä¿®æ”¹Wikiplusè®¾ç½®",wikiplus_settings_placeholder:"å½“å‰è®¾ç½®ä¸ºç©º è¯·åœ¨æ­¤å¤„æŒ‰è§„èŒƒä¿®æ”¹Wikiplusè®¾ç½®",wikiplus_settings_grammar_error:"è®¾ç½®å­˜åœ¨è¯­æ³•é”™è¯¯ è¯·æ£€æŸ¥åŽé‡è¯•",wikiplus_settings_saved:"è®¾ç½®å·²ä¿å­˜",redirect_from:"å°†é¡µé¢é‡å®šå‘è‡³æ­¤",redirect_desc:"è¯·è¾“å…¥è¦é‡å®šå‘è‡³æ­¤çš„é¡µé¢å",empty_input:"è¾“å…¥ä¸èƒ½ä¸ºç©º",redirect_saved:"é‡å®šå‘å®Œæˆ",uninited:"WikiplusæœªåŠ è½½å®Œæ¯• è¯·åˆ·æ–°é‡è¯•",cant_parse_i18ncache:"æ— æ³•è§£æžå¤šè¯­è¨€å®šä¹‰æ–‡ä»¶ç¼“å­˜",cant_load_language:"æ— æ³•èŽ·å–å¤šè¯­è¨€å®šä¹‰æ–‡ä»¶",history_edit_warning:" // æ­£è¯•å›¾ç¼–è¾‘åŽ†å²ç‰ˆæœ¬ è¿™å°†ä¼šåº”ç”¨åˆ°æœ¬é¡µé¢çš„æœ€æ–°ç‰ˆæœ¬ è¯·æ…Žé‡æäº¤",create_page_tip:"<!-- æ­£åœ¨åˆ›å»ºæ–°é¡µé¢ è¯·åˆ åŽ»æ­¤è¡Œæ³¨é‡ŠåŽç»§ç»­ -->","continue":"ä»ç„¶ç»§ç»­",default_summary_suffix:"// Edit via Wikiplus"},f["en-us"]={__language:"en-us",__author:["Eridanus Sora","AnnAngela","YinYan"],__version:"210",unknown_error_name:"Unknown error",api_unaccessiable:"API of this wiki is not available",api_unwriteable:"Write API of this wiki is not available",fail_to_get_timestamp:"Failed to get the timestamp of this page.",fail_to_get_edittoken:"Failed to get the EditToken of this page.",fail_to_get_pageinfo:"Failed to load infomation of this page",not_autoconfirmed_user:"You are not an autoconfiremd user",hit_abusefilter:"Your edit hit the abusefilter(s)",unknown_edit_error:"Unknown edit error",unknown_edit_error_message:"Unknown edit error($1)",notitle:"The title parameter must be set",notext:"The text parameter must be set",notoken:"The token parameter must be set",invalidsection:"The section parameter must be set to an integer or 'new'",protectedtitle:"This title has been protected from creation",cantcreate:"You don't have permission to create new pages",cantcreate_anon:"Anonymous users can't create new pages",articleexists:"The article you tried to create has already existed",noimageredirect_anon:"Anonymous users can't create image redirects",noimageredirect:"You don't have the permission to create image redirects",spamdetected:"Your edit was rejected because it contained a spam fragment",filtered:"The filter callback function rejected your edit",contenttoobig:"The content you submitted exceeds the article size limit",noedit_anon:"Anonymous users can't edit pages",noedit:"You don't have the permission to edit pages",pagedeleted:"The page was deleted during your edit",emptypage:"Creating new, empty pages is not allowed",emptynewsection:"Creating empty new sections is not possible.",editconflict:"Edit Conflict! Don't panic. Please check the difference between your content below and the existing revision, then refresh the page to make another submit",revwrongpage:"The revision you are editing now is not one a valid reversions of this page",undofailure:"Undo failed due to conflicts.",missingtitle:"Missing title in your edit/creation",mustbeposted:"The edit must be submited by POST method",readapidenied:"Read API Denied",writeapidenied:"Write API Denied",noapiwrite:"No available write API in this wiki",badtoken:"Invalid EditToken",missingparam:"One of the parameters title, pageid is required",invalidparammix:"The parameters title, pageid can not be used together",invalidtitle:"Invalid page title",nosuchpageid:"Inexistent page ID",pagecannotexist:"No access to create a new page in this namespace",nosuchrevid:"Inexisting reversion ID",badmd5:"Invalid MD5",hookaborted:"Your edit was rejected by the hook(s)",parseerror:"Failed to parse the wikitext of this page",summaryrequired:"No summary in your edit",blocked:"You have been already BLOCKED",ratelimited:"You've exceeded your rate limit. Please have a tea and try again later",unknownerror:"Unknown error",nosuchsection:"There is no such section",sectionsnotsupported:"Can't edit in this section",editnotsupported:"Can't edit in this section by writing section",appendnotsupported:"Can't append/prepend wikitext to this page",redirect_appendonly:"Only append/prepend can be made to this page because of the rules of the redirect page",badformat:"The requested serialization format can not be applied to the page's content model",customcssprotected:"You're not allowed to edit custom CSS pages",customjsprotected:"You're not allowed to edit custom JavaScript pages",cascadeprotected:"This page is under a cascading protection",network_edit_error:"Failed to edit this page because of network errors",redirect_to_summary:"Redirect to [[$1]] // Wikiplus",redirect_from_summary:"Redirect [[$1]] to [[$2]] // Wikiplus",need_init:"WikiPlus haven't been loaded completely. It's a rare occasion so you can try to refresh and try again.",fail_to_get_wikitext:"Failed to load the wikitext of this page",quickedit_topbtn:"QuickEdit",quickedit_sectionbtn:"QuickEdit",fail_to_init_quickedit:"Failed to initialize WikiPlus",back:"Back",goto_editbox:"Jump to editbox",summary_placehold:"Edit summary",submit:"Submit",publish_page:"Publish Page",publish_change:"Publish Changes",preview:"Preview",cancel:"Cancel",mark_minoredit:"Mark this edit as a minor edit",onclose_confirm:"[Wikiplus] Do you really want to close this page when you are still editing it, as you will lose all your unsaved work?",fail_to_get_wikitext_when_edit:"Failed to load wikitext for your edit",cant_parse_wikitext:"Failed to parse the wikitext",loading_preview:"Loading the preview",submitting_edit:"Submitting your edit",edit_success:"Your edit is submitted within $1ms",empty_page_confirm:'The wikitext in your edit is empty, which will empty this page.\r\nPlease set the value of key "empty" true to allow this kind of edits. (This is a tip for developers)',cross_page_edit:"The content you are editing belongs to another page, please wait...",cross_page_edit_submit:"Submitting your edit...",cross_page_edit_error:"Failed to load the infomation",install_tip:"Do you allow WikiPlus to collect insensitive data to help us develop WikiPlus and provide feedback to current site: $1 ?",accept:"Yes",decline:"No",install_finish:"Wikiplus is installed, enjoy it",loading:"Loading",cant_add_funcbtn:"Failed to add buttons for WikiPlus",wikiplus_settings:"Wikiplus Setting",wikiplus_settings_desc:"Please modify your setting according to the standards below",wikiplus_settings_placeholder:"Your setting is empty, please modify your setting according to the documentation.",wikiplus_settings_grammar_error:"Syntax error in your setting",wikiplus_settings_saved:"Your settings have been saved",redirect_from:"Redirect from",redirect_desc:"Which page do you want to redirect here?",empty_input:"Empty input",redirect_saved:"Redirection is finished",uninited:"Wikiplus is not completely initialized, please refeash this page",cant_parse_i18ncache:"Failed to parse the cache of i18n file",cant_load_language:"Failed to load i18n file",history_edit_warning:" // You are trying to edit a history revision of this page. This will apply to the latest revision. Please be careful.",create_page_tip:"<!-- You are now creating a new page. Please delete this line and be careful. -->","continue":"Continue anyway",default_summary_suffix:"// Edit via Wikiplus"};var h=function(){function a(){var b=arguments.length<=0||void 0===arguments[0]?window.mw.config.get("wgPageName"):arguments[0];return _classCallCheck(this,a),console.log("é¡µé¢ç±»æž„å»ºä¸­"),window.mw?window.mw.config.get("wgEnableAPI")&&window.mw.config.get("wgEnableWriteAPI")?d("autoconfirmed",window.mw.config.get("wgUserGroups"))?(this.pageName=b.replace(/ /gi,"_"),this.revisionId=window.mw.config.get("wgRevisionId"),this.articleId=window.mw.config.get("wgArticleId"),this.API=location.protocol+"//"+location.host+window.mw.config.get("wgScriptPath")+"/api.php",this.editToken={},this.timeStamp={},void this.init(this.pageName,{success:function(){console.log("WikiplusåŠ è½½å®Œæ¯•")},fail:function(a){console.log("Wikiplusæœªèƒ½æ­£ç¡®åŠ è½½("+a.message+")")}})):void e("not_autoconfirmed_user"):void e("api_unaccessiable"):void console.log("é¡µé¢Javascriptè½½å…¥ä¸å®Œå…¨æˆ–è¿™ä¸æ˜¯ä¸€ä¸ªMediawikiç«™ç‚¹")}return _createClass(a,[{key:"reConstruct",value:function(a){var b=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];this.init(a,b)}},{key:"init",value:function(a,b,c){void 0===a&&(a=this.pageName),void 0===b&&(b={});var d=this;b.success=b.success||new Function,b.fail=b.success||new Function,$.ajax({type:"GET",dataType:"json",url:this.API,data:{action:"query",prop:"revisions|info",titles:a,rvprop:"timestamp",format:"json"},beforeSend:function(){console.time("èŽ·å¾—é¡µé¢åŸºç¡€ä¿¡æ¯æ—¶é—´è€—æ—¶")},success:function(c){if(c&&c.query&&c.query.pages){var f=c.query.pages;for(var g in f)"-1"!==g?(f[g].revisions&&f[g].revisions.length>0?d.timeStamp[a]=f[g].revisions[0].timestamp:b.fail(e("fail_to_get_timestamp")),mw.user.tokens.get("editToken")&&"+\\"!==mw.user.tokens.get("editToken")?(d.editToken[a]=mw.user.tokens.get("editToken"),console.log("æˆåŠŸèŽ·å¾—ç¼–è¾‘ä»¤ç‰Œ æ¥è‡ªå‰ç«¯API")):($.ajax({url:d.API,type:"GET",dataType:"json",data:{action:"query",meta:"tokens",format:"json"},success:function(c){c.query&&c.query.tokens&&c.query.tokens.csrftoken&&"+\\"!==c.query.tokens.csrftoken?(d.editToken[a]=c.query.tokens.csrftoken,console.log("æˆåŠŸèŽ·å¾—ç¼–è¾‘ä»¤ç‰Œ é€šè¿‡åŽç«¯API")):b.fail(e("fail_to_get_edittoken"))},error:function(a){b.fail(e("fail_to_get_edittoken"))}}),b.fail(e("fail_to_get_edittoken")))):0===mw.config.get("wgArticleId")?mw.user.tokens.get("editToken")&&"+\\"!==mw.user.tokens.get("editToken")?(d.editToken[a]=mw.user.tokens.get("editToken"),console.log("æˆåŠŸèŽ·å¾—ç¼–è¾‘ä»¤ç‰Œ æ¥è‡ªå‰ç«¯API"),d.inited=!0):(d.inited=!1,b.fail(e("fail_to_get_edittoken"))):(d.inited=!1,b.fail(e("fail_to_get_pageinfo")))}}}).done(function(){console.timeEnd("èŽ·å¾—é¡µé¢åŸºç¡€ä¿¡æ¯æ—¶é—´è€—æ—¶"),d.inited=d.inited===!1?!1:!0,b.success()})}},{key:"edit",value:function(a){var c=arguments.length<=1||void 0===arguments[1]?this.pageName:arguments[1],d=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],f=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],g=this;return d.success=d.success||new Function,d.fail=d.fail||new Function,void 0===a&&!f.empty==!0?(d.fail(e("empty_page_confirm")),!1):void(g.inited?$.ajax({type:"POST",url:g.API,data:$.extend({action:"edit",format:"json",text:a,title:c,token:g.editToken[c]||g.editToken[g.pageName],basetimestamp:g.timeStamp[c]},f),success:function(a){a&&a.edit?a.edit.result&&"Success"==a.edit.result?d.success():a.edit.code?d.fail(e("hit_abusefilter",b("hit_abusefilter")+":"+a.edit.info.replace("/Hit AbuseFilter: /ig","")+"<br><small>"+a.edit.warning+"</small>")):d.fail(e("unknown_edit_error")):a&&a.error&&a.error.code?d.fail(e(a.error.code.replace(/-/gi,"_")),b("unknown_edit_error_message").replace(/\$1/gi,a.error.code)):a.code?d.fail(e("unknown_edit_error"),b("unknown_edit_error_message").replace(/\$1/gi,a.code)):d.fail(e("unknown_edit_error"))},error:function(a){d.fail(e("network_edit_error"))}}):d.fail(e("uninited")))}},{key:"editSection",value:function(a,b){var c=arguments.length<=2||void 0===arguments[2]?this.pageName:arguments[2],d=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],e=arguments.length<=4||void 0===arguments[4]?{}:arguments[4];e.success=e.success||new Function,e.fail=e.fail||new Function,this.edit(b,c,e,$.extend({section:a},d))}},{key:"redirectTo",value:function(a){var c=arguments.length<=1||void 0===arguments[1]?this.pageName:arguments[1],d=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];d.success=d.success||new Function,d.fail=d.fail||new Function,this.edit("#REDIRECT [["+a+"]]",c,d,{summary:b("redirect_to_summary").replace(/\$1/gi,a)})}},{key:"redirectFrom",value:function(a){var c=arguments.length<=1||void 0===arguments[1]?this.pageName:arguments[1],d=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],e=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];d.success=d.success||new Function,d.fail=d.fail||new Function;var f={summary:b("redirect_from_summary").replace(/\$1/gi,a).replace(/\$2/gi,c)};e||(f.createonly="true"),this.edit("#REDIRECT [["+c+"]]",a,d,f)}},{key:"getWikiText",value:function(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],b=arguments.length<=1||void 0===arguments[1]?this.pageName:arguments[1],c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];a.success=a.success||new Function,a.fail=a.fail||new Function,$.ajax({url:location.protocol+"//"+location.host+mw.config.get("wgScriptPath")+"/index.php",type:"GET",dataType:"text",cache:!1,data:$.extend({title:b,action:"raw"},c),beforeSend:function(){console.time("èŽ·å¾—é¡µé¢æ–‡æœ¬è€—æ—¶")},success:function(b){console.timeEnd("èŽ·å¾—é¡µé¢æ–‡æœ¬è€—æ—¶"),a.success(b)},error:function(b){a.fail(e("fail_to_get_wikitext"))}})}},{key:"parseWikiText",value:function(a,b,c){void 0===a&&(a=""),void 0===b&&(b={}),b.success=b.success||new Function,b.fail=b.fail||new Function,$.ajax({type:"POST",dataType:"json",data:$.extend({format:"json",action:"parse",text:a,title:this.pageName,pst:"true"},c),url:this.API,success:function(a){a&&a.parse&&a.parse.text?b.success(a.parse.text["*"]):b.fail(e("cant_parse_wikitext"))}})}}]),a}();$(document).ready(function(){var c=function(){function c(){_classCallCheck(this,c),this.version="2.2.14",this.langVersion="210",this.releaseNote="Bug ä¿®æ­£",this.notice=new MoeNotification,this.inValidNameSpaces=[-1,8964],this.defaultSettings={key:"value",documatation:"http://zh.moegirl.org/User:%E5%A6%B9%E7%A9%BA%E9%85%B1/Wikiplus/%E8%AE%BE%E7%BD%AE%E8%AF%B4%E6%98%8E"},console.log("æ­£åœ¨åŠ è½½Wikiplus "+this.version),$("head").append("<link>"),$("head").children(":last").attr({rel:"stylesheet",type:"text/css",href:g+"/wikiplus.css"}),this.preloadData={},this.checkInstall();var b=this.getSetting("language")&&this.getSetting("language").toLowerCase()||window.navigator.language.toLowerCase();this.version!==localStorage.Wikiplus_Version&&(localStorage.Wikiplus_Version=this.version,this.notice.create.success("Wikiplus "+this.version),this.notice.create.success("zh-cn"===b?this.releaseNote:"Minor bug fixes.")),void 0===f[b]&&a(b),!d(mw.config.get("wgNameSpaceNumber"),this.inValidNameSpaces)&&mw.config.get("wgIsArticle")&&"view"===mw.config.get("wgAction")?(this.kotori=new h,this.checki18nCache(),this.initBasicFunctions()):console.log("ä¸ç¬¦åˆåŠ è½½æ¡ä»¶ Wikiplusç»ˆæ­¢")}return _createClass(c,[{key:"initQuickEdit",value:function(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],c=this;if(a.success=a.success||new Function,a.fail=a.fail||new Function,!mw.config.get("wgIsArticle")||"view"!==mw.config.get("wgAction")||!mw.config.get("wgIsProbablyEditable"))return void console.log("è¯¥é¡µé¢æ— æ³•ç¼–è¾‘ å¿«é€Ÿç¼–è¾‘ç•Œé¢åŠ è½½ç»ˆæ­¢");var d=$("<li>").attr("id","Wikiplus-Edit-TopBtn").append($("<span>").append($("<a>").attr("href","javascript:void(0)").text(""+b("quickedit_topbtn")))).data({number:-1,target:c.kotori.pageName});if($("#ca-edit").length>0&&0==$("#Wikiplus-Edit-TopBtn").length&&$("#ca-edit").before(d),$(".mw-editsection").length>0){c.sectionMap={};var f=$("<span>").append($("<span>").addClass("mw-editsection-divider").text(" | ")).append($("<a>").addClass("Wikiplus-Edit-SectionBtn").attr("href","javascript:void(0)").text(b("quickedit_sectionbtn")));$(".mw-editsection").each(function(a){try{var b=$(this).find("a").last().attr("href"),d=b.match(/&[ve]*section\=([^&]+)/)[1].replace(/T-/gi,""),g=decodeURI(b.match(/title=(.+?)&/)[1]),h=$(this).prev().clone();h.find(".mw-headline-number").remove();var i=$.trim(h.text());c.sectionMap[d]={name:i,target:g};var j=f.clone();j.find(".Wikiplus-Edit-SectionBtn").data({number:d,name:i,target:g}),$(this).find(".mw-editsection-bracket").last().before(j)}catch(k){e("fail_to_init_quickedit")}})}$(".Wikiplus-Edit-SectionBtn").click(function(){c.initQuickEditInterface($(this))}),$("#Wikiplus-Edit-TopBtn").click(function(){c.initQuickEditInterface($(this))})}},{key:"initQuickEditInterface",value:function(a){var c=this,d=a.data("number"),f=a.data("target");this.kotori.inited&&($(".noarticletext").length>0&&(this.preloadData[f+".-1"]=b("create_page_tip")),mw.config.get("wgCurRevisionId")===mw.config.get("wgRevisionId")?void 0===this.preloadData[f+"."+d]?(this.notice.create.success(b("loading")),this.preload(d,f,{success:function(b){a.data("content",b),c.notice.empty(),c.displayQuickEditInterface(a)},fail:function(a){e("fail_to_get_wikitext_when_edit")}})):(a.data("content",c.preloadData[f+"."+d]),c.displayQuickEditInterface(a)):(this.notice.create.warning(b("history_edit_warning")),this.notice.create.success(b("loading")),this.preload(d,f,{success:function(d){a.data("content",d),c.notice.empty(),c.displayQuickEditInterface(a,""+b("history_edit_warning"))},fail:function(a){e("fail_to_get_wikitext_when_edit")}},{oldid:mw.config.get("wgRevisionId")})))}},{key:"displayQuickEditInterface",value:function(a){var c=arguments.length<=1||void 0===arguments[1]?"":arguments[1],d=this,e=$(".noarticletext").length>0,f=a.data("number"),g=a.data("name"),h=a.data("target"),i=a.data("content"),j=d.getSetting("defaultSummary",{sectionName:g,sectionNumber:f,sectionTargetName:h});void 0===j&&(j=void 0===g?b("default_summary_suffix"):"/* "+g+" */ "+b("default_summary_suffix"));var k=$(document).scrollTop(),l=$("<span>").attr("id","Wikiplus-Quickedit-Back").addClass("Wikiplus-Btn").text(""+b("back")),m=$("<span>").attr("id","Wikiplus-Quickedit-Jump").addClass("Wikiplus-Btn").append($("<a>").attr("href","#Wikiplus-Quickedit").text(""+b("goto_editbox"))),n=$("<textarea>").attr("id","Wikiplus-Quickedit"),o=$("<div>").attr("id","Wikiplus-Quickedit-Preview-Output"),p=$("<input>").attr("id","Wikiplus-Quickedit-Summary-Input").attr("placeholder",""+b("summary_placehold")),q=$("<button>").attr("id","Wikiplus-Quickedit-Submit").text(b(e?"publish_page":"publish_change")+"(Ctrl+S)"),r=$("<button>").attr("id","Wikiplus-Quickedit-Preview-Submit").text(""+b("preview")),s=$("<div>").append($("<input>").attr({type:"checkbox",id:"Wikiplus-Quickedit-MinorEdit"})).append($("<label>").attr("for","Wikiplus-Quickedit-MinorEdit").text(b("mark_minoredit")+"(Ctrl+Shift+S)")).css({margin:"5px 5px 5px -3px",display:"inline"}),t=$("<div>").append(l,m,o,n,p,$("<br>"),s,q,r);this.createDialogBox(""+b("quickedit_topbtn")+c,t,1e3,function(){$("#Wikiplus-Quickedit").text(i),$("#Wikiplus-Quickedit-Summary-Input").val(j),$("#Wikiplus-Quickedit-Back").click(function(){$(".Wikiplus-InterBox").fadeOut("fast",function(){window.onclose=window.onbeforeunload=void 0,$(this).remove()})});var a=$("<div>").addClass("Wikiplus-Banner").text(""+b("loading_preview"));$("#Wikiplus-Quickedit-Preview-Submit").click(function(){var b=$("#Wikiplus-Quickedit").val();$(this).attr("disabled","disabled"),$("#Wikiplus-Quickedit-Preview-Output").fadeOut(100,function(){$("#Wikiplus-Quickedit-Preview-Output").html("").append(a),$("#Wikiplus-Quickedit-Preview-Output").fadeIn(100)}),$("html, body").animate({scrollTop:k},200),d.kotori.parseWikiText(b,{success:function(a){$("#Wikiplus-Quickedit-Preview-Output").fadeOut("100",function(){$("#Wikiplus-Quickedit-Preview-Output").html('<hr><div class="mw-body-content">'+a+"</div><hr>"),$("#Wikiplus-Quickedit-Preview-Output").fadeIn("100"),$("#Wikiplus-Quickedit-Preview-Submit").prop("disabled",!1)})}})}),$("#Wikiplus-Quickedit-Submit").click(function(){var a=$("#Wikiplus-Quickedit").val(),c=$("#Wikiplus-Quickedit-Summary-Input").val(),e=(new Date).valueOf(),g=$("<div>").addClass("Wikiplus-Banner").text(""+b("submitting_edit")),i={summary:c};-1!==f&&(i.section=f),$("#Wikiplus-Quickedit-MinorEdit").is(":checked")?i.minor="true":i.notminor="true",$("#Wikiplus-Quickedit-Submit,#Wikiplus-Quickedit,#Wikiplus-Quickedit-Preview-Submit").attr("disabled","disabled"),$("html, body").animate({scrollTop:k},200),h===d.kotori.pageName?($("#Wikiplus-Quickedit-Preview-Output").fadeOut(100,function(){$("#Wikiplus-Quickedit-Preview-Output").html("").append(g),$("#Wikiplus-Quickedit-Preview-Output").fadeIn(100)}),d.kotori.edit(a,h,{success:function(){var a=(new Date).valueOf()-e;$("#Wikiplus-Quickedit-Preview-Output").find(".Wikiplus-Banner").css("background","rgba(6, 239, 92, 0.44)"),$("#Wikiplus-Quickedit-Preview-Output").find(".Wikiplus-Banner").text((""+b("edit_success")).replace(/\$1/gi,a.toString())),d.sendStatistic(h,a),window.onclose=window.onbeforeunload=void 0,setTimeout(function(){location.reload()},500)},fail:function(a){console.log(a),$("#Wikiplus-Quickedit-Submit,#Wikiplus-Quickedit,#Wikiplus-Quickedit-Preview-Submit").prop("disabled",!1),$(".Wikiplus-Banner").css("background","rgba(218, 142, 167, 0.65)"),$(".Wikiplus-Banner").html(a.message)}},i)):($("#Wikiplus-Quickedit-Preview-Output").fadeOut(100,function(){$("#Wikiplus-Quickedit-Preview-Output").html("").append(g.text(b("cross_page_edit"))),$("#Wikiplus-Quickedit-Preview-Output").fadeIn(100)}),d.kotori.reConstruct(h,{success:function(){$(".Wikiplus-Banner").text(b("cross_page_edit_submit")),d.kotori.edit(a,h,{success:function(){var a=(new Date).valueOf()-e;$("#Wikiplus-Quickedit-Preview-Output").find(".Wikiplus-Banner").css("background","rgba(6, 239, 92, 0.44)"),$("#Wikiplus-Quickedit-Preview-Output").find(".Wikiplus-Banner").text((""+b("edit_success")).replace(/\$1/gi,""+a)),d.sendStatistic(h,a),window.onclose=window.onbeforeunload=void 0,setTimeout(function(){location.reload()},500)},fail:function(a){$("#Wikiplus-Quickedit-Submit,#Wikiplus-Quickedit,#Wikiplus-Quickedit-Preview-Submit").prop("disabled",!1),$(".Wikiplus-Banner").css("background","rgba(218, 142, 167, 0.65)"),$(".Wikiplus-Banner").text(a.message)}},i)},fail:function(a){$(".Wikiplus-Banner").css("background","rgba(218, 142, 167, 0.65)"),$(".Wikiplus-Banner").text(b("cross_page_edit_error"))}}))}),$("#Wikiplus-Quickedit,#Wikiplus-Quickedit-Summary-Input,#Wikiplus-Quickedit-MinorEdit").keydown(function(a){a.ctrlKey&&83==a.which&&(a.shiftKey&&$("#Wikiplus-Quickedit-MinorEdit").click(),$("#Wikiplus-Quickedit-Submit").click(),a.preventDefault(),a.stopPropagation())}),$("#Wikiplus-Quickedit").keydown(function(){window.onclose=window.onbeforeunload=function(){return""+b("onclose_confirm")}}),"true"===d.getSetting("esc_to_exit_quickedit")&&$(document).keydown(function(a){27===a.which&&$("#Wikiplus-Quickedit-Back").click()})})}},{key:"editSettings",value:function(){var a=this;a.addFunctionButton(b("wikiplus_settings"),"Wikiplus-Settings-Intro",function(){var c=$("<textarea>").attr("id","Wikiplus-Setting-Input").attr("rows","10"),d=$("<div>").addClass("Wikiplus-InterBox-Btn").attr("id","Wikiplus-Setting-Apply").text(b("submit")),e=$("<div>").addClass("Wikiplus-InterBox-Btn").attr("id","Wikiplus-Setting-Cancel").text(b("cancel")),f=$("<div>").append(c).append($("<hr>")).append(d).append(e);a.createDialogBox(b("wikiplus_settings_desc"),f,600,function(){localStorage.Wikiplus_Settings?$("#Wikiplus-Setting-Input").val(localStorage.Wikiplus_Settings):$("#Wikiplus-Setting-Input").attr("placeholder",b("wikiplus_settings_placeholder")),$("#Wikiplus-Setting-Apply").click(function(){var c=$("#Wikiplus-Setting-Input").val();try{c=JSON.parse(c)}catch(d){return void a.notice.create.error(b("wikiplus_settings_grammar_error"))}localStorage.Wikiplus_Settings=JSON.stringify(c),$(".Wikiplus-InterBox-Content").html("").append($("<div>").addClass("Wikiplus-Banner").text(b("wikiplus_settings_saved"))),$(".Wikiplus-InterBox").fadeOut(300,function(){$(this).remove()})}),$("#Wikiplus-Setting-Cancel").click(function(){$(".Wikiplus-InterBox").fadeOut(300,function(){$(this).remove()})})})})}},{key:"simpleRedirector",value:function(){var a=this;a.addFunctionButton(b("redirect_from"),"Wikiplus-SR-Intro",function(){var c=$("<input>").addClass("Wikiplus-InterBox-Input"),d=$("<div>").addClass("Wikiplus-InterBox-Btn").attr("id","Wikiplus-SR-Apply").text(b("submit")),e=$("<div>").addClass("Wikiplus-InterBox-Btn").attr("id","Wikiplus-SR-Cancel").text(b("cancel")),f=$("<div>").addClass("Wikiplus-InterBox-Btn").attr("id","Wikiplus-SR-Continue").text(b("continue")),g=$("<div>").append(c).append($("<hr>")).append(d).append(e);a.createDialogBox(b("redirect_desc"),g,600,function(){d.click(function(){if(""!=$(".Wikiplus-InterBox-Input").val()){var c=$(".Wikiplus-InterBox-Input").val();$(".Wikiplus-InterBox-Content").html('<div class="Wikiplus-Banner">'+b("submitting_edit")+"</div>"),a.kotori.redirectFrom(c,a.kotori.pageName,{success:function(){$(".Wikiplus-Banner").text(b("redirect_saved")),$(".Wikiplus-InterBox").fadeOut(300),location.href=mw.config.get("wgArticlePath").replace(/\$1/gi,c)},fail:function(d){$(".Wikiplus-Banner").css("background","rgba(218, 142, 167, 0.65)"),$(".Wikiplus-Banner").text(d.message),1018===d.number&&($(".Wikiplus-InterBox-Content").append($("<hr>")).append(f).append(e),f.click(function(){$(".Wikiplus-InterBox-Content").html('<div class="Wikiplus-Banner">'+b("submitting_edit")+"</div>"),
a.kotori.redirectFrom(c,a.kotori.pageName,{success:function(){$(".Wikiplus-Banner").text(b("redirect_saved")),$(".Wikiplus-InterBox").fadeOut(300),location.href=mw.config.get("wgArticlePath").replace(/\$1/gi,c)},fail:function(a){$(".Wikiplus-Banner").css("background","rgba(218, 142, 167, 0.65)"),$(".Wikiplus-Banner").text(a.message)}},!0)}),e.click(function(){$(".Wikiplus-InterBox-Close").click()}))}})}else a.showNotice.create.warning(b("empty_input"))}),$("#Wikiplus-SR-Cancel").click(function(){$(".Wikiplus-InterBox").fadeOut(300,function(){$(this).remove()})})})})}},{key:"preloadEventBinding",value:function(){var a=this;$("#toc").children("ul").find("a").each(function(b){$(this).mouseover(function(){$(this).unbind("mouseover"),a.preload(b+1)})})}},{key:"checki18nCache",value:function(){if(localStorage.Wikiplus_i18nCache)try{var b=JSON.parse(localStorage.Wikiplus_i18nCache);for(var c in b)b[c].__version===this.langVersion?f[b[c].__language]=b[c]:(console.log("å¤šè¯­è¨€æ–‡ä»¶["+c+"]å·²ç»è¿‡æœŸ"),a(b[c].__language))}catch(d){e("cant_parse_i18ncache")}else localStorage.Wikiplus_i18nCache=JSON.stringify(f)}},{key:"editEveryWhere",value:function(){var a=this;$("#mw-content-text a.external").each(function(a){for(var c,d=$(this).attr("href"),e=/(([^?&=]+)(?:=([^?&=]*))*)/g,f={};c=e.exec(d);)f[c[2]]=decodeURIComponent(c[3]);"edit"===f.action&&void 0!==f.title&&"new"!==f.section&&$(this).after($("<a>").attr({href:"javascript:void(0)","class":"Wikiplus-Edit-EveryWhereBtn"}).text("("+b("quickedit_sectionbtn")+")").data({target:decodeURIComponent(f.title),number:f.section||-1}))}),$(".Wikiplus-Edit-EveryWhereBtn").click(function(){a.initQuickEditInterface($(this))})}},{key:"createDialogBox",value:function(){var a=arguments.length<=0||void 0===arguments[0]?"Dialog Box":arguments[0],b=arguments.length<=1||void 0===arguments[1]?$("<div>"):arguments[1],c=arguments.length<=2||void 0===arguments[2]?600:arguments[2],d=arguments.length<=3||void 0===arguments[3]?new Function:arguments[3];$(".Wikiplus-InterBox").length>0&&$(".Wikiplus-InterBox").each(function(){$(this).remove()});var e=document.body.clientWidth,f=document.body.clientHeight,g=$("<div>").addClass("Wikiplus-InterBox").css({"margin-left":e/2-c/2,top:$(document).scrollTop()+.2*f,display:"none"}).append($("<div>").addClass("Wikiplus-InterBox-Header").html(a)).append($("<div>").addClass("Wikiplus-InterBox-Content").append(b)).append($("<span>").text("X").addClass("Wikiplus-InterBox-Close"));$("body").append(g),$(".Wikiplus-InterBox").width(c),$(".Wikiplus-InterBox-Close").click(function(){$(this).parent().fadeOut("fast",function(){window.onclose=window.onbeforeunload=void 0,$(this).remove()})});var h=function i(a){a.mousedown(function(b){var c=b.clientX,d=b.clientY,e=a.parent().offset().left,f=a.parent().offset().top;$(document).mousemove(function(b){a.parent().css({"margin-left":e+b.clientX-c,top:f+b.clientY-d})}),$(document).mouseup(function(){a.unbind("mousedown"),$(document).unbind("mousemove"),$(document).unbind("mouseup"),i(a)})})};h($(".Wikiplus-InterBox-Header")),$(".Wikiplus-InterBox").fadeIn(500),d()}},{key:"addFunctionButton",value:function(a,b,c){var d=$("<li></li>").attr("id",b).append($("<a></a>").attr("href","javascript:void(0);").text(a));$("#p-cactions").length>0?($("#p-cactions ul").append(d),$("#p-cactions ul").find("li").last().click(c)):e("cant_add_funcbtn")}},{key:"preload",value:function(){var a=arguments.length<=0||void 0===arguments[0]?-1:arguments[0],b=arguments.length<=1||void 0===arguments[1]?this.kotori.pageName:arguments[1],c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];c.success=c.success||new Function,c.fail=c.fail||new Function;var e=this;if(void 0!==d.oldid){if(console.log(typeof d.oldid),this.preloadData[d.oldid+"."+a])return console.log("[ä¿®è®¢ç‰ˆæœ¬"+d.oldid+"."+a+"]å·²ç»é¢„è¯»å– è·³è¿‡æœ¬æ¬¡é¢„è¯»å–"),void c.success(this.preloadData[d.oldid+"."+a])}else if(this.preloadData[b+"."+a])return console.log("["+b+"."+a+"]å·²ç»é¢„è¯»å– è·³è¿‡æœ¬æ¬¡é¢„è¯»å–"),void c.success(this.preloadData[b+"."+a]);this.kotori.getWikiText({success:function(f){void 0!==d.oldid?(e.preloadData[d.oldid+"."+a]=f,console.log("é¢„è¯»å–[ä¿®è®¢ç‰ˆæœ¬"+d.oldid+"."+a+"]æˆåŠŸ")):(e.preloadData[b+"."+a]=f,console.log("é¢„è¯»å–["+b+"."+a+"]æˆåŠŸ")),c.success(f)},fail:function(e){void 0!==d.oldid?console.log("é¢„è¯»å–[ä¿®è®¢ç‰ˆæœ¬"+d.oldid+"."+a+"]å¤±è´¥"):console.log("é¢„è¯»å–["+b+"."+a+"]å¤±è´¥:"+e.message),c.fail(e)}},b,$.extend({section:-1===a?"":a},d))}},{key:"sendStatistic",value:function(a,b){void 0===a&&(a=mw.config.get("wgPageName")),"True"==localStorage.Wikiplus_SendStatistics&&$.ajax({url:g+"/statistics/api/submit",type:"POST",dataType:"json",data:{wikiname:mw.config.get("wgSiteName"),usetime:b,username:mw.config.get("wgUserName"),pagename:a},success:function(a){}})}},{key:"checkInstall",value:function(a){var c=this;if(!localStorage.Wikiplus_Installed||"False"==localStorage.Wikiplus_Installed){var d=function(){localStorage.Wikiplus_Installed="True",localStorage.Wikiplus_Version=c.version,localStorage.Wikiplus_StartUseAt=(new Date).valueOf(),localStorage.Wikiplus_SrartEditCount=mw.config.get("wgUserEditCount"),localStorage.Wikiplus_Settings=JSON.stringify(c.defaultSettings),$(".Wikiplus-InterBox").fadeOut("fast",function(){c.notice.create.success(b("install_finish")),$(this).remove()})},e=$("<div>").text(b("install_tip").replace(/\$1/gi,mw.config.get("wgSiteName"))).attr("id","Wikiplus-InterBox-Content"),f=$("<div>").addClass("Wikiplus-InterBox-Btn").attr("id","Wikiplus-Setting-Apply").text(b("accept")),g=$("<div>").addClass("Wikiplus-InterBox-Btn").attr("id","Wikiplus-Setting-Cancel").text(b("decline")),h=$("<div>").append(e).append($("<hr>")).append(f).append(g);c.createDialogBox("å®‰è£…Wikiplus",h,600,function(){$("#Wikiplus-InterBox-Content").css("text-align","left"),$("#Wikiplus-Setting-Apply").click(function(){localStorage.Wikiplus_SendStatistics="True",d()}),$("#Wikiplus-Setting-Cancel").click(function(){localStorage.Wikiplus_SendStatistics="False",d()})})}}},{key:"getSetting",value:function(a,b){var c=b;try{var d=JSON.parse(localStorage.Wikiplus_Settings)}catch(e){return localStorage.Wikiplus_Settings||""}try{var f=new Function("return "+d[a]);if("function"!=typeof f)return d[a];try{return f()(c)===!0?void 0:f()(c)||d[a]}catch(e){return d[a]}}catch(e){try{return d[a]}catch(e){return void 0}}}},{key:"initBasicFunctions",value:function(){this.initQuickEdit(),this.editSettings(),this.simpleRedirector(),this.preloadEventBinding(),this.getSetting("disableEditEveryWhere")||this.editEveryWhere()}},{key:"initRecentChangesPageFunctions",value:function(){}},{key:"initAdvancedFunctions",value:function(){}}]),c}();window.Wikiplus=new c})});