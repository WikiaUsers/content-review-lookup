var wgNamespaceNumber = mw.config.values.wgNamespaceNumber;
var wgPageName = mw.config.values.wgPageName;
// JavaScript code for Expansion table of Buildings
function expLoader()
{
	function escRegEx(str) { return str.replace(/[\[\]\/\{\}\(\)\-\?\$\*\+\.\\\^\|]/g, "\\$&"); }
	function prntf(s,r)
	{
		var k = Object.keys(r);
		var i = k.length;
		while(i--) { s = s.replace(new RegExp(escRegEx('{'+k[i]+'}'),'g'),r[k[i]]); }
		return s;
	}
	var lg = mw.config.values.wgContentLanguage;
	var LD = {
		notbl: 'No building table',
		units: {
			second: ['s','seconds','second'],
			minute: ['m','minutes','minute'],
			hour: ['h','hours','hour'],
			day: ['D','days','day'],
			month: ['M','months','month'],
			year: ['Y','years','year'],
			century: ['C','centuries','century']
		},
		tho: ',',
		dec: '.',
		bigtooltip: 'Tooltip dimensions exceed<br />your browser&apos;s dimensions.<br />Contact the wiki administrators.<br />Thank you.',
		and: 'and',
		wood: 'Wood',
		wine: 'Wine',
		marble: 'Marble',
		glass: 'Crystal',
		sulfur: 'Sulfur',
		ambrosia: 'Ambrosia',
		gold: 'Gold',
		citizen: 'Citizen',
		aristocracy: 'Aristocracy',
		oligarchy: 'Oligarchy',
		resgenit: ['wood','wine','marble','crystal','sulfur'],
		resrds: ['P','G','SL','MR','Pulley','Geometry','Spirit Level','Maximum Reduction'],
		headertips: ['Go to page<br />"<b>Resources</b>"','Construction duration','Minimum amount and levels<br />of warehouses and dumps','Master Builders<br />Score','Here you will find info for<br />the required quantities<br />{0}<br />(per level and accumulative),<br />considering the<br />research effects and of<br />the respective reduction building<br />{1}'],
		restips: {
			nores: 'No Research or No Reduction Building<br />(<b>0 %</b> Reduction)<br /><b>{0}</b> crates {1}',
			rdres: ['Pulley','Geometry','Spirit Level','Maximum Reduction'],
			none: ['No crates<br />{0}<br />necessary<br />for Level <b>{1}</b>','No Research or No Reduction Building<br />(<b>0 %</b> Reduction)<br /><b>{0}</b> crates {1}<br />for the completion <b>{2}</b> of Level <b>{3}</b>'],
			table: ['Research','Researches','Researches<br />Sum','Reduction building','Level','Percentage','Total<br />percentage','Quantity {0}','reduction','final','accumulative'],
			mr: 'Maximum reduction<br />({0} % + {1} % + {2} % + {3} % = {4} %)<br /><b>{5} &times; {6} % = {7} &asymp; {8} {12}<br />({9} &times; {6} % = {10} &asymp; {11} {12})</b>',
		},
		durtips: {
			displayed: 'The displayed construction time<br />(no government effect)',
			actual: 'The actual construction time<br />(no government effect)',
			accum: 'The accumulative construction time<br />(no government effect)',
			SBT: 'Shorten Building Time will reduce<br />by ½ the actual construction time.<br />The new construction time will be:<br /><b>{0}</b>',
			CI: 'With "Completion Instantly" the building<br />construction is completed <b>instantly</b>',
			ambro: '<b>{0}</b> Ambrosia required<br />with each click!',
			SBTCI: 'Shorten Building Time will reduce<br />by ½ the actual construction time.<br />The new construction time will be:<br /><b>{0}</b><br />The 2<sup>nd</sup> click or Completion Instantly (CI)<br />completes the construction instantly.',
			aristocracy: 'The construction time after it has<br />been reduced by the goverment form of "<b>Aristocracy</b>"<br /><b>{0}</b>',
			oligarchy: 'The construction time after it has<br />been increased by the goverment form of "<b>Oligarchy</b>"<br /><b>{0}</b>',
		},
		storagetips: ['Minimum number<br />of warehouses','Minimum number<br />of dumps','Ambrosia<br />Use','{1} {0}','No use of Ambrosia','With use of Ambrosia','With the research of Pulley','With the research of Geometry','With the research of Spirit Level','With Maximum Reduction','Minimum required level<br />{0}<br />{1} {2}','with no researches','with the research of "<b>Pulley</b>"','with the research of "<b>Geometry</b>»','with the research of "<b>Spirit Level</b>»','with the "<b>Maximum Reduction</b>"','without "<b>Ambrosia</b>"','with "<b>Ambrosia</b>"','of Warehouse <b>{0}</b>','of Dump <b>{0}</b>','No construction is required<br />{0}'],
		scoretips: ['Resources','Points','Type','Quantity'],
		academy: {
			name: 'Academy',
			headertips: ['Maximum amount<br />of scientists']
		},
		alchemist: {
			name: 'Alchemist Tower',
		},
		architect: {
			name: 'Architect&apos;s Office',
		},
		barracks: {
			name: 'Barracks',
		},
		blackMarket: {
			name: 'Black Market',
		},
		branchOffice: {
			name: 'Trading Post',
		},
		carpentering: {
			name: 'Carpenter',
		},
		dockyard: {
			name: 'Dockyard',
		},
		dump: {
			name: 'Dump',
			extracoltips: ['No use of Ambrosia','Town Hall storage capacity','Storage capacity<br />of Level {0} Dump','Storage capacity Sum','With use of Ambrosia']
		},
		embassy: {
			name: 'Embassy',
		},
		fireworker: {
			name: 'Firework Test Area',
		},
		forester: {
			name: 'Forester&apos;s House',
		},
		glassblowing: {
			name: 'Glassblower',
		},
		marineChartArchive: {
			name: 'Sea Chart Archive',
		},
		museum: {
			name: 'Museum',
		},
		optician: {
			name: 'Optician',
		},
		palace: {
			name: 'Palace',
		},
		palaceColony: {
			name: 'Governor&apos;s Residence',
		},
		pirateFortress: {
			name: 'Pirate Fortress',
		},
		port: {
			name: 'Trading Port',
		},
		safehouse: {
			name: 'Hideout',
		},
		shipyard: {
			name: 'Shipyard',
		},
		shrineofolympus: {
			name: 'Gods&apos; Shrine',
		},
		stonemason: {
			name: 'Stonemason',
		},
		tavern: {
			name: 'Tavern',
		},
		temple: {
			name: 'Temple',
		},
		townHall: {
			name: 'Town Hall',
		},
		vineyard: {
			name: 'Wine Press',
		},
		wall: {
			name: 'Town Wall',
		},
		warehouse: {
			name: 'Warehouse',
			extracoltips: ['Ambrosia<br />use','Total<br />capacity','Secured<br />capacity','Active<br />user','Inactive<br />user','Town Hall<br />storage<br />capacity','Warehouse Level {0}<br />storage capacity','Capacity<br />Sum','Without use of Ambrosia','With use of Ambrosia','{0} {1} {2} {3}','Total capacity','Secured capacity','Capacity Sum','Secured capacity sum','of "Town Hall"','of "Warehouse" Level {0}','without Ambrosia','with Ambrosia','of active user','of inactive user','Go to<br />"Capacity calculator"']
		},
		winegrower: {
			name: 'Winegrower',
		},
		workshop: {
			name: 'Workshop',
		},
	};
	var bData = {
		academy: {
			maxLevel:50,
			wood:[64,68,115,263,382,626,982,1330,2004,2665,3916,5156,7446,9753,12751,18163,23691,33451,43572,56729,73833,103459,144203,175058,243930,317208,439968,536310,743789,1027470,1257246,1736683,2398948,3313760,4577426,6322978,8734177,12064860,16665662,23020930,31799710,43926182,60676950,83815441,115777543,159928042,220914850,305158310,421527091,582271834],
			glass:[0,0,0,0,225,428,744,1089,1748,2454,3786,5216,7862,10729,14599,21627,29322,43020,58213,78724,106414,154857,224146,282572,408877,552141,795252,1006648,1449741,2079651,2642548,3790583,5437373,7799598,11188075,16048650,23020865,33022105,47368310,67947114,97466224,139809688,200548951,287675926,412654558,591929211,849088381,1217968409,1747105576,2506122386],
			maxS:[8,12,16,22,28,35,43,51,60,69,79,89,100,111,122,134,146,159,172,185,198,212,227,241,256,271,287,302,318,335,351,368,385,404,424,444,466,488,512,537,563,590,619,649,680,713,748,784,822,862],
			time:{a:1440,b:1,c:1.2,d:720,e:[984]},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		alchemist: {
			maxLevel:61,
			wood:[274,467,718,1045,1469,2021,2738,3671,4883,6459,8508,11172,14634,19135,24987,32594,42483,55339,72051,93778,122022,158740,206472,268525,349194,454063,590393,767621,998019,1297536,1686907,2193090,2851161,3706696,4818949,6264951,8144848,10588838,13766186,17896947,23267208,30248900,39325559,51125812,66466917,86411362,112340452,146049973,189874567,246849419,320920474,417217714,542410456,705169252,916766387,1191856573,1549491900,2014441336,2618906170,3404750192,4426399083],
			marble:[0,116,255,436,671,977,1375,1892,2564,3437,4572,6049,7968,10462,13705,17921,23402,30527,39790,51831,67485,87835,114290,148681,193390,251512,327069,425295,552987,718988,934789,1215330,1580064,2054260,2670767,3472295,4514372,5869187,7630598,9920629,12897924,16768741,21801234,28344037,36850411,47909647,62287886,80981202,105284598,136881725,177961516,231369827,300806590,391082130,508450405,661042257,859428691,1117353190,1452683817,1888651047,2455457089],
			time:{a:72000,b:11,c:1.1,d:6120},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		architect: {
			maxLevel:50,
			wood:[185,291,413,555,720,911,1133,1390,1689,2035,2437,2902,3443,4070,4797,5640,6619,7754,9070,10598,12369,14424,16808,19573,22781,26502,30818,35825,41633,48371,56186,65252,75780,88008,102209,118701,137854,160098,185931,215933,250775,291239,338233,392809,456192,529802,615289,714570,829871,963777,320920474,417217714,542410456,705169252,916766387,1191856573,1549491900,2014441336,2618906170,3404750192,4426399083],
			marble:[106,160,222,295,379,475,587,716,865,1036,1233,1460,1722,2023,2369,2767,3226,3753,4359,5056,5857,6778,7836,9052,10449,12055,13899,16017,18451,21246,24455,28141,32382,37263,42880,49343,56780,65338,75186,86519,99560,114566,131834,151705,174571,200884,231162,266004,306098,352235,177961516,231369827,300806590,391082130,508450405,661042257,859428691,1117353190,1452683817,1888651047,2455457089],
			time:[{a:125660,b:37,c:1.06,d:2628},{a:156455,b:68,c:1.068703,d:0,e:{37:-1,43:1,48:1,49:1}}],
			get dur(){var t=[],f=this.time;for(var i=0;i<this.maxLevel;i++){var h=i<32?0:1,g=(f[h].a/f[h].b*Math.pow(f[h].c,i+1)-f[h].d)-(f[h].e!=undefined&&f[h].e[i+1]!=undefined?f[h].e[i+1]:0);g=i<32?Math.round(g):Math.floor(g);t.push((g>1728e3?1728e3:g));}return t;}
		},
		barracks: {
			maxLevel:49,
			wood:[49,114,195,296,420,574,766,1003,1297,1662,2115,2676,3371,4234,5304,6630,8275,10314,12843,15979,19868,24690,30669,38083,47277,58676,72812,90341,112076,139028,172448,213889,265276,328996,408008,505984,627473,778120,964923,1196558,1483785,1839947,2281588,2829223,3508290,4350333,5394466,6689191,8294651,10285438,12753995,15815008,19610663,24317276],
			marble:[0,0,0,0,0,0,0,0,178,431,745,1134,1616,2214,2956,3875,5015,6429,8183,10357,13052,16395,20540,25680,32054,39957,49757,61909,76977,95661,118830,147560,183185,227359,282136,350059,434283,538721,668224,828808,1027932,1274847,1581020,1960675,2431447,3015205,3739064,4636650,5749656,7129795,8841156,10963244,13594633,16857554],
			time:{a:25200,b:11,c:1.1,d:1728,e:[732]},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		blackMarket: {
			maxLevel:25,
			wood:[440,887,1360,1890,2516,3288,4263,5505,7086,9086,11590,14691,18489,23088,28600,35143,42839,51820,62218,74175,87838,103356,120888,140596,162647],
			marble:[260,525,807,1126,1509,1988,2601,3390,4403,5693,7315,9331,11807,14812,18420,22708,27757,33654,40486,48348,57334,67546,79087,92064,106587],
			tax:(function(){var tax=[];for(var i=0;i<25;i++){tax.push(-(i+1)+29-(i==23?1:(i==24?3:0)));}return tax;})(),
			time:{a:4321,b:1,c:1.1,d:4627},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		branchOffice: {
			maxLevel:72,
			wood:[48,173,346,581,896,1314,1863,2580,3509,4706,6241,8203,10699,13866,17872,22926,29286,37273,47283,59807,75448,94955,119245,149454,186977,233530,291226,362658,451015,560208,695038,861391,1066671,1319986,1632576,2018313,2494313,3081696,3806527,4701842,5807739,7173750,8861054,10945220,13519593,16699472,20627275,25478918,31471693,38874000,48017368,59311304,73261632,90493151,111777613,138068292,170542676,210655204,260202409,321403375,396999129,490375398,605714254,748181411,924157588,1141524281,1410016756,1741660064,2151307610,2657306400,3282318749,4054337268],
			marble:[0,0,0,0,540,792,1123,1555,2115,2837,3762,4945,6450,8359,10774,13820,17654,22469,28503,36052,45482,57240,71883,90093,112713,140776,175556,218616,271879,337703,418980,519261,643008,795711,984147,1216678,1503620,1857706,2294649,2834363,3501021,4324482,5341624,6598005,8149893,10066794,12434562,15359241,18971822,23434103,28945937,35754186,44163773,54551344,67382130,83230789,102807143,126987967,156856259,193749742,239320781,295610388,365139630,451022544,557105608,688140010,849994448,1049917969,1296864638,1601894565,1978669263,2444063509],
			cap:(function(){var cap=[];for(var i=0;i<71;i++){cap.push(i<39?400*Math.pow(i+1,2):80218*Math.pow(Math.exp(0.052),i+1));}return cap;})(),
			time:{a:108000,b:11,c:1.1,d:9360},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		carpentering: {
			maxLevel:50,
			wood:[63,122,192,274,372,486,620,777,962,1178,1432,1730,2078,2486,2964,3524,4178,4945,5841,6890,8117,9551,11229,13190,15484,18165,21299,24963,29245,34249,40096,46930,54928,64290,75248,88074,103085,120655,141220,165290,193462,226436,265030,310202,363073,424955,497385,582160,681384,797520],
			marble:[0,0,0,0,0,0,0,359,444,546,669,816,993,1205,1459,1765,2131,2571,3098,3731,4491,5402,6496,7809,9384,11275,13543,16265,19531,23451,28154,33799,40575,48711,58478,70203,84279,101178,121464,145818,175056,210155,252292,302878,363607,436512,524034,629105,755244,906674],
			time:[{a:125660,b:37,c:1.06,d:2808},{a:125031,b:56,c:1.069394,d:0}],
			get dur(){var t=[],f=this.time;for(var i=0;i<this.maxLevel;i++){var h=i<32?0:1,g=(f[h].a/f[h].b*Math.pow(f[h].c,i+1)-f[h].d)-(f[h].e!=undefined&&f[h].e[i+1]!=undefined?f[h].e[i+1]:0);g=i<32?Math.round(g):Math.floor(g);t.push((g>1728e3?1728e3:g));}return t;}
		},
		dockyard: {
			maxLevel:50,
			wood:[504483,605763,727300,873144,1048157,1258172,1510191,1812613,2175519,2611007,3133593,3760773,4513481,5416842,6501009,7802168,9363751,11237881,13487113,16186522,19426211,23314315,27980612,33580856,40301974,48368305,58049091,69667459,83611213,100345772,120429707,144533388,173461356,208179178,249845678,299851616,359866107,431892337,518334422,622077657,746584820,896011756,1075346089,1290573705,1548878546,1858882405,2230932698,2677447853,3213331811,3856471495],
			marble:[291703,344555,406921,480512,567350,669818,790731,933409,1101768,1300432,1534855,1811536,2138093,2523518,2978421,3515328,4149020,4896945,5779696,6821575,8051270,9502636,11215633,13237425,15623676,18440085,21764196,25687530,30318105,35783412,42233927,49847246,58832983,69438540,81955911,96729733,114166765,134747092,159037342,187706285,221543249,261479849,308615640,364248387,429909798,507407694,598875786,706832418,834249904,984636364],
			glass:[246865,289158,338642,396537,464275,543528,636254,744743,871676,1020188,1193946,1397298,1635285,1913806,2239765,2621241,3067690,3590178,4201655,4917280,5754789,6734942,7882035,9224500,10795613,12634317,14786189,17304567,20251874,23701164,27737937,32462251,37991209,44461856,52034581,60897089,71269056,83407573,97613516,114239010,133696151,156467225,183116658,214305012,250805354,293522418,343515036,402022375,470494660,550629117],
			time:[{a:125660,b:37,c:1.06,d:2808},{a:125031,b:56,c:1.069394,d:0}],
			dur:[271230,317706,370800,435600,507600,594000,698400,817200,957600,1119600,1310400,1533600,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000],
			get costs(){return Array.apply(null,{length:this.maxLevel*21+1}).map(Number.call,Number).slice(1).map(function(c){return Math.floor(8e6*Math.pow(1.003,c));});}
		},
		dump: {
			maxLevel:80,
			wood:[640,1152,1766,2504,3388,4450,5724,7253,9088,11289,13931,17101,20905,25470,30948,37522,45410,54876,66236,79867,96224,115853,139408,167673,201592,242294,291137,349749,420082,504483,605763,727300,873144,1048157,1258172,1510191,1812613,2175519,2611007,3133593,3760773,4513481,5416842,6501009,7802168,9363751,11237881,13487113,16186522,19426211,23314315,27980612,33580856,40301974,48368305,58049091,69667459,83611213,100345772,120429707,144533388,173461356,208179178,249845678,299851616,359866107,431892337,518334422,622077657,746584820,896011756,1075346089,1290573705,1548878546,1858882405,2230932698,2677447853,3213331811,3856471495,4628333851],
			marble:[497,932,1445,2051,2762,3609,4604,5778,7164,8799,10728,13005,15691,18862,22602,27016,32225,38371,45623,54181,64279,76195,90256,106847,126425,149528,176788,208956,246913,291703,344555,406921,480512,567350,669818,790731,933409,1101768,1300432,1534855,1811536,2138093,2523518,2978421,3515328,4149020,4896945,5779696,6821575,8051270,9502636,11215633,13237425,15623676,18440085,21764196,25687530,30318105,35783412,42233927,49847246,58832983,69438540,81955911,96729733,114166765,134747092,159037342,187706285,221543249,261479849,308615640,364248387,429909798,507407694,598875786,706832418,834249904,984636364,1162132312],
			glass:[701,1146,1668,2278,2991,3526,4803,5946,7283,8847,10678,12819,15325,18257,21687,25700,30395,35889,42316,49837,58635,68930,80974,95066,111554,130844,153414,179821,201717,246865,289158,338642,396537,464275,543528,636254,744743,871676,1020188,1193946,1397298,1635285,1913806,2239765,2621241,3067690,3590178,4201655,4917280,5754789,6734942,7882035,9224500,10795613,12634317,14786189,17304567,20251874,23701164,27737937,32462251,37991209,44461856,52034581,60897089,71269056,83407573,97613516,114239010,133696151,156467225,183116658,214305012,250805354,293522418,343515036,402022375,470494660,550629117,644412042],
			sulfur:[384,845,1398,2061,2858,3813,4960,6336,7987,9968,12346,15199,18623,22731,27661,33578,40677,49197,59420,71688,86410,104076,125275,150714,181241,217873,261831,314582,377882,453843,544995,654378,785638,943149,1132163,1358980,1631160,1957775,2349715,2820041,3384508,4061962,4875016,5850814,7021931,8427462,10114328,12138842,14568589,17484682,20984469,25184783,30225845,36275940,43537042,52251547,62710373,75262669,90327471,108407688,130106896,156149483,187404832,224916345,269936275,323967529,388813842,466639986,560044045,672144141,806682527,968150521,1161938432,1394515513,1673645920,2008647905,2410704893,2893238813,3472358170,4167395793],
			cp:[32000,65401,101073,139585,181437,227119,277128,331991,392268,458564,531535,611896,700427,797983,905498,1024000,1154614,1298578,1457248,1632119,1824830,2037185,2271165,2528951,2812939,3125764,3470326,3849813,4267731,4727939,5234678,5792619,6406896,7083160,7827629,8647143,9549229,10542172,11635086,12838003,14161964,15619122,17222851,18987875,20930401,23068269,25421121,28010583,30860463,33996977,37448993,41248299,45429902,50032358,55098129,60673986,66811447,73567262,81003948,89190382,98202448,108123754,119046431,131072000,144312338,158890744,174943109,192619216,212084166,233519956,257127222,283127160,311763649,343305589,378049493,416322336,458484710,504934306,556109751,612494861],
			time:{a:32000,b:13,c:1.17,d:2160},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		embassy: {
			maxLevel:78,
			wood:[242,415,623,873,1173,1532,1964,2482,3103,3849,4743,5817,7105,8651,10507,12733,15404,18610,22457,27074,32614,39261,47239,56811,68299,82084,98625,118475,142295,170879,205180,246341,295759,355091,426325,511850,614532,737813,885825,1063530,1276884,1533039,1840581,2209819,2653129,3185371,3824386,4591594,5512710,6618610,7946365,9540479,11454387,13752243,16511069,19823342,23800088,28574605,34306934,41189221,49452159,59372718,71283433,85583548,102752396,123365475,148113727,177826706,213500383,256330529,307752797,369490846,443614117,532607199,639453115,767733306,921747687,1106658773],
			marble:[155,342,571,850,1190,1606,2112,2730,3484,4404,5527,6896,8566,10604,13090,16123,19824,24339,29846,36566,44764,54765,66967,81853,100014,122170,149201,182178,222411,271495,331377,404433,493595,602413,735223,897312,1095135,1336570,1631233,1990858,2429766,2965437,3619203,4417100,5390902,6579391,8029896,9800182,11960748,14597638,17815861,21743579,26537210,32387654,39527897,48242292,58877879,71858208,87700204,107034757,130631842,159431185,194579686,237477091,289831740,353728594,431712268,526888372,643047178,784814575,957836281,1169002678,1426723219,1741261318,2125143080,2593656142,3165458480,3863321442],
			dp:(function(){var dp=[];for(var i=0;i<78;i++){dp.push(i+3);}return dp;})(),
			time:{a:96000,b:7,c:1.05,d:10080},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		fireworker: {
			maxLevel:50,
			wood:[273,353,445,551,673,813,974,1159,1373,1618,1899,2223,2596,3025,3517,4084,4736,5486,6347,7339,8479,9790,11297,13031,15025,17318,19955,22987,26474,30484,35096,40400,46505,53533,61624,70937,81658,93999,108205,124557,143382,165051,189995,218708,251761,289810,333608,384026,442063,508872],
			marble:[135,212,302,405,526,665,827,1015,1233,1486,1779,2120,2514,2972,3503,4119,4834,5662,6624,7739,9033,10534,12275,14294,16637,19354,22507,26163,30405,35325,41033,47653,55341,64269,74638,86679,100664,116904,135765,157668,183106,212647,246954,286796,333066,386801,449205,521677,605841,703583],
			time:[{a:125660,b:37,c:1.06,d:2628},{a:156455,b:68,c:1.068703,d:0,e:{37:-1,43:1,48:1,49:1}}],
			get dur(){var t=[],f=this.time;for(var i=0;i<this.maxLevel;i++){var h=i<32?0:1,g=(f[h].a/f[h].b*Math.pow(f[h].c,i+1)-f[h].d)-(f[h].e!=undefined&&f[h].e[i+1]!=undefined?f[h].e[i+1]:0);g=i<32?Math.round(g):Math.floor(g);t.push((g>1728e3?1728e3:g));}return t;}
		},
		forester: {
			maxLevel:61,
			wood:[250,430,664,968,1364,1878,2546,3415,4544,6013,7922,10403,13629,17823,23274,30362,39575,51552,67123,87365,113680,147889,192360,250173,325330,423035,550050,715170,929826,1208879,1571647,2043247,2656358,3453445,4489711,5836927,7588399,9865430,12825724,16674305,21677721,28182498,36639146,47633359,61926577,80508723,104666764,136073846,176905169,229988640,299000730,388721096,505363618,657006755,854153052,1110456522,1443668303,1876866070,2440052358,3172232480,4124115974],
			marble:[0,104,237,410,635,928,1309,1803,2446,3282,4368,5781,7617,10004,13108,17142,22387,29204,38068,49590,64569,84042,109357,142266,185047,240664,312965,406956,529145,687990,894489,1162938,1511952,1965711,2555649,3322636,4319807,5616243,7301758,9493121,12342143,16046197,20861892,27122845,35262801,45845674,59604620,77492822,100749532,130985914,170296669,221405146,287852011,374240536,486555497,632577793,822423477,1069244578,1390140238,1807341295,2349750384],
			time:{a:72000,b:11,c:1.1,d:6120},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		glassblowing: {
			maxLevel:61,
			wood:[274,467,718,1045,1469,2021,2738,3671,4883,6459,8508,11172,14634,19135,24987,32594,42483,55339,72051,93778,122022,158740,206472,268525,349194,454063,590393,767621,998019,1297536,1686907,2193090,2851161,3706696,4818949,6264951,8144848,10588838,13766186,17896947,23267208,30248900,39325559,51125812,66466917,86411362,112340452,146049973,189874567,246849419,320920474,417217714,542410456,705169252,916766387,1191856573,1549491900,2014441336,2618906170,3404750192,4426399083],
			marble:[0,116,255,436,671,977,1375,1892,2564,3437,4572,6049,7968,10462,13705,17921,23402,30527,39790,51831,67485,87835,114290,148681,193390,251512,327069,425295,552987,718988,934789,1215330,1580064,2054260,2670767,3472295,4514372,5869187,7630598,9920629,12897924,16768741,21801234,28344037,36850411,47909647,62287886,80981202,105284598,136881725,177961516,231369827,300806590,391082130,508450405,661042257,859428691,1117353190,1452683817,1888651047,2455457089],
			time:{a:72000,b:11,c:1.1,d:6120},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		marineChartArchive: {
			maxLevel:40,
			wood:[578,1298,2133,3102,4226,5530,7042,8796,10831,13191,15929,19106,22790,27064,32022,37773,44444,52183,61159,71572,83651,97663,113917,132771,154642,180012,209442,243580,283180,329116,382402,444214,515916,599090,695572,807491,937317,1087916,1262610,1465255],
			marble:[346,1066,1916,2918,4101,5497,7144,9088,11381,14088,17281,21050,25496,30743,36935,44241,52862,63035,75039,89204,105918,125641,148914,176377,208782,247021,292142,345385,408212,482348,569829,673055,794863,938596,1108201,1308335,1544493,1823160,2151986,2540001],
			glass:[161,611,1142,1769,2508,3380,4410,5625,7058,8750,10746,13101,15880,19159,23029,27595,32984,39342,46844,55697,66144,78470,93016,110180,130434,154333,182533,215810,255077,301412,356088,420604,496734,586567,692571,817654,965253,1139420,1344936,1587446],
			durs:[[36,5965,346,23655,1252,58749],[71,5930,680,23321,2447,57554],[106,5895,1004,22997,3590,56411],[140,5861,1318,22683,4683,55318],[174,5827,1622,22379,5731,54270],[207,5794,1918,22083,6737,53264],[240,5761,2204,21797,7702,52299],[272,5729,2483,21518,8629,51372],[304,5697,2753,21248,9522,50479],[335,5666,3016,20985,10380,49621],[366,5635,3272,20729,11208,48793],[217,5604,3521,20480,12006,47995],[427,5574,3763,20238,12776,47225],[457,5544,3999,20002,13519,46482],[486,5515,4228,19773,14237,45764],[515,5486,4452,19549,14931,45070],[543,5458,4670,19331,15603,44398],[571,5430,4883,19118,16254,43747],[599,5402,5091,18910,16883,43118],[627,5374,5293,18708,17494,42507],[654,5347,5491,18510,18086,41915],[680,5321,5684,18317,18660,41341],[707,5294,5872,18129,19218,40783],[733,5268,6057,17944,19759,40242],[758,5243,6237,17764,20285,39716],[784,5217,6413,17588,20796,39205],[809,5192,6585,17416,21293,38708],[834,5167,6753,17248,21777,38224],[858,5143,6918,17083,22248,37753],[882,5119,7079,16922,22706,37295],[906,5095,7237,16764,23152,36849],[930,5071,7391,16610,23587,36414],[953,5048,7542,16459,24011,35990],[976,5025,7691,16310,24425,35576],[999,5002,7836,16165,24828,35173],[1021,4980,7978,16023,25222,34779],[1043,4958,8118,15883,25606,34395],[1065,4936,8254,15747,25981,34020],[1087,4914,8388,15613,26347,33654],[1108,4893,8520,15481,26705,33296]],
			time:{a:1472465,b:509,c:1.12,d:504.5},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		museum: {
			maxLevel:36,
			wood:[560,1435,2748,4716,7669,12099,18744,28710,43661,66086,99724,150181,225866,339394,509686,765124,1148281,1723017,2585121,3878276,5818009,8727906,13093198,19641805,29465722,44203104,66311437,99477330,149231256,223869780,335839016,503810048,755792366,1133804502,1700880700,2551581997],
			marble:[280,1190,2573,4676,7871,12729,20112,31335,48394,74323,113736,173643,264701,403110,613492,933272,1419338,2158158,3281165,4988136,7582731,11526912,17522673,26637149,40492547,61554876,93572844,142245060,216234287,328709247,499688421,759602961,1154712888,1755340514,2668386534,4056356382],
			hpPLv:[20,41,63,88,114,144,176,211,250,294,341,395,453,518,590,670,759,857,965,1086,1219,1367,1530,1711,1912,2134,2380,2652,2953,3286,3655,4064,4516,5016,5569,6182],
			time:{a:18000,b:1,c:1.1,d:14040},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		optician: {
			maxLevel:50,
			wood:[119,188,269,362,471,597,742,912,1108,1335,1600,1906,2261,2673,3152,3706,4350,5096,5962,6966,8131,9482,11050,12868,14978,17424,20263,23555,27374,31805,36944,42905,49827,57867,67204,78048,90641,105266,122251,141977,164886,191490,222388,258271,299943,348340,404545,469820,545626,633665],
			marble:[0,35,96,167,249,345,455,584,733,905,1106,1338,1608,1921,2283,2704,3192,3759,4416,5178,6062,7087,8276,9656,11257,13113,15267,17765,20663,24025,27924,32448,37704,43813,50911,59160,68744,79882,92823,107862,125337,145643,169239,196657,228518,265541,308562,358552,416642,484142],
			time:[{a:125660,b:37,c:1.06,d:2772},{a:168457,b:75,c:1.069256,d:0,e:{39:-1,44:-1,50:1}}],
			get dur(){var t=[],f=this.time;for(var i=0;i<this.maxLevel;i++){var h=i<32?0:1,g=(f[h].a/f[h].b*Math.pow(f[h].c,i+1)-f[h].d)-(f[h].e!=undefined&&f[h].e[i+1]!=undefined?f[h].e[i+1]:0);g=Math.round(g);t.push((g>1728e3?1728e3:g));}return t;}
		},
		palace: {
			maxLevel:20,
			wood:[712,5824,16048,36496,77392,159184,322768,649936,1304272,2612944,4743518,8611345,15632968,28379968,51520771,93530403,169794358,308243344,559582545,1015861754],
			wine:[0,0,0,10898,22110,44534,89382,179078,358470,717254,1434822,2870272,5741800,11486115,22977258,45964577,91949276,183938806,367958137,736077360],
			marble:[0,1434,4546,10770,23218,48114,97906,197490,396658,794994,1591666,3186691,6380109,12773685,25574331,51202643,102513360,205243096,410919400,822706132],
			glass:[0,0,0,0,21188,42400,84824,169672,339368,678760,1357544,2715136,5430368,10860928,21722240,43445248,86892032,173787137,347580419,695173129],
			sulfur:[0,0,3089,10301,24725,53573,111269,226661,457445,919013,1842149,3692562,7401691,14836588,29739739,59612900,119493244,239522576,480119730,962393438],
			time:{a:11520,b:1,c:1.4,d:0},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		palaceColony: {
			maxLevel:20,
			wood:[712,5824,16048,36496,77392,159184,322768,649936,1304272,2612944,4743518,8611345,15632968,28379968,51520771,93530403,169794358,308243344,559582545,1015861754],
			wine:[0,0,0,10898,22110,44534,89382,179078,358470,717254,1434822,2870272,5741800,11486115,22977258,45964577,91949276,183938806,367958137,736077360],
			marble:[0,1434,4546,10770,23218,48114,97906,197490,396658,794994,1591666,3186691,6380109,12773685,25574331,51202643,102513360,205243096,410919400,822706132],
			glass:[0,0,0,0,21188,42400,84824,169672,339368,678760,1357544,2715136,5430368,10860928,21722240,43445248,86892032,173787137,347580419,695173129],
			sulfur:[0,0,3089,10301,24725,53573,111269,226661,457445,919013,1842149,3692562,7401691,14836588,29739739,59612900,119493244,239522576,480119730,962393438],
			time:{a:11520,b:1,c:1.4,d:0},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		pirateFortress: {
			maxLevel:30,
			wood:[450,906,1389,1935,2593,3427,4516,5950,7834,10284,13430,17415,22394,28534,36015,45029,55779,68482,83366,100671,120648,143562,169686,199309,232729,270255,312210,358926,410748,468032],
			marble:[250,505,783,1112,1534,2103,2883,3949,5388,7296,9782,12964,16970,21938,28019,35370,44162,54573,66793,81020,97463,116341,137883,162325,189915,220912,255580,294197,337048,384429],
			time:[40,414,817,1253,1721,2228,2779,3370,4010,4702,8989,10487,12150,13997,16045,30528,35449,41058,47455,54745,76684,88880,102906,119034,137585,200203,232974,270994,315090,366246],
			dur:[40,414,817,1253,1721,2228,2779,3370,4010,4702,8989,10487,12150,13997,16045,30528,35449,41058,47455,54745,76684,88880,102906,119034,137585,200203,232974,270994,315090,366246]
		},
		port: {
			maxLevel:74,
			wood:[60,150,274,429,637,894,1207,1645,2106,2735,3537,4492,5689,7103,8850,11094,13731,17062,21097,25965,31810,39190,47998,58713,71955,87627,107102,130777,159020,193938,235849,286515,348718,423990,513947,625161,758178,919694,1116013,1353517,1642275,1990224,2411062,2923229,3541580,4291524,5199343,6299199,7631718,9246113,11202015,13571663,16442581,19920807,24134808,29240229,35425639,42919496,51998587,62998247,76324750,92470310,112031264,135730097,164442126,199227831,241372023,292431299,354291535,429237542,520037453,630044966,763323212,924794828],
			marble:[0,0,0,0,0,176,326,540,791,1138,1598,2176,2928,3859,5051,6628,8566,11089,14265,18241,23197,29642,37636,47703,60556,76367,96639,122157,153754,194090,244301,307174,386956,486969,610992,769303,965794,1212791,1523572,1913073,2403314,3015689,3782993,4749576,5959027,7478201,9383420,11774031,14773697,18537587,23260403,29186449,36622272,45952517,57659826,72349802,90782339,113910929,142931982,179346719,225038829,282371903,354311707,444579593,557845001,699967003,878297384,1102060943,1382832675,1735136536,2177196745,2731880500,3427880866,4301201034],
			loadingSpeed:[30,60,93,129,169,213,261,315,373,437,508,586,672,766,869,983,1108,1246,1398,1565,1748,1950,2172,2416,2685,2980,3305,3663,4056,4489,4965,5488,6064,6698,7394,8161,9004,9931,10951,12073,13308,14666,16159,17802,19609,21597,23784,26160,28800,31740,34980,38520,42420,46680,51420,56640,62400,68700,75660,83340,91740,101040,111300,122580,134940,148620,163680,180300,198540,218640,240780,265140,292020,321600],
			time:{a:50400,b:23,c:1.15,d:1512,e:[588]},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		safehouse: {
			maxLevel:60,
			wood:[113,248,402,578,779,1007,1267,1564,1903,2288,2728,3230,3801,4453,5195,6042,7008,8108,9363,10793,12423,14282,16401,18816,21570,24709,28288,32368,37019,42321,48365,55255,63126,72119,82393,94131,107540,122860,140363,160359,183204,209303,239119,273184,312102,356563,407359,465390,531689,607433,693967,792828,905773,1034808,1182226,1350644,1543054,1762875,2014012,2300925],
			marble:[0,0,0,129,197,275,366,471,593,735,900,1090,1312,1569,1866,2212,2613,3078,3617,4243,4968,5810,6787,7919,9233,10758,12526,14577,16956,19716,22917,26631,30946,35962,41790,48563,56433,65579,76207,88557,102909,119587,138967,161489,187660,218073,253415,294484,342209,397669,462117,537009,624038,725172,842695,979265,1137968,1322391,1536701,1785744],
			spytime:{a:900.12,b:-0.0513}, // Seconds to create one spy per level (s): y = Math.round(a*exp(b*x))
			time:[{a:96000,b:7,c:1.05,d:12960},{a:95959,b:13,c:1.06315467,d:0}],
			get dur(){var t=[],f=this.time;for(var i=0;i<this.maxLevel;i++){var h=i<32?0:1,g=(f[h].a/f[h].b*Math.pow(f[h].c,i+1)-f[h].d)-(f[h].e!=undefined&&f[h].e[i+1]!=undefined?f[h].e[i+1]:0);g=Math.round(g);t.push((g>1728e3?1728e3:g));}return t;}
		},
		shipyard: {
			maxLevel:38,
			wood:[105,202,324,477,671,914,1222,1609,2096,2711,3485,4460,5689,7238,9190,11648,14746,18650,23568,29765,37573,47412,59808,75428,95108,119906,151151,190520,240124,302626,381378,480605,605632,763166,961659,1211759,1526886,1923946],
			marble:[0,0,0,0,0,778,1052,1397,1832,2381,3071,3942,5038,6420,8161,10354,13118,16601,20989,26517,33484,42261,53321,67256,84814,106938,134814,169937,214192,269954,340214,428741,540286,680832,857920,1081051,1362196,1716438],
			time:{a:64800,b:7,c:1.05,d:7128},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		shrineOfOlympus:
		{
			buildingId:34,
			maxLevel:41,
			wood:[890,1116,1400,1755,2201,2760,3461,4340,5442,6824,8558,10732,13457,16876,21162,26537,33277,41730,52329,65621,82289,103190,129400,162268,203484,255169,319982,401258,503177,630984,791254,992233,1244260,1560302,1956619,2453600,3076815,3858325,4838340,6067278,7608367],
			wine:[0,0,124,155,194,243,305,381,478,598,749,937,1173,1469,1839,2303,2883,3610,4520,5658,7084,8870,11105,13903,17407,21793,27285,34161,42770,53547,67041,83936,105088,131570,164725,206236,258208,323276,404741,506736,634434],
			marble:[0,0,0,0,231,299,386,499,646,835,1079,1396,1805,2333,3017,3901,5044,6522,8433,10904,14099,18230,23571,30478,39408,50954,65884,85188,110148,142421,184151,238107,307872,398079,514716,665528,860528,1112662,1438672,1860203,2405243],
			glass:[0,0,0,0,0,0,0,0,268,347,448,579,749,969,1252,1619,2094,2707,3500,4526,5852,7567,9784,12651,16357,21150,27347,35360,45720,59116,76437,98833,127791,165233,213647,276245,357185,461841,597160,772128,998361],
			sulfur:[0,0,0,0,0,0,0,0,0,0,133,178,239,320,429,575,770,1032,1383,1853,2483,3327,4458,5973,8004,10726,14372,19259,25807,34581,46339,62094,83206,111497,149406,200203,268273,359485,481710,645492,864959],
			time:{a:48,b:1,c:1.25,d:0},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		stonemason: {
			maxLevel:61,
			wood:[274,467,718,1045,1469,2021,2738,3671,4883,6459,8508,11172,14634,19135,24987,32594,42483,55339,72051,93778,122022,158740,206472,268525,349194,454063,590393,767621,998019,1297536,1686907,2193090,2851161,3706696,4818949,6264951,8144848,10588838,13766186,17896947,23267208,30248900,39325559,51125812,66466917,86411362,112340452,146049973,189874567,246849419,320920474,417217714,542410456,705169252,916766387,1191856573,1549491900,2014441336,2618906170,3404750192,4426399083],
			marble:[0,116,255,436,671,977,1375,1892,2564,3437,4572,6049,7968,10462,13705,17921,23402,30527,39790,51831,67485,87835,114290,148681,193390,251512,327069,425295,552987,718988,934789,1215330,1580064,2054260,2670767,3472295,4514372,5869187,7630598,9920629,12897924,16768741,21801234,28344037,36850411,47909647,62287886,80981202,105284598,136881725,177961516,231369827,300806590,391082130,508450405,661042257,859428691,1117353190,1452683817,1888651047,2455457089],
			time:{a:72000,b:11,c:1.1,d:6120},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		tavern: {
			maxLevel:70,
			wood:[101,222,367,541,750,1001,1302,1663,2097,2617,3241,3990,4888,5967,7261,8814,10678,12914,15598,18818,22683,27320,32885,39562,47576,57192,68731,82578,99194,119134,143061,171774,206230,247577,297193,356732,428179,513916,616800,740261,888414,1066197,1279538,1535546,1842756,2211408,2653790,3184668,3821746,4586269,5503731,6604728,7925973,9511528,11414265,13697636,16437785,19726089,23672202,28407718,34090551,40910209,49094109,58915159,70700866,84844249,101816951,122184964,146627504,175959663],
			marble:[0,0,0,94,122,158,206,267,348,452,587,764,993,1290,1677,2181,2835,3685,4791,6228,8097,10526,13684,17789,23125,30063,39082,50806,66048,85862,111621,145107,188640,245232,318801,414441,538774,700406,910528,1183686,1538792,2000429,2600558,3380726,4394943,5713427,7427454,9655688,12552393,16318109,21213538,27577596,35850869,46606124,60587952,78764326,102393609,133111672,173045148,224958659,292446213,380180021,494233954,642504045,835255135,1085831515,1411580761,1835054717,2385570779,3101241554],
			wineCons:[0,4,8,13,18,24,30,37,44,51,60,68,78,88,99,110,122,136,150,165,180,197,216,235,255,277,300,325,351,378,408,439,472,507,544,584,626,670,717,766,818,874,933,995,1060,1129,1203,1280,1361,1449,1541,1640,1745,1857,1976,2102,2237,2380,2532,2694,2867,3050,3246,3453,3675,3910,4160,4426,4710,5011,5332],
			lvlSat:[0,12,24,36,48,61,73,86,99,112,125,138,152,165,179,193,207,222,236,251,266,282,297,313,329,345,361,378,395,412,430,448,466,484,502,521,540,560,580,600,620,641,662,683,705,727,749,772,795,819,843,867,891,916,942,968,994,1021,1048,1075,1103,1131,1160,1189,1219,1249,1280,1311,1343,1375,1408],
			satCons:[0,60,120,181,242,304,367,430,494,559,624,691,758,826,896,966,1037,1109,1182,1256,1332,1408,1485,1564,1644,1725,1807,1891,1975,2061,2149,2238,2328,2419,2512,2606,2702,2800,2898,2999,3101,3204,3310,3416,3525,3635,3747,3861,3976,4094,4213,4334,4457,4582,4709,4838,4969,5103,5238,5375,5515,5657,5801,5947,6096,6247,6400,6556,6714,6875,7038], // happiness from wine consumption
			time:{a:10800,b:1,c:1.06,d:10440},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		temple: {
			maxLevel:56,
			wood:[216,228,333,465,598,760,958,1197,1432,1773,2112,2512,3082,3655,4458,5126,6232,7167,8688,10247,11784,14229,16753,19266,23186,26664,32027,36831,43257,50782,59591,68529,80385,96068,108393,129447,148864,174363,204229,239212,280187,328180,384394,450238,527359,617691,723496,847424,992579,1162599,1361741,1594995,1868202,2188208,2563028,3002050],
			glass:[173,190,290,423,567,752,989,1290,1610,2080,2586,3210,4109,5084,6471,7765,9851,11821,14952,18402,22082,27824,34184,41020,51514,61817,77477,92972,113941,139577,170911,205093,251034,313054,368577,459304,551164,673645,823344,1006309,1229934,1503253,1837309,2245600,2744623,3354540,4099994,5011105,6124685,7485728,9149224,11182387,13667365,16704560,20416688,24953734],
			priests:[12,23,37,54,73,94,117,142,168,196,225,255,287,320,355,390,427,464,503,543,583,625,668,711,756,801,848,895,943,992,1042,1092,1143,1196,1248,1302,1356,1411,1468,1527,1589,1654,1721,1791,1863,1939,2018,2099,2185,2273,2365,2461,2561,2665,2773,2886],
			time:{a:2160,b:1,c:1.1,d:0,e:{33:1,36:1,38:1,43:-1,44:-2}},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		townHall: {
			maxLevel:66,
			wood:[0,158,335,623,923,1390,2015,2706,3661,4776,6173,8074,10281,13023,16424,20986,25423,32285,40232,49286,61207,74804,93956,113035,141594,170213,210011,258875,314902,387657,471194,572581,695617,854729,1037816,1274043,1529212,1876201,2276286,2761291,3349635,4063337,4929106,5979344,7253354,8798816,10673568,12947770,15706532,19053101,23112718,28037312,34011182,41257896,50048657,60712452,73648368,89340520,108376177,131467734,159479376,193459418,234679540,284682374,345339239,418920177],
			marble:[0,0,0,0,285,551,936,1411,2091,2945,4072,5664,7637,10214,13575,18254,23250,31022,40599,52216,68069,87316,115101,145326,191053,241039,312128,403825,515593,666229,850031,1084293,1382827,1783721,2273687,2930330,3692591,4756439,6058643,7716366,9827663,12516639,15941353,20303113,25858307,32933474,41944498,53421055,68037746,86653753,110363339,140560175,179019255,228001236,290385320,369838495,471031085,599911276,764054752,973110003,1239365472,1578471878,2010362177,2560423242,3260988121,4153236601],
			maxPop:[60,96,142,200,262,332,410,492,580,672,768,870,976,1086,1200,1320,1440,1566,1696,1828,1964,2102,2246,2390,2540,2690,2844,3002,3162,3326,3492,3660,3830,4004,4180,4360,4540,4724,4910,5098,5293,5495,5706,5924,6151,6387,6631,6885,7149,7423,7707,8002,8308,8626,8957,9300,9656,10026,10409,10808,11222,11652,12098,12561,13042,13541],
			actionPointsMax:(function(){var aP=[0];for(var i=1;i<=66;i++){aP.push(Math.floor(i/4+3));}return aP;})(),
			time:{a:1800,b:1,c:1.17,d:-1080,e:[3186]},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		vineyard: {
			maxLevel:50,
			wood:[339,423,520,631,758,905,1074,1269,1492,1749,2045,2384,2775,3225,3741,4336,5019,5805,6709,7749,8944,10319,11900,13718,15809,18214,20979,24159,27816,32021,36858,42419,48819,56184,64661,74417,85645,98567,113438,130553,150251,172920,199010,229036,263592,303362,349132,401808,462431,532201],
			marble:[123,198,285,387,504,640,798,981,1194,1440,1726,2058,2443,2889,3407,4008,4705,5513,6450,7538,8800,10263,11961,13930,16214,18864,21938,25503,29639,34437,40002,46458,53955,62664,72777,84523,98164,114007,132407,153776,178595,207419,240894,279773,324926,377366,438270,509004,591153,686560],
			time:[{a:125660,b:37,c:1.06,d:2232,e:{10:1,11:1}},{a:196327,b:80,c:1.0672282,d:0}],
			get dur(){var t=[],f=this.time;for(var i=0;i<this.maxLevel;i++){var h=i<32?0:1,g=(f[h].a/f[h].b*Math.pow(f[h].c,i+1)-f[h].d)-(f[h].e!=undefined&&f[h].e[i+1]!=undefined?f[h].e[i+1]:0);g=Math.round(g);t.push((g>1728e3?1728e3:g));}return t;}
		},
		wall: {
			maxLevel:48,
			wood:[114,361,657,1012,1439,1951,2565,3302,4186,5247,6521,8049,9882,12083,14724,17892,21695,26258,31733,38304,46189,55650,67004,80629,96979,116599,140143,168395,202298,242982,291802,350387,420688,505050,606284,727765,873542,1048474,1258393,1510295,1812578,2175318,2610605,3132950,3759764,4511941,5414554,6497688],
			marble:[0,203,516,892,1344,1885,2535,3315,4251,5374,6721,8338,10279,12608,15402,18755,22779,27607,33402,40355,48699,58711,70726,85144,102446,123208,148122,178019,213896,256948,308610,370605,444998,534271,641398,769950,924213,1109329,1331467,1598033,1917913,2301768,2762394,3315146,3978448,4774411,5729566,6875751],
			time:{a:57600,b:11,c:1.1,d:3240,e:[2430]},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		warehouse: {
			maxLevel:85,
			wood:[160,288,442,626,847,1113,1431,1813,2272,2822,3483,4275,5226,6368,7737,9380,11353,13719,16559,19967,24056,28963,34852,41918,50398,60574,72784,87437,105021,126121,151441,181825,218286,262039,314543,377548,453153,543880,652752,783398,940192,1128368,1354207,1625247,1950534,2340927,2809455,3371758,4046603,4856517,5828531,6995091,8395134,10075391,12091945,14512105,17416651,20902532,25086100,30106994,36132802,43364655,52043937,62460347,74961564,89964855,107971003,129581016,155516198,186642214,223997992,268830396,322635847,387210269,464709033,557718899,669344361,803311263,964091166,1157050597,1388630175,1666559584,2000115580,2400431627,2880869512],
			marble:[0,0,0,96,211,349,515,714,953,1240,1584,1997,2492,3086,3800,4656,5683,6915,8394,10169,12299,14855,17922,21602,26019,31319,37678,45310,54468,65458,78645,94471,113461,136249,163595,196409,235787,283041,339745,407790,489463,587494,705159,846390,1015907,1219375,1463595,1756728,2108570,2530879,3037771,3646183,4376450,5252977,6305057,7567850,9083558,10902837,13086485,15707480,18853414,22629425,27161704,32601720,39131276,46968588,56375578,67666623,81219068,97485831,117010544,140445715,168574544,202337086,242861676,291502636,349885531,419961503,504072470,605029398,726206237,871652685,1046229521,1255771053,1507280100],
			cp:[8000,16401,25455,35331,46181,58159,71421,86138,102493,120687,140942,163502,188637,216646,247860,282647,321416,364622,412768,466416,526189,592779,666959,749584,841609,944094,1058219,1185297,1326787,1484315,1659690,1854922,2072252,2314171,2583453,2883186,3216807,3588142,4001450,4461476,4973499,5543400,6177729,6883779,7669673,8544460,9518219,10602179,11808851,13152172,14647676,16312668,18166439,20230485,22528769,25088000,27937955,31111829,34646637,38583648,42968887,47853679,53295269,59357506,66111616,73637056,82022473,91366775,101780329,113386298,126322135,140741251,156814887,174734197,194712581,216988297,241827374,269526873,300418536,334872863,373303675,416173213,463997848,517354466,576887609],
			time:{a:2880,b:1,c:1.14,d:2160,e:[1063,1163]},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		winegrower: {
			maxLevel:61,
			wood:[274,467,718,1045,1469,2021,2738,3671,4883,6459,8508,11172,14634,19135,24987,32594,42483,55339,72051,93778,122022,158740,206472,268525,349194,454063,590393,767621,998019,1297536,1686907,2193090,2851161,3706696,4818949,6264951,8144848,10588838,13766186,17896947,23267208,30248900,39325559,51125812,66466917,86411362,112340452,146049973,189874567,246849419,320920474,417217714,542410456,705169252,916766387,1191856573,1549491900,2014441336,2618906170,3404750192,4426399083],
			marble:[0,116,255,436,671,977,1375,1892,2564,3437,4572,6049,7968,10462,13705,17921,23402,30527,39790,51831,67485,87835,114290,148681,193390,251512,327069,425295,552987,718988,934789,1215330,1580064,2054260,2670767,3472295,4514372,5869187,7630598,9920629,12897924,16768741,21801234,28344037,36850411,47909647,62287886,80981202,105284598,136881725,177961516,231369827,300806590,391082130,508450405,661042257,859428691,1117353190,1452683817,1888651047,2455457089],
			time:{a:72000,b:11,c:1.1,d:6120},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
		workshop: {
			maxLevel:32,
			wood:[220,383,569,781,1023,1299,1613,1972,2380,2846,3377,3982,4672,5458,6355,7377,8542,9870,11385,13111,15079,17322,19880,22796,26119,29909,34228,39153,44766,51166,58462,66779],
			marble:[95,167,251,349,461,592,744,920,1125,1362,1637,1956,2326,2755,3253,3831,4501,5278,6180,7226,8439,9847,11479,13373,15570,18118,21074,24503,28481,33095,38447,44656],
			time:{a:96000,b:7,c:1.05,d:11880},
			get dur(){var t=[],c=this.time;for(var i=0;i<this.maxLevel;i++){var d=Math.round(c.a/c.b*Math.pow(c.c,i+1)-c.d)-(c.e!=undefined?(c.e[i]!=undefined?c.e[i]:0):0);t.push((d>1728e3?1728e3:d));}return t;}
		},
	};
	var resources = ['wood','wine','marble','glass','sulfur'];
	var reductblds = ['carpentering','vineyard','architect','optician','fireworker'];
	function optcap(x,am)
	{
		am = am ? true : false;
		var wh = bData.warehouse.cp.map(function(v){return (am?2:1)*v;});
		wh.unshift(0);
		var dp = bData.dump.cp.map(function(v){return (am?2:1)*v;});
		dp.unshift(0);
		var L1 = wh.length-1;
		var L2 = dp.length-1;
		var max = (am?2:1)*(25e2+5*wh[L1]+3*dp[L2]);
		var nwh = wh.filter(function(a){return a<=x;});
		var ndp = dp.filter(function(a){return a<=x;});
		var aL1 = nwh.length;
		var aL2 = ndp.length;
		var a = [[0,0,0,0,0],[0,0,0]];
		var n = 0;
		if(x<=(am?2:1)*(25e2+2*(wh[L1]+dp[L2])))
		{
			fg:
			for(var i2=0;i2<aL2;i2++)
			{
				for(var j2=0;j2<aL1;j2++)
				{
					for(var i1=0;i1<aL2;i1++)
					{
						for(var j1=0;j1<aL1;j1++)
						{
							n=(am?2:1)*25e2+nwh[j1]+nwh[j2]+ndp[i1]+ndp[i2];
							if(n>=x)
							{
								a=[[j1,j2,0,0,0],[i1,i2,0]];
								break fg;
							}
						}
					}
				}
			}
		}
		else
		{
			sg:
			for(var j5=0;j5<aL1;j5++)
			{
				for(var j4=0;j4<aL1;j4++)
				{
					for(var i3=0;i3<aL2;i3++)
					{
						for(var j3=0;j3<aL1;j3++)
						{
							n=(am?2:1)*25e2+wh[L1]+wh[L1]+nwh[j3]+nwh[j4]+nwh[j5]+dp[L2]+dp[L2]+ndp[i3];
							if(n>=x)
							{
								a=[[L1,L1,j3,j4,j5],[L2,L2,i3]];
								break sg;
							}
						}
					}
				}
			}
		}
		a[0][0] = x>(am?2:1)*25e2 && x<(am?2:1)*105e2 ? 1 : a[0][0];
		a = x<=max ? a : [[L1,L1,L1,L1,L1],[L2,L2,L2]];
		return a;
	}
	function BldTm(t,k,p,s) // Seconds, Format, Precision, Space (Delimiter)
	{
		var units = LD.units;
		var colors = {'second':'blue','minute':'blue','hour':'blue','day':'green','month':'orange','year':'red'};
		t = t || 0;
		k = k || 0; // 0: short format, 1: long format
		p = p || 6;
		var pt = p;
		s = s || ' ';
		if(!isFinite(t)){return ' \u221E ';}
		if(t < 0) t *= -1;
		var a = {'second':1,'minute':60,'hour':60,'day':24,'month':30,'year':365};
		var b = {};
		var l = {};
		var c = 1;
		for(var d in Object.keys(a))
		{
			c *= a[Object.keys(a)[d]];
			b[Object.keys(a)[d]] = c/(d==Object.keys(a).length-1?30:1);
			l[Object.keys(a)[d]] = [];
			for(var g=0;g<4;g++) { l[Object.keys(a)[d]][g] = units[Object.keys(a)[d]][g]; }
		}
		var i = Object.keys(a).length;
		var z = {};
		while(i--){z[Object.keys(a)[i]] = b[Object.keys(a)[i]];}
		t = Math.ceil(t);
		var retarr = [];
		for(var f in z)
		{
			var timeInSecs=Math.floor(t/z[f]);
			if(isNaN(timeInSecs)) {return retarr.join(s);}
			if(pt>0 && (timeInSecs>0 || retarr.length>0))
			{
				t = t-timeInSecs*z[f];
				if(timeInSecs>0) { retarr.push('<span style=\'color:'+(p!=6?'grey':colors[f])+'\'>'+NumToStr(timeInSecs)+' '+l[f][k===0?k:(timeInSecs===1?2:1)]+'</span>'); }
				pt = timeInSecs===0 ? pt : (pt-1);
			}
		}
		return retarr.join(s);
	}
	function Img(i,t,a,c,w,h,l) // Image, title, alternative text, class, width, height, link
	{
		var s = ' style="width:'+(w&&w!==''?w+'px':'auto')+';height:'+(h&&h!==''?h+'px':'auto')+'"';
		var p = i&&i!==''?'<img src="https://ikariam.fandom.com/'+(lg=='en'?'':lg+'/')+'wiki/Special:Filepath/'+i+'"'+(t&&t!==''?' data-tooltip="'+t+'"':'')+(' alt="'+(a&&a!==''?a:i.replace('_',' '))+'"')+(c&&c!==''?' class="'+c+' ikar-tooltip"':'')+' data-image-key="'+i+'" data-image-name="'+i.replace('_',' ')+'"'+s+'>':'';
		return (l&&l!==''?'<a href="'+(l!==''?l:'/'+(lg=='en'?'':lg+'/')+'wiki/Special:Filepath/'+i)+'">':'')+p+(l&&l!==''?'</a>':'');
	}
	function Icon(r,w,h) // index of image, width, height
	{
		var res = ['wood_small.gif','wine_small.gif','marble_small.gif','crystal_small.gif','sulphur_small.gif','ambrosia.png','gold_small.gif','icon_citizen.gif'];
		var rel = [LD.wood,LD.wine,LD.marble,LD.glass,LD.sulfur,LD.ambrosia,LD.gold,LD.citizen];
		return Img(res[r][0].toUpperCase()+res[r].slice(1),rel[r][0].toUpperCase()+rel[r].slice(1),rel[r][0].toUpperCase()+rel[r].slice(1),'image image-thumbnail link-internal',w?w:25,h?h:20,'/'+(lg=='en'?'':lg+'/')+'wiki/'+rel[r][0].toUpperCase()+rel[r].slice(1));
	}
	function Tooltip(txt,tip) // Text, Tooltip
	{
		return '<div class="ikar-tooltip" style="display:inline" data-tooltip="'+tip+'">'+txt+'</div>';
	}
	function Tooltips(q,r,s,a) // Tips Generator for resources (Quantity, Research, reSource, Accumulative)
	{
		var rel = LD.resgenit; 
		switch(r)
		{
			case '': // No research
				return Tooltip(NumToStr(q),prntf('<div style="text-align:center">'+LD.restips.nores+'</div>',[NumToStr(q),rel[s]]));
			case LD.resrds[0]: // Pulley
			case LD.resrds[1]: // Geometry
			case LD.resrds[2]: // Spirit Level
				var h = ['<th colspan="'+(r===LD.resrds[1]?2:(r===LD.resrds[2]?3:1))+'">'+LD.restips.table[r!==LD.resrds[0]?1:0]+'</th>',r!==LD.resrds[0]?'<th rowspan="2">'+LD.restips.table[2]+'</th>':'','<th>'+LD.resrds[4]+'</th>'+(r===LD.resrds[1]||r===LD.resrds[2]?'<th>'+LD.resrds[5]+'</th>':'')+(r===LD.resrds[2]?'<th>'+LD.resrds[6]+'</th>':''),'<th colspan="2">'+LD.restips.table[3]+'</th>','<th rowspan="2">'+LD.restips.table[6]+'</th>','<th colspan="3">'+prntf(LD.restips.table[7],[Icon(resources.indexOf(s),12,10)])+'</th>','<th>'+LD.restips.table[4]+'</th><th>'+LD.restips.table[5]+'</th>','<th>'+LD.restips.table[8]+'</th><th>'+LD.restips.table[9]+'</th><th>'+LD.restips.table[10]+'</th>'];
				var t = '<table class="darktable zebra" style="display:inline-block;text-align:center;line-height:1.0;border:none !important;background:transparent;font-size:10px;padding:0px;border-collapse:collapse;margin-left:auto;margin-right:auto"><thead><tr>'+h[0]+h[1]+h[3]+h[4]+h[5]+h[3]+h[4]+h[5]+'</tr><tr>'+h[2]+h[6]+h[7]+h[6]+h[7]+'</tr></thead><tbody>';
				for(var i=0;i<26;i++)
				{
					t += '<tr><td>2 %</td>'+(r===LD.resrds[1]||r===LD.resrds[2]?'<td>4 %</td>':'')+(r===LD.resrds[2]?'<td>8 %</td>':'')+(r===LD.resrds[0]?'':'<td>'+(r===LD.resrds[1]?6:(r===LD.resrds[2]?14:0))+' %</td>')+'<td>'+i+'</td><td>'+i+' %</td><td>'+((r===LD.resrds[0]?2:(r===LD.resrds[1]?6:(r===LD.resrds[2]?14:0)))+i)+' %</td><td style="text-align:right">'+NumToStr(Math.ceil(((r===LD.resrds[0]?2:(r===LD.resrds[1]?6:(r===LD.resrds[2]?14:0)))+i)*q/100))+'</td><td style="text-align:right">'+NumToStr(Math.floor((100-((r===LD.resrds[0]?2:(r===LD.resrds[1]?6:(r===LD.resrds[2]?14:0)))+i))*q/100))+'</td><td style="text-align:right">'+NumToStr(Math.floor((100-((r===LD.resrds[0]?2:(r===LD.resrds[1]?6:(r===LD.resrds[2]?14:0)))+i))*a/100))+'</td><td'+(i==25?' colspan="6"':'')+'>'+(i==25?'':(i+26)+'</td><td>'+(i+26)+' %</td><td>'+((r===LD.resrds[0]?2:(r===LD.resrds[1]?6:(r===LD.resrds[2]?14:0)))+(i+26))+' %</td><td style="text-align:right">'+NumToStr(Math.ceil(((r===LD.resrds[0]?2:(r===LD.resrds[1]?6:(r===LD.resrds[2]?14:0)))+(i+26))*q/100))+'</td><td style="text-align:right">'+NumToStr(Math.floor((100-((r===LD.resrds[0]?2:(r===LD.resrds[1]?6:(r===LD.resrds[2]?14:0)))+(i+26)))*q/100))+'</td><td style="text-align:right">'+NumToStr(Math.floor((100-((r===LD.resrds[0]?2:(r===LD.resrds[1]?6:(r===LD.resrds[2]?14:0)))+(i+26)))*a/100)))+'</td></tr>';
				}
				t += '</tbody><tfoot><tr>'+h[2]+h[1]+h[6]+h[4]+h[7]+h[6]+h[4]+h[7]+'</tr><tr>'+h[0]+h[3]+h[5]+h[3]+h[5]+'</tr></tfoot></table>';
				return t;
			case LD.resrds[3]: // Maximum Reduction
				var p = [2,4,8,50];
				var sm = p.reduce(function(a,b){return a+b;},0);
				return prntf(LD.restips.mr,p.concat([sm,NumToStr(q),100-sm,NumToStr(q*(100-sm)/100,false,2),NumToStr(Math.floor(q*(100-sm)/100),false,0),NumToStr(a),NumToStr(a*(100-sm)/100,false,2),NumToStr(Math.floor(a*(100-sm)/100),false,0),Icon(resources.indexOf(s),12,10)]));
		}
	}
	function NumToStr(inputNum,outputSign,precision)
	{
		precision = precision ? "10e" + (precision - 1) : 1;
		var ret, val, sign, i, j;
		var tho = LD.tho;
		var dec = LD.dec;
		if(!isFinite(inputNum)) { return '\u221E'; }
		sign = inputNum > 0 ? 1 : inputNum == 0 ? 0 : -1;
		if(sign)
		{
			val = (( Math.floor(Math.abs(inputNum * precision)) / precision ) + '').split('.');
			ret = val[1] !== undefined ? [dec, val[1]] : [];
			val = val[0].split('');
			i = val.length;
			j = 1;
			while(i--)
			{
				ret.unshift(val.pop());
				if(i && j % 3 === 0)
				{
					ret.unshift(tho);
				}
				j++;
			}
			if(outputSign)
			{
				ret.unshift(sign == 1 ? '+' : '-');
			}
			return ret.join('');
		}
		else return inputNum;
	}
	// Storage capacity calculator for Warehouses and Dumps
	function CapCalcTable()
	{
		var cp ={w:[8000,16401,25455,35331,46181,58159,71421,86138,102493,120687,140942,163502,188637,216646,247860,282647,321416,364622,412768,466416,526189,592779,666959,749584,841609,944094,1058219,1185297,1326787,1484315,1659690,1854922,2072252,2314171,2583453,2883186,3216807,3588142,4001450,4461476,4973499,5543400,6177729,6883779,7669673,8544460,9518219,10602179,11808851,13152172,14647676,16312668,18166439,20230485,22528769,25088000,27937955,31111829,34646637,38583648,42968887,47853679,53295269,59357506,66111616,73637056,82022473,91366775,101780329,113386298,126322135,140741251,156814887,174734197,194712581,216988297,241827374,269526873,300418536,334872863,373303675,416173213,463997848,517354466,576887609],d:[32000,65401,101073,139585,181437,227119,277128,331991,392268,458564,531535,611896,700427,797983,905498,1024000,1154614,1298578,1457248,1632119,1824830,2037185,2271165,2528951,2812939,3125764,3470326,3849813,4267731,4727939,5234678,5792619,6406896,7083160,7827629,8647143,9549229,10542172,11635086,12838003,14161964,15619122,17222851,18987875,20930401,23068269,25421121,28010583,30860463,33996977,37448993,41248299,45429902,50032358,55098129,60673986,66811447,73567262,81003948,89190382,98202448,108123754,119046431,131072000,144312338,158890744,174943109,192619216,212084166,233519956,257127222,283127160,311763649,343305589,378049493,416322336,458484710,504934306,556109751,612494861]};
		$('table#capacity_calc tr:eq(0) td').prepend($('input#cap_calc_ambro').length==0?'<input id="cap_calc_ambro" type="checkbox" /> ':'');
		$('[id^="cap_calc_w"],[id^="cap_calc_d"]').each(function(k,v)
		{
			$(v).html('<input type="number" min="0" max="'+(80+(k<5?5:0))+'" value="0" step="1" style="width:40px" pattern="[0-9]*" required>');
		});
		$('td[id^="cap_calc_w"] input[type="number"],td[id^="cap_calc_d"] input[type="number"]').each(function(k,v)
		{
			$(this).on('change input',function(a)
			{
				if(isNaN(parseInt(a.target.value)))
				{
					a.target.value = 0;
				}
				else if(parseInt(a.target.value)>80+(k<5?5:0))
				{
					a.target.value = 80+(k<5?5:0);
				}
				var t = parseInt(isNaN(parseInt(a.target.value)) ? 0 : a.target.value);
				var c = t==0 ? 0 : cp[k<5?'w':'d'][parseInt(a.target.value)-1];
				console.log('#cap_calc_c'+(a.target.parentNode.id.split('_')[2]));
				$('#cap_calc_c'+(a.target.parentNode.id.split('_')[2])).text(NumToStr(c*($('#cap_calc_ambro').prop('checked')+1)));
			});
		});
		$('#cap_calc_ambro').on('change',function()
		{
			var v = $(this).prop('checked');
			$('#cap_calc_cth').text(NumToStr(25e2*(v+1)));
			$('td[id^="cap_calc_w"] input[type="number"],td[id^="cap_calc_d"] input[type="number"]').each(function(a,b)
			{
				var c = parseInt($(b).val())==0 ? 0 : cp[a<5?'w':'d'][parseInt($(b).val())-1];
				$('#cap_calc_c'+$(b).parent().prop('id').split('_')[2]).text(NumToStr(c*(v+1)));
			});
		});
		$('#cap_calc_ambro,td[id^="cap_calc_w"] input[type="number"],td[id^="cap_calc_d"] input[type="number"]').on('change input',function()
		{
			var sum = 0;
			$('table tr td[id^="cap_calc_c"]').each(function()
			{
				sum += parseInt($(this).text().replace(/\D+/g,''));
			});
			$('#cap_calc_sum').text(NumToStr(sum));
			sum = 0;
		});
	}
	var bid = Object.keys(bData).filter(function(v,k){return $('table[id^="'+v+'-"]').length>0;}).join('');
	if(bid!='')
	{
		bid = bid.split('-')[0];
		if(['dump','warehouse'].indexOf(bid)!==-1)
		{
			CapCalcTable();
		}
		var tids = $.map($('table[id^="'+bid+'-"]'),function(n){return n.id;});
		$.each(tids,function(x,tid)
		{
			for(var i=0;i<4;i++)
			{
				$('table#'+tid+' tr:eq(1) th:eq('+(i+1)+') '+([0,3].indexOf(i)!=-1?'a':'*')).addClass('ikar-tooltip').attr('data-tooltip',LD.headertips[i]);
			}
			var res = resources.filter(function(o){return Object.keys(bData[bid]).indexOf(o)!==-1;});
			$.each(res,function(k,v)
			{
				$('table#'+tid+' tr:eq(2) th:eq('+k+') *').addClass('ikar-tooltip').attr('data-tooltip',prntf(LD.headertips[4],[Icon(resources.indexOf(v))+'<br />'+LD[v],Img(LD[reductblds[resources.indexOf(v)]].name+'_l.png',LD[reductblds[resources.indexOf(v)]].name,LD[reductblds[resources.indexOf(v)]].name,'',40,40)+'<br />'+LD[reductblds[resources.indexOf(v)]].name]));
			});
			var extracols = $('table#'+tid+' tr:eq(1) th').length-5;
			for(i=0;i<extracols;i++)
			{
				switch(bid)
				{
					case 'academy':
						$('table#'+tid+' tr:eq(1) th:eq('+(i+5)+') *').addClass('ikar-tooltip').attr('data-tooltip',LD[bid].headertips[i]);
						break;
				}
			}
			var costs = {};
			var accumulative = {};
			var accdurs = bData[bid].dur.reduce(function(a,b,i){return i===0?[b]:a.concat(a[i-1]+b);},0);
			var allcosts = {};
			var maxres = [];
			$.each(res,function(i,r)
			{
				costs[r] = costs[r]==undefined ? bData[bid][r] : costs[r];
				accumulative[r] = accumulative[r]==undefined ? [] : accumulative[r];
				allcosts[r] = allcosts[r]==undefined ? [] : allcosts[r];
				costs[r].reduce(function(a,b,i) { return (accumulative[r][i] = a+b); },0);
			});
			$('tr[id^="'+tid+'_"]').each(function(a,tr)
			{
				var lvl = parseInt($(tr).attr('id').split('_')[1]);
				$(tr).find('th:first').text($(tr).find('th:first').text().trim());
				// Resources columns
				$.each(res,function(k,v)
				{
					allcosts[v][lvl-1] = [bData[bid][v][lvl-1],accumulative[v][lvl-1]];
					maxres[lvl-1] = bData[bid][v][lvl-1]>maxres[lvl-1] ? bData[bid][v][lvl-1] : (maxres[lvl-1]||0);
					var contents = $(tr).find('> td:eq('+k+')').contents();
					if(contents.length==1)
					{
						$(tr).find('> td:eq('+k+')').addClass('ikar-tooltip').attr('data-tooltip',prntf(LD.restips.none[0],[Icon(resources.indexOf(v)),lvl]));
					}
					else
					{
						$(tr).find('> td:eq('+k+') > div:lt(2)').each(function(b,c)
						{
							$(c).addClass('ikar-tooltip').attr('data-tooltip',prntf(LD.restips.none[1],[NumToStr(allcosts[v][lvl-1][b]),Icon(resources.indexOf(v)),b==0?'':LD.and,lvl]));
						});
						$(tr).find('> td:eq('+k+') > table tr').each(function(d,e)
						{
							$(e).find('td:last a').addClass('ikar-tooltip').attr('data-tooltip',LD.restips.rdres[d]);
						});
					}
				});
				// Building duration column
				var ambrosia = bData[bid].dur[lvl-1]<=300?0:(Math.floor(bData[bid].dur[lvl-1]/1800)*4+4);
				ambrosia = ambrosia>148?148:ambrosia;
				var dr = $(tr).find('> td:eq('+(res.length)+') > div');
				$(dr).eq(0).addClass('ikar-tooltip').attr('data-tooltip',LD.durtips.displayed);
				$(dr).eq(1).addClass('ikar-tooltip').attr('data-tooltip',LD.durtips.displayed+'<br /><b>'+BldTm(bData[bid].dur[lvl-1],1,2)+'</b>');
				$(dr).eq(2).addClass('ikar-tooltip').attr('data-tooltip',LD.durtips.actual+'<br /><b>'+BldTm(bData[bid].dur[lvl-1],1)+'</b>');
				$(dr).eq(3).addClass('ikar-tooltip').attr('data-tooltip',LD.durtips.accum+'<br /><b>'+BldTm(accdurs[lvl-1],1)+'</b>');
				$(dr).eq(4).find('> a').eq(0).addClass('ikar-tooltip').attr('data-tooltip',prntf(LD.durtips.SBT,[BldTm(bData[bid].dur[lvl-1]/2,1)]));
				$(dr).eq(4).find('> a').eq(1).addClass('ikar-tooltip').attr('data-tooltip',LD.durtips.CI);
				$(dr).eq(4).find('> span,> span > a').addClass('ikar-tooltip').attr('data-tooltip',prntf(LD.durtips.ambro,[ambrosia]));
				$(dr).eq(4).find('> a').last().addClass('ikar-tooltip').attr('data-tooltip',prntf(LD.durtips.SBTCI,[BldTm(bData[bid].dur[lvl-1]/2,1)]));
				$(dr).eq(5).find('> a').eq(0).addClass('ikar-tooltip').attr('data-tooltip',LD.aristocracy);
				$(dr).eq(5).find('> a').eq(1).addClass('ikar-tooltip').attr('data-tooltip',prntf(LD.durtips.aristocracy,[BldTm(bData[bid].dur[lvl-1]*0.8,1)]));
				$(dr).eq(6).find('> a').eq(0).addClass('ikar-tooltip').attr('data-tooltip',LD.oligarchy);
				$(dr).eq(6).find('> a').eq(1).addClass('ikar-tooltip').attr('data-tooltip',prntf(LD.durtips.oligarchy,[BldTm(bData[bid].dur[lvl-1]*1.2,1)]));
				// Storage column
				var st = $(tr).find('> td:eq('+(res.length+1)+') > table > tbody > tr');
				$(st).eq(0).find('th').eq(1).find('a').addClass('ikar-tooltip').attr('data-tooltip',LD.storagetips[0]);
				$(st).eq(0).find('th').eq(2).find('a').addClass('ikar-tooltip').attr('data-tooltip',LD.storagetips[1]);
				$(st).eq(1).find('th').eq(1).find('a').addClass('ikar-tooltip').attr('data-tooltip',LD.storagetips[2]);
				$.each($(st).eq(1).find('th').slice(2),function(a,b)
				{
					$(b).addClass('ikar-tooltip').attr('data-tooltip',prntf(LD.storagetips[3],[a+(a<5?1:-4),LD[(a<5?'warehouse':'dump')].name]));
				});
				$.each($(st).slice(2),function(c,d)
				{
					if(c>1 && c%2==0)
					{
						$(d).find('th').first().addClass('ikar-tooltip').attr('data-tooltip',LD.storagetips[(c/2)+5]);
					}
					$(d).find('th').last().addClass('ikar-tooltip').attr('data-tooltip',LD.storagetips[4+(c%2)]);
					$(d).find('td').each(function(e,f)
					{
						var lv = optcap(maxres[lvl-1],c%2)[e<5?0:1][e+(e<5?0:-5)];
						$(f).addClass('ikar-tooltip').attr('data-tooltip',lv==0?prntf(LD.storagetips[20],[prntf(LD.storagetips[18+(e<5?0:1)],[e+(e<5?1:-4)])]):prntf(LD.storagetips[10],[LD.storagetips[Math.floor(c/2)+11],LD.storagetips[16+(c%2)],prntf(LD.storagetips[18+(e<5?0:1)],[e+(e<5?1:-4)])])).text(lv);
					});
				});
				// Score column
				var sm = [0,0,0,0];
				var t = ['',''];
				$.each(res,function(k,v)
				{
					sm[0] += allcosts[v][lvl-1][0];
					sm[1] += allcosts[v][lvl-1][0]/100;
					sm[2] += allcosts[v][lvl-1][1];
					sm[3] += allcosts[v][lvl-1][1]/100;
					t[0] += '<tr><td>'+Icon(resources.indexOf(v),12,10)+'</td><td>'+NumToStr(allcosts[v][lvl-1][0])+'</td><td>'+NumToStr(allcosts[v][lvl-1][0]/100,false,2)+'</td></tr>';
					t[1] += '<tr><td>'+Icon(resources.indexOf(v),12,10)+'</td><td>'+NumToStr(allcosts[v][lvl-1][1])+'</td><td>'+NumToStr(allcosts[v][lvl-1][1]/100,false,2)+'</td></tr>';
				});
				var tbl = '<table class="darktable zebra" style="text-align:center;line-height:1.0;border:none !important;background:transparent;font-size:10px;padding:0px;border-collapse:collapse;margin-left:auto;margin-right:auto"><thead><tr><th colspan="2">'+LD.scoretips[0]+'</th><th rowspan="2">'+LD.scoretips[1]+'</th></tr><tr><th>'+LD.scoretips[2]+'</th><th>'+LD.scoretips[3]+'</th></tr></thead><tbody>{0}</tbody><tfoot><tr><th>&Sigma;</th><th>{1}</th><th>{2}</th></tr></tfoot></table>';
				$(tr).find('> td:eq('+(res.length+2)+') > div').each(function(k,v)
				{
					$(v).addClass('ikar-tooltip').attr('data-tooltip',prntf(tbl,[t[k],NumToStr(sm[2*k]),NumToStr(Math.floor(sm[2*k+1]))])).find('a').removeAttr('title');
				});
				// Extra columns
				for(var i=0;i<extracols;i++)
				{
					switch(bid)
					{
						case 'dump':
							$(tr).find('> td:eq('+(res.length+3+i)+') > table tr').each(function(g,h)
							{
								if(g!=4)
								{
									var txt = LD[bid].extracoltips[g+(g<4?0:-(g<6?1:5))];
									$(h).addClass('ikar-tooltip').attr('data-tooltip',[2,7].indexOf(g)!=-1?prntf(txt,[lvl]):txt).find('a').removeAttr('title');
								}
							});
							$(tr).find('> td:eq('+(res.length+3+i)+') > div').addClass('ikar-tooltip').attr('data-tooltip',LD[bid].extracoltips[6]);
							break;
						case 'warehouse':
							var rw = $(tr).find('> td:eq('+(res.length+3+i)+') > table tr');
							var arr = LD[bid].extracoltips;
							$(rw).slice(0,2).find('th').each(function(a,b)
							{
								$(b).addClass('ikar-tooltip').attr('data-tooltip',a<1?'':arr[a-1]);
							});
							$(rw).slice(2).find('th').each(function(a,b)
							{
								$(b).addClass('ikar-tooltip').attr('data-tooltip',a%3==0?a!=3?arr[a/3+5]:prntf(arr[a/3+5],[lvl]):arr[8+([1,4,7].indexOf(a)==-1)]);
							});
							$(rw).slice(2).find('td').each(function(a,b)
							{
								$(b).addClass('ikar-tooltip').attr('data-tooltip',prntf(arr[10],[arr[13-(a<12)*2+(a%3!=0)],a<6?arr[15]:a<12?prntf(arr[16],[lvl]):'',arr[17+Math.floor(a/3)%2],a%3==0?'':arr[18+a%3]]));
							});
							$(tr).find('> td:eq('+(res.length+3+i)+') > div').addClass('ikar-tooltip').attr('data-tooltip',arr[21]);
							break;
					}
				}
			});
		});
	}
	else
	{
		console.log(LD.notbl);
		return;
	}
	$(document).ready(function()
	{
		mw.hook('wikipage.content').add(function($content)
		{
			try
			{
				$('.ikar-tooltip').hover(function(e)
				{
					$('#ikar-tooltip-content').remove();
					var txt = '';
					var attrs = $(this).attr('data-tooltip').split('|');
					if(attrs.length==1)
					{
						txt = attrs[0];
					}
					else
					{
						switch(attrs[1])
						{
							case LD.resrds[0]:
							case LD.resrds[1]:
							case LD.resrds[2]:
							case LD.resrds[3]:
							case 'ΟΜ':
								txt = Tooltips(attrs[0],attrs[1],attrs[2],attrs[3]);
								break;
						}
					}
					$(this).removeAttr('title');
					$('<div id="ikar-tooltip-content" class="WikiaArticle" style="line-height:1.15;border:1px solid #F1D031;color:#444;background:#fbeecb;box-shadow:0 2px 2px #999;position:absolute;padding:2px;text-align:center;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;z-index:6000000;margin:0px;min-height:0px;overflow:hidden;font-size:14px;display:none"></div>').html(txt).appendTo('body');
					$('#ikar-tooltip-content').css('display','inline-block').fadeIn('fast').find('sup').css('vertical-align','super');
				},function()
				{
					$('#ikar-tooltip-content').remove();
				}).on('mousemove mousewheel',function(e)
				{
					var dX = e.type=='mousewheel' ? e.originalEvent.deltaX : 0;
					var dY = e.type=='mousewheel' ? e.originalEvent.deltaY : 0;
					var bH = $('div.fandom-sticky-header').prop('outerHeight') || 0;
					var top, left;
					var target = e.target;
					var tooltip = document.getElementById('ikar-tooltip-content');
					var vp = {'H':$('body').prop('clientHeight'),'W':$('body').prop('clientWidth'),'T':$('body').scrollTop(),'L':$('body').scrollLeft()};
					if(tooltip)
					{
						var tg = target.getBoundingClientRect();
						var tt = tooltip.getBoundingClientRect();
						if(tt.height>vp.H || tt.width>vp.W)
						{
							$('#ikar-tooltip-content').html('<div style="color:red;font-weight:bold;white-space:nowrap">'+LD.bigtooltip+'</div>');
						}
						else
						{
							if((tg.top<=vp.H && tg.bottom>=0) || (tg.left<=vp.W && tg.right>=0))
							{
								top = (e.pageY+10+tt.height<=vp.T+vp.H ? e.pageY+10 : (e.pageY-tooltip.clientHeight<=vp.T ? vp.T : e.pageY-tooltip.clientHeight))+(vp.T==0?0:dY)+bH;
								left = (e.pageX+15+tt.width<=vp.L+vp.W ? e.pageX+15 : (e.pageX-5-tooltip.clientWidth<=vp.L ? vp.L : e.pageX-5-tooltip.clientWidth))+(vp.L==0?0:dX);
							}
						}
						$('#ikar-tooltip-content').css({'top':top+'px','left':left+'px'});
					}
				});
			}
			catch(e)
			{
				console.log(e);
			}
		});
	});
}
var pN = {"Academy":"academy","Alchemist Tower":"alchemist","Architect&apos;s Office":"architect","Barracks":"barracks","Black Market":"blackMarket","Carpenter":"carpentering","Dockyard":"dockyard","Dump":"dump","Embassy":"embassy","Firework Test Area":"fireworker","Forester&apos;s House":"forester","Glassblower":"glassblowing","Gods'_Shrine":"shrineofolympus","Governor&apos;s Residence":"palaceColony","Hideout":"safehouse","Museum":"museum","Optician":"optician","Palace":"palace","PirateFortress":"pirateFortress","Sea Chart Archive":"marineChartArchive","Shipyard":"shipyard","Stonemason":"stonemason","Tavern":"tavern","Temple":"temple","Town Hall":"townHall","Town Wall":"wall","Trading Port":"port","Trading Post":"branchOffice","Warehouse":"warehouse","Wine Press":"vineyard","Winegrower":"winegrower","Workshop":"workshop"};
var pName = mw.config.get('wgPageName').replace('Building:','');
console.log(pName,Object.keys(pN).indexOf(pName)!=-1);
if(Object.keys(pN).indexOf(pName)!=-1)
{
	if($('div#'+pN[pName]+'_tabber').length==1)
	{
		mw.loader.using(['mediawiki.api'], function()
		{
			var api = new mw.Api();
			var container = $('div#'+pN[pName]+'_tabber');
			var tabs = $(container).find('ul li');
			$.each(tabs,function(k,v)
			{
				var sPage = $(v).attr('data-hash').replace(/_/g,'');
				api.get({
					action: 'parse',
					page: 'Building:'+pName+'/'+sPage,
					prop: 'text',
					format: 'json'
				}).done(function(data)
				{
					$(container).find('div.wds-tab__content').eq(k).find('p').replaceWith(data.parse.text['*']);
					if(k==tabs.length-1)
					{
						expLoader();
					}
				});
			});
		});
	}
	else
	{
		expLoader();
	}
}