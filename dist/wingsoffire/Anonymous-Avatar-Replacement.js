(function () {
    const IMAGE_SOURCE = "URL";

    const replaceAvatars = function replaceAvatars(ui) {
        const oldAvatars = document.querySelectorAll("#MessageWall svg.wds-avatar__image:not(.replacement-avatar)");

        oldAvatars.forEach(function (oldAvatar) {
            const newAvatar = ui.svg({
                xmlns: "http://www.w3.org/2000/svg",
                viewBox: "0 0 186.67 187.08",
                classes: ["wds-avatar__image", "replacement-avatar"],
                children: [
                    ui.path({
                        d: "M93.333 0C41.925 0 .25 41.675.25 93.083c0 51.409 41.675 93.083 93.083 93.083s93.083-41.674 93.083-93.083C186.417 41.675 144.742 0 93.333 0zm0 180.167c-48.095 0-87.083-38.987-87.083-87.083S45.238 6 93.333 6s87.083 38.988 87.083 87.083c.001 48.096-38.987 87.084-87.083 87.084z",
                    }),
                    ui.path({
                        d: "M164.406 145.107c-1.62-.175-3.771.632-3.969.661-10.637 1.609 7.771.051 3.969-.661zm7.936-40.344c-.893-3.296-1.321-7.057-1.322-11.244 2.42-.886 4.09-2.524 6.613-3.307-.212-4.197.56-9.378-.66-12.566.813-1.91 2.521-2.925 4.057-4.113a96.647 96.647 0 0 0-.325-1.415 39.5 39.5 0 0 1-4.394 3.543c-1.458-6.7-4.729-11.585-7.937-16.535 1.697-2.435 3.448-4.815 4.432-7.963a87.447 87.447 0 0 0-1.369-2.5c-2.491 7.97-6.266 14.656-12.321 19.062-.639-3.468-4.305-5.44-.662-7.937-1.784-1.302-5.78-.394-8.598-.662 2.658-3.956 4.407-8.82 5.291-14.55 6.201.111 10.337 2.286 15.76 3.174a90.49 90.49 0 0 0-1.355-2.238c-2.952-.374-6.009-1.17-9.114-2.258 1.655-1.071 3.48-2.209 5.395-3.23a77.935 77.935 0 0 0-.762-1.027c-3.067 1.669-6.259 3.084-8.601 3.596.812-1.964 3.211-4.73 6.44-6.346a94.32 94.32 0 0 0-.76-.914c-3.583 2.935-7.867 5.168-14.279 5.275 1.285-2.959 7.551-5.713 10.504-9.503a92.371 92.371 0 0 0-1.81-1.84c-7.566 7.129-16.836 12.917-25.229 18.617-.884-3.523-2.415-6.403-5.291-7.936 9.198-4.413 17.946-9.275 25.762-15.069a86.69 86.69 0 0 0-1.832-1.529 23.16 23.16 0 0 1-1.444.725c.228-.434.477-.865.738-1.294a91.413 91.413 0 0 0-1.968-1.527 16.509 16.509 0 0 1-2.077 1.499c-.435-.887-1.413-1.232-2.646-1.323.529-.82 1.098-1.6 1.689-2.357-.315-.217-.629-.435-.947-.648-1.261 1.193-2.589 2.056-4.048 2.344-9.13 1.806-9.12-8.659-16.534-9.919-6.474-1.101-19.774 8.319-25.132 12.565-7.654 6.068-12.311 13.938-19.181 18.519-4.128 2.754-12.159 2.813-15.211 5.291-5.574 4.528-4.65 17.602-11.905 20.503-1.65 8.727-8.491 19.108-17.195 11.244-4.921 11.15-7.954 42.217 7.936 45.635 5.865-9.308 19.562-8.846 27.117-15.874 4.215-3.92 4.255-10.944 11.243-11.243-1.625 2.344.526 8.462-4.629 7.276-.53 2.293.985 2.542.662 4.629-1.236-.527-2.422-1.105-3.969-1.323-.362.961.773 3.417-.662 3.308-18.001.107-31.959 37.334-48.28 16.533-.065 2.713-.13 5.422.662 7.276-2.12-.329-4.686-6.446-5.292-3.97.279 16.29 24.245 12.816 32.407 5.953 1.378 5.016 4.279 8.51 8.598 10.582 6.529-4.161 13.501-6.865 18.519-13.889 3.198-4.475 5.631-15.008 11.905-15.874 5.533-.762 13.208 5.089 22.487 5.953 8.56.798 16.542-1.924 21.826 0 3.026 3.367 7.021 5.765 11.905 7.274 3.596 5.894 6.22 9.883 6.614 17.196.218 4.062-.032 8.121-.583 12.18a96.36 96.36 0 0 0 1.308-1.167c.511-6.105 3.298-13.987-.724-16.965 3.136-3.037 6.982-5.361 9.92-8.598-2.732-.513-5.01 5.119-9.259 5.291-1.884-3.848-3.869-7.594-7.274-9.922 1.667-2.96 2.82-6.438 3.969-9.919-2.198 2.652-4.481 5.22-5.953 8.597-3.076-.449-4.48-2.575-7.275-3.306 1.788-4.165 3.277-8.626 4.629-13.227-2.312 3.199-3.382 7.64-5.951 10.582-3.244-.842.906-4.49 0-7.275-2.153 1.155-2.336 4.279-2.647 7.275-7.665-1.694-13.713.679-21.825-.662-7.912-1.308-15.628-6.051-19.841-5.952-13.642.316-10.767 19.015-23.149 24.471-2.321-.985-4.821-1.792-5.953-3.968-.407-3.053 1.486-3.806 1.324-6.615-2.959 3.395-2.755 10.961 3.307 10.583-.914 3.496-5.432 3.386-7.276 5.952-2.869-3.083-6.226-5.677-7.274-10.581 14.9-7.367 25.56-18.973 29.763-37.038 4.087-4.069 12.995-3.319 14.55-9.921-4.185 6.046-15.638 4.665-21.826 9.259-6.565 4.875-9.346 14.796-18.518 15.212-2.47-4.365-8.89-4.781-15.212-5.291-2.954-5.417 4.938-9.112.661-13.889-.853 6.863-5.685 9.746-6.613 16.535 1.843 1.15 1.829-5.204 4.63-5.291-.356 2.339 1.07 2.899 1.983 3.967 6.074-.341 11.676-.21 12.567 4.63-4.739 2.759-9.866 5.125-13.228 9.26-10.227-3.222-8.577-18.318-9.259-31.085 4.241-1.134 8.375-2.635 9.92-7.936 6.793.11 6.585-10.079 11.245-9.921-.555-1.939-.166-6.12 2.645-6.613-.119 3.205.872 5.3 1.322 7.937-6.841 7.707-15.792 13.307-23.809 19.841 9.412-5.138 17.363-11.737 25.133-18.519-.514 1.471-1.389 2.579-1.324 4.63 3.806-4.844 2.474-9.068 4.631-12.567 6.602-10.71 20.905-5.054 35.053-7.274 6.896-1.083 11.072-6.346 15.873-8.598-5.766 1.657-10.429 7.631-19.841 7.937-7.775.252-16.425-1.696-23.81 1.323 5.013-3.876 6.689-7.002 6.614-15.874 8.49-2.975 12.257-10.672 18.52-15.874 1.908 4.128-.218 9.914 0 14.55 3.423-4.9-.075-10.091 1.322-14.55 1.95-6.223 10.013-8.24 15.874-11.244.048 10.41-3.019 17.705-6.614 24.472 5.301-5.723 7.575-14.473 7.276-25.794 3.816-1.253 6.08-4.061 10.582-4.63.162 11.211-6.72 21.038-10.582 30.424-5.082 2.113-8.144 2.441-13.89 3.307 9.135 3.466 24.647-10.99 28.782-2.26.106.069.212.155.318.275-.057.021-.101.047-.152.07.413 1.008.693 2.287.814 3.899-1.095-1.167-2.617-3.092-.814-3.899-.051-.124-.111-.229-.166-.345-.955-.625-1.897.563-2.988-1.046-2.579.598 2.192 2.435 0 2.646-3.742 1.549-7.616 2.967-10.583 5.29 2.691-.186 7.768-3.687 11.905-4.629.361.96-.772 3.417.662 3.307-1.215 3.193-5.374 3.444-5.952 7.275 5.144 7.643 23.147 2.425 34.391 3.968-4.019 5.371-14.239 9.653-23.148 5.952 4.226-3.271 12.163-2.829 17.858-4.63-7.314-3.005-14.262 2.409-20.503 1.984-3.979-.271-5.663-3.344-9.921-3.307-1.294.091-3.138 2.951-1.322 3.968-3.408 1.442-5.625 4.076-5.953 8.598-11.367-.124-15.949 6.539-21.165 12.567-5.78.047-6.997-4.467-13.227-3.968 5.277 2.481 7.278 7.075 13.227 5.951 4.904-.926 6.145-8.03 11.244-8.598-.102 1.646 1.039 2.047 1.323 3.307-4.768 4.726 3.098 10.535 1.322 18.519-6.226 5.239-16.144 6.783-19.179 15.212 6.105-8.005 21.614-6.604 22.486-19.842 15.427 3.232 29.393 8.285 47.62 7.275 7.961 8.409 12.109 20.631 16.997 32.113.305-.556.603-1.116.896-1.679-.06-.617-.085-1.27-.036-1.996.33.041.656.083.983.126.271-.552.537-1.108.797-1.666-1.258-.145-2.519-.285-3.764-.443-.75-2.999-1.718-5.778-2.646-8.598 4.072.115 8.346.435 10.494-1.372a89.42 89.42 0 0 0 1.411-4.842v-9.66a15.32 15.32 0 0 0 1.977-.219c.09-.631.175-1.264.252-1.899-2.919.743-6.153 1.164-10.172.798zM53.295 131.217h2.645c.772 2.296-3.695 3.076-2.645 0zm3.967-.66c-1.239-1.26-.072-1.661 0-3.307.769.555 1.774.872 3.308.661-.851 1.134-1.368 2.6-3.308 2.646zm6.614-8.598c-1.778 3.513-9.011 1.572-8.598 7.274-1.483-.279-2.109-1.419-3.307-1.983-2.471.442-2.263 3.958-.662 5.29-4.394 7.57-22.15 12.369-29.101 3.969 1.748.254 5.81 3.881 11.244 2.646-1.948-3.344-8.663-1.918-8.598-7.275 15.762 17.553 28.688-15.541 42.991-16.534.021 2.006-2.322 1.648-3.969 1.983-.907 2.092-.144 2.211 0 4.63zm2.645 0c-1.547-.17-.38-2.906 0-3.307.532.351 1.074.689 1.984.662-.194 1.348-1.789 1.296-1.984 2.645zm3.969-4.63c.547-1.869-.931-1.712-.661-3.306 2.021-.479 2.41.676 3.969.661-.852 1.133-1.368 2.6-3.308 2.645zm4.63-3.968c-.982-.561-.958-2.13-1.322-3.307 1.185-.084 1.394.809 2.646.661-.346.979-.98 1.667-1.324 2.646zM34.776 90.213c-2.394-1.404-1.088-6.152 0-7.936 2.365.28 3.529 1.762 6.614 1.322-1.635 2.776-3.592 5.227-6.614 6.614zM65.2 64.419c-1.518-1.348-.24-5.493-.662-7.937-.18 8.408-3.303 11.15-5.952 17.857-6.332-9.472 4.037-16.213 5.952-25.132 2.342-.304 3.82-1.471 6.614-1.323-.444 7.053-1.188 13.804-5.952 16.535zm6.612-5.952c-.181-1.964-1.492-10.74 1.985-11.244 2.137 1.448-.34 9.217-1.985 11.244zm68.122-35.054c2.94-.294 3.501 1.793 5.291 2.647-2.511 2.559-5.746 4.394-9.258 5.952 1.521-2.667 3.51-4.868 3.967-8.599zm-25.131 18.519c3.061-9.063 8.497-15.752 9.259-27.117 2.146 2.484 4.573 4.687 6.613 7.276-4.064 7.841-7.865 15.944-15.872 19.841zm6.613-2.646c3.453-5.806 8.59-9.928 10.583-17.195 1.609 1.257 5.533.199 7.274 1.322-2.377 8.867-9.585 12.902-17.857 15.873zm27.116 19.841c-8.686-.572-19.848 1.33-26.455-1.322 9.035-6.619 16.196-15.11 31.746-15.212-.916 6.359-3.842 10.708-5.291 16.534zm18.519 1.985c5.769 6.415 8.858 17.329 9.259 27.116-3.641 3.636-9.274 5.278-15.212 6.614.19-3.938-1.376-6.12-1.983-9.26 7.196-1.492 2.699-12.042 1.322-16.534 3.017-1.832 4.917-4.782 6.614-7.936zm-12.567 1.985c3.777 5.483 7.164 11.355 7.276 20.502-5.852.32-7.676 4.669-13.228 5.291-2.924-.824-2.797-4.697-5.291-5.953 2.876-2.634 6.12-4.901 9.259-7.274-1.566-1.962-1.434-5.621-3.307-7.276 1.869-1.658 3.93-3.126 5.291-5.29zm-15.872 7.275c3.058-.03 6.542.369 7.937-1.323 1.931.935 2.099 3.633 3.307 5.291-3.338 5.48-9.619 8.018-15.211 11.243-2.955-1.234-5.07-3.307-5.953-6.613 3.746-2.211 10.869-3.812 9.92-8.598zm-2.645.66c-3.5 6.643-11.348 8.936-18.519 11.905-.898-2.628-2.371-4.684-3.307-7.274 4.625.435 7.786-.592 11.905-.662-.465-5.268-5.359-6.104-5.952-11.243 5.829 1.885 9.666 5.765 15.873 7.274zm-21.826-1.983c.533-.568 1.813-.393 1.984-1.323 4.738-.771 3.87 4.067 7.275 4.63-1.566 1.521-5.936.237-8.598.662.015-1.56-1.139-1.949-.661-3.969zm-3.969 7.274c-.231 1.833-1.98 3.894-3.307 2.646-.094-2.079 1.697-2.272 3.307-2.646zm-6.613 12.567c-.82-3.029 2.066-5.926 1.322-9.259 2.714 1.035 2.821 4.676 5.291 5.952-2.054 1.252-3.672 2.94-6.613 3.307zm1.322 2.645c1.962-1.345 3.45-3.164 5.953-3.968.429-4.536-2.898-6.845.662-9.259 3.215 2.297 5.481 5.542 7.275 9.259-1.449 3.84-5.061 5.521-7.937 7.937-2.803-.504-3.855-2.76-5.953-3.969zm9.922 3.969c1.471-2.497 4.203-3.734 5.952-5.953-.214-2.43-1.631-3.66-1.984-5.952 3.758.01 5.977-1.518 7.937-3.308 2.822 3.352 6.429 5.917 7.937 10.583-5.01 4.672-12.382 11.444-19.842 4.63zm12.565 3.969c2.975-2.979 6.738-5.169 9.259-8.598-.587-1.397-2.014-1.955-1.983-3.969 2.844-.903 4.823-2.671 7.274-3.969 3.141 2.372 3.867 7.157 6.614 9.921-4.99 5.429-12.248 12.399-21.164 6.615zm14.55 1.983c2.507-2.564 5.244-4.898 7.937-7.275-.514-1.47-1.389-2.578-1.323-4.629 3.371-.598 6.785-1.153 8.598-3.307 3.073 2.439 2.125 8.899 3.307 13.228-4.553 3.863-11.537 3.378-18.519 1.983zm15.212 2.646c.263-2.383 3.273-2.018 4.63-3.307v-4.63c2.44-.426 5.053-.68 6.613-1.984 2.967 2.765 1.635 9.83 1.984 15.212-5.826 1.727-11.719-.66-13.227-5.291zm21.164 15.211c-2.892 1.585-8.282 1.688-11.905.662-.143-3.604-2.502-4.994-2.646-8.598 3.215.127 6.322.149 7.936-1.323v-3.969c2.712-.066 5.422-.129 7.276.662.277 4.686-.243 8.575-.661 12.566zM36.759 95.504c-.747 2.36-2.897 6.775-1.322 9.259-.221-3.968 3.357-4.141 2.646-8.598-.147-.516-.554-.768-1.324-.661zm69.446-60.847c.049-.927-.147-2.53-.661-1.323-1.083 3.328-2.703 6.116-3.969 9.26 1.873.309 2.491-6.313 4.63-7.937zM81.072 66.403c-12.528-1.504-15.345 6.701-17.857 15.211 4.491-1.602 2.264-6.23 4.63-9.259 3.158-4.043 8.815-2.641 13.227-5.952zm-1.984 5.291c-8.113-6.7-12.565 6.572-11.905 11.243 3.891-1.258 12.676-3.14 11.905-11.243zm-5.291 1.323c1.512-1.763 3.196 1.869 1.983 3.306h-3.307c1.297-.558 4.321-2.269 1.324-3.306zm-.662 5.291c2.136 1.135-3.438.013-2.646 1.983-.884-.457.327-1.763-.661-3.307 1.261.283 1.198 1.891 3.307 1.324z",
                    }),
                ],
            });

            oldAvatar.replaceWith(newAvatar);
        });
    };

    const init = function init(ui) {
        // Initial run to catch all of the avatars in case things load weirdly
        replaceAvatars(ui);

        // Run whenever the message wall is updated, for example when you press
        // the "View More Replies" or "View More Messages" buttons
        const messageWall = document.querySelector("#MessageWall");
        const observer = new MutationObserver(function () {
            replaceAvatars(ui);
        });
        observer.observe(messageWall, { childList: true, subtree: true });
    };

    importArticle({
        type: "script",
        article: "u:dev:MediaWiki:Dorui.js",
    });

    mw.hook("doru.ui").add(init);
})();