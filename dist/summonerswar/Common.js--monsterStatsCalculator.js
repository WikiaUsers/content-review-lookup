/* ================================================== */
/* ====   Monster Stats Calculator               ==== */
/* ================================================== */

/*  The new monster pages no longer need the code  */

/*  
    The Monster Stats Calculator generates the wiki code for the stats table at the end of the page, 
    but the code is hard for editors to copy & paste. This code transfers the wiki code from plain text 
    on the page to a textarea for editors' convenience.

    Wiki code is generated under the div id msc-temp. When msc-temp is finally detected, 
    all text is then transferred to a textarea, and msc-temp is deleted to allow continuous usage. 

    Code is set to run again when msc-temp re-appears so as to update textarea with newest stats table.
*/


jQuery(document).ready(function() {
  checkForMSCResult();
});

function checkForMSCResult () {
  if($('#msc-temp').is(':visible'))
  { 
        // if the code is visible on the page, switch to textarea

        // Convert tags of generated monster stats table from text to html
          var str = document.getElementById("msc-temp").innerHTML;
          str = str.replace("&lt;","<");
          str = str.replace("&gt;",">");
          str = str.replace(/<br>/g,"");
          str = str.replace(/<p>/g,"");
          str = str.replace(/\n<\/p>/g,"");

        // Create a textarea to contain the generated monster stats table
          document.getElementById("msc-result").innerHTML = '<textarea cols="100" rows="20">' + str + '</textarea>';
          var mscDiv = document.getElementById("msc-temp");
        // Delete temporary section generated by stats calculator. 
          mscDiv.parentNode.removeChild(mscDiv); 
  }
  
  // Look for wiki code generated by calculator again after every 100ms
  setTimeout(checkForMSCResult, 100); 
}