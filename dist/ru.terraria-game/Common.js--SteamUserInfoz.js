/* Any JavaScript here will be loaded for all users on every page load. */

window.JSExtensionConfig=window.JSExtensionConfig||{},window.JSExtensionConfig.wikiMod=window.JSExtensionConfig.wikiMod||{},window.JSExtensionConfig.wikiMod.require=window.JSExtensionConfig.wikiMod.require||{},window.JSExtensionConfig.wikiMod.require["wikimod.steamapi"]=!0,window.JSExtensionConfig.wikiMod.require["wikimod.animate"]=!0,window.JSExtensionConfig.wikiMod.require["wikimod.velocity"]=!0,+function(a,b,c,d){function e(){return typeof wikiMod!==c&&wikiMod?wikiMod:a.wikiMod||b.wikiMod}function f(){j||(j=!0,d(a.jQuery||a.$||b.jQuery||b.$||null,e()))}function g(a){a=a||1;try{if(!j&&!e()&&150>a)return setTimeout(function(){g(a+1)},25)}catch(b){}f()}function h(){var d=a[i],e=b[i],h=!0;try{if(d===!0||e===!0)return f();try{b[i]=f}catch(j){}if(c!=typeof b[i]&&b[i]!==f&&(h=!1),(d===!1||"function"!=typeof d)&&h){try{a[i]=f}catch(j){console.log(j)}c!=typeof a[i]&&a[i]!==f&&(h=!1)}}catch(j){}h&&g()}var i="onWikiModReady",j=!1;h()}(this,window,"undefined",function($,wikiMod){function a(b){var c=this;c._StartTime=(new Date).getTime(),c.working={},c.$target=$(b),c.$target.addClass("processing"),c.$target.html(""),c.statusInit(),c.status.create("init",{progress:0,max:6,description:"Init core functions"}),c.status.create("badges",{progress:0,max:8,description:"Collect and process user badge data"}),c.status.create("IDCache",{description:"Steam ID was cached and available for use"}),c.status.create("ProfileDetails",{progress:0,max:1,description:"Processing extended profile details"}),c.$targetMirrorPlaceholder=$('<div class="steam-mirror-placeholder init"></div>'),c.$target.before(c.$targetMirrorPlaceholder),c.$targetContainer=$('<div style="position:absolute;top:0;left:0;overflow-x:hidden;width:'+a.getWikiaMainContentWidth()+'px;"></div>'),a.$steamContainer.append(c.$targetContainer),c.$target=c.$target.detach(),c.$targetContainer.append(c.$target),c.makeBoxEvent("onComplete",!1,!0),c.makeBoxEvent("onShellReady",!1,!0),c.makeBoxEvent("onMainBoxReady",!1,!0),c.makeBoxEvent("onExtendedBoxReady",!1,!0);var d;if(c.$targetContainer.hover(function(){d&&clearTimeout(d),c.crop("all")},function(){var a;(a=function(){d&&clearTimeout(d),c.$targetContainer.ismouseover()?d=setTimeout(function(){a()},50):c.crop("none")})()}),c.games=[].concat(x.games),c.gameAppids=[],c.steamId64=null,c.profileInfo=null,c.profileSummary=null,c.options={username:null,message:null,messageTitle:null,extraGames:[],showBackground:!1,extended:!1},c.options.username=c.$target.attr("data-steam-username"),!c.options.username||"string"!=typeof c.options.username)throw new Error("Invalid Username!!");if(c.username=c.options.username,c.$target.attr("data-steam-message")){var e=c.$target.attr("data-steam-message");e&&"string"==typeof e&&(c.options.message=e.replace(/<(?:.|\n|\r)*?>/gm,"").replace(/<(?:.|\n|\r)*?>/gm,""))}if(c.$target.attr("data-steam-message-title")){var f=c.$target.attr("data-steam-message-title");f&&"string"==typeof f&&(c.options.messageTitle=f.replace(/<(?:.|\n|\r)*?>/gm,"").replace(/<(?:.|\n|\r)*?>/gm,""))}if(c.$target.attr("data-steam-show-background")){var g=c.$target.attr("data-steam-show-background").toString().toLowerCase().trim();("true"==g||"1"==g)&&(c.options.showBackground=!0)}if(c.$target.attr("data-steam-extended-profile")){var h=c.$target.attr("data-steam-extended-profile").toString().toLowerCase().trim();("true"==h||"1"==h)&&(c.options.extended=!0)}if(c.$target.attr("data-steam-extra-games")){var i,j=c.$target.attr("data-steam-extra-games");if("string"==typeof j&&j.length>2)try{if(i=JSON.parse(j),i.games&&"array"==wikiMod.RealTypeOf(i.games))for(var k=0;k<i.games.length&&!(k>=4);k++)try{"object"==typeof i.games[k]&&i.games[k].name&&i.games[k].appid&&(i.games[k].name=i.games[k].name.replace(/<(?:.|\n|\r)*?>/gm,"").replace(/<(?:.|\n|\r)*?>/gm,""),i.games[k].appid=parseInt(i.games[k].appid).toString(),i.games[k].image="http://cdn.akamai.steamstatic.com/steam/apps/"+i.games[k].appid.toString()+"/capsule_184x69.jpg",c.options.extraGames.push(i.games[k]))}catch(l){}}catch(l){}c.options.extraGames&&(c.games=c.games.concat(c.options.extraGames))}for(var k=0;k<c.games.length;k++)c.gameAppids.push(c.games[k].appid);c.status.create("games",{progress:0,max:c.gameAppids.length,description:"Collect and process game data"}),c.onExtendedBoxReady(function(a){setTimeout(function(){c.fireBoxEvent("onComplete")},50)}),c.getSteamId64().then(function(a){"string"==typeof a&&a.length>1}),c.addResizeListener(function(a,b){b?b.indexOf("height")>-1&&c.boxResizeAndReposition():c.boxResizeAndReposition()}),setTimeout(function(){c.getProfileHTML().then(function(){},function(){}),c.boxResizeAndReposition()},0),setTimeout(function(){c.$target.mutate("height",function(){a.resizeAndRepositionAll()}),c.$targetMirrorPlaceholder.mutate("offsetLeft offsetTop",function(){a.resizeAndRepositionAll()})},50)}function b(a,b){var c=b.owned||(b.playTime>-1?!0:!1),d="00.0";if(b.playTime&&parseInt(b.playTime)>-1){var e=parseFloat(b.playTime)/60;e=parseInt(10*e)/10,e>=1e3?d=parseInt(e).toString():e>=100?d='<span style="opacity:0.3;">0</span>'+parseInt(e).toString():(d=(10>e?"0":"")+e.toString(),parseFloat(parseInt(d))===parseFloat(d)&&(d+=".0"))}var f="29",g="78",h=$('<div class=" steam-row steam-row-game '+(c?"owned":"notowned")+'" data-steam-game-appid="'+b.appid+'"><div class="steam-row-wrap"><div class="steam-row-inner"><span class="steam-user-game-title">'+b.title+'</span><span class="steam-user-game-time"><span class="time">'+d+'</span><span class="played">PLAYED</span><span class="hrs">HRS</span></span></div></div></div>'),i=$('<img width="'+g+'" height="'+f+'" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" />');return h.find(".steam-row-inner").prepend(i),a.deferImage(i,b.image),h}function c(){var a=$("#WikiaPage"),b=a.children(".WikiaPageContentWrapper");return{page:parseInt(a.width()),wrapper:parseInt(b.width())}}function d(a,b,c){var d=function(a){var d=a.staticdata,e="http://media.steampowered.com/steamcommunity/public/images/apps/"+a.appid+"/"+d.img_icon_url+".jpg",f='<div class="steam-popup-badge-icon icon-throbber" data-icon-url="'+e+'">&nbsp;</div><div class="steam-popup-badge-text-wrapper"><div class="steam-popup-badge-appname">'+(d.name||a.name||c.name)+'</div><div class="steam-popup-badge-title">'+(d.name||a.name||c.name)+'</div></div><div class="steam-popup-badge-level"><span style="padding-right:2px; font-weight:bold; opacity:0.7;">LV</span><span>'+a.level+"</span></div>";J.make(b,{content:f,position:"top-center",onBeforeShow:function(a,b,c){var d=$(".steam-popup-badge-icon",a);if(!d.attr("data-icon-added")){d.attr("data-icon-added","1");var e=d.attr("data-icon-url"),f=!1,g=function(){f||(f=!0,wikiMod.requestAnimationFrame(function(){d.css({opacity:"1",background:"center center url('"+e+"')"}).removeClass("icon-throbber")}))};try{var h=new Image;h.onload=g,setTimeout(function(){h.src=e},0),d.css("opacity","0")}catch(i){}setTimeout(g,235)}}})};if(c.appid){var e,f={},g=!1;e=function(){if(!g){var b=!0;c.staticdata||(b=!1,f.staticdata||(f.staticdata=steamAPI.getGameStaticData(c.appid,["name","img_icon_url"]).then(function(a){c.staticdata=a,e()})["catch"](function(a){console.log("err: ",a)}))),c.level||(b=!1,f.getUserBadgeInfo||(f.getUserBadgeInfo=steamAPI.getUserBadgeInfo(a.username,c.appid,c.border).then(function(a){c.level=a.level,c.name||(c.name=a.name),c.appname=a.appname,e()})["catch"](function(a){console.log("err: ",a)}))),b&&!g&&(g=!0,d(c))}},wikiMod.setAsap(function(){e()})}}function e(a,b,c){var d=function(a){for(var d=a.staticdata,e=a.schema.availableGameStats?a.schema.availableGameStats.achievements:a.schema.achievements||a.schema,f,g=0;g<e.length;g++)if(e[g].name.toString().toLowerCase()==(a.name||"").toString().toLowerCase()||e[g].name.toString().toLowerCase()==(a.apiname||"").toString().toLowerCase()){f=e[g].displayName;break}var h="http://media.steampowered.com/steamcommunity/public/images/apps/"+a.appid+"/"+d.img_icon_url+".jpg",i='<div class="steam-popup-achievement-icon icon-throbber" data-icon-url="'+h+'">&nbsp;</div><div class="steam-popup-achievement-text-wrapper"><div class="steam-popup-achievement-appname">'+d.name+'</div><div class="steam-popup-achievement-title">'+f+"</div></div>"+(c.info?'<div class="steam-popup-achievement-info">'+c.info+"</div>":"")+(c.description?'<div class="steam-popup-achievement-description">'+c.description+"</div>":"");J.make(b,{content:i,position:"top-center",onBeforeShow:function(a,b,c){var d=$(".steam-popup-achievement-icon",a);if(!d.attr("data-icon-added")){d.attr("data-icon-added","1");var e=d.attr("data-icon-url"),f=!1,g=function(){f||(f=!0,wikiMod.requestAnimationFrame(function(){d.css({opacity:"1",background:"center center url('"+e+"')"}).removeClass("icon-throbber")}))};try{var h=new Image;h.onload=g,setTimeout(function(){h.src=e},0),d.css("opacity","0")}catch(i){}setTimeout(g,235)}}})};if(c.appid){var e,f={},g=!1;e=function(){var b=!0;c.schema||(b=!1,f.schema||(f.schema=steamAPI.getGameSchema(c.appid).then(function(a){c.schema=a,e()})["catch"](function(a){console.log("err: ",a)}))),c.achievement||(b=!1,f.achievement||(f.achievement=a.getUserGameAchievements(c.appid).then(function(a){a[c.name]&&(c.achievement=a[c.name],e())})["catch"](function(a){console.log("err",a)}))),c.staticdata||(b=!1,f.staticdata||(f.staticdata=steamAPI.getGameStaticData(c.appid,["name","img_icon_url"]).then(function(a){c.staticdata=a,e()})["catch"](function(a){console.log("err: ",a)}))),b&&!g&&(g=!0,d(c))},wikiMod.setAsap(function(){e()})}}function f(){var a=this===document?$(this):$(this).contents();a.mousemove(function(a){$.mlp={x:a.pageX,y:a.pageY}}),a.find("iframe").load(f)}function g(a,b){if((!a||(O.push(a),!b))&&S)if(P<=x.MaxWorkers-1&&O.length>0){P++;var c=O[0];O.splice(0,1);var d=function(a){setTimeout(function(){a.loadDeferredImages()},500),setTimeout(function(){a.loadDeferredImages()},2e3),P--,wikiMod.setAsap(function(){g()})};Q++,c.initBox().then(function(){d(c)},function(a){console.log("Init fail!",c.username,a),d(c)})}else R&&Q>=N.length&&clearInterval(R)}function h(a){wikiMod.setAsap(function(){a.createShell().then(function(){g(a,!0)})["catch"](function(b){console.log("Error ",b),g(a,!0)})})}function i(b){var c=$(b);if(!c.hasClass("processing")&&!c.hasClass("complete")){var d=new a(b);N.push(d),h(d)}}function j(){if(!L){L=!0,M=$('<div class="steam-container" style="position:absolute;left:0;top:0;"></div>'),$("body").append(M),a.$steamContainer=M;var b=wikiMod.$$(".steam-user-info[data-steam-username]");if(b&&b.length>0){steamAPI.initCache();for(var c=0;c<b.length;c++)i(b[c]);setTimeout(function(){R=setInterval(function(){wikiMod.setAsap(function(){g()})},150)},300)}}}function k(){var a=l.MutationObserver||l.WebKitMutationObserver||window.MutationObserver||window.WebKitMutationObserver,b=window.location.search.indexOf("action=edit")>-1||window.location.search.indexOf("veaction=edit")>-1?!0:!1;if(a){var c,d;if(d=new a(function(a,b){for(var c=0;c<a.length;++c)for(var d=0;d<a[c].addedNodes.length;++d)if("WikiaArticle"==a[c].addedNodes[d].className){var e=$(a[c].addedNodes[d]),f=e.find(".steam-user-info[data-steam-username]");f&&f.length>0&&f.each(function(){i(this)})}}),c=new a(function(a,b){for(var c=0;c<a.length;++c)for(var e=0;e<a[c].addedNodes.length;++e)if("EditPageDialog"==a[c].addedNodes[e].id){var f=$(a[c].addedNodes[e]);d.observe(a[c].addedNodes[e],{childList:!0,subtree:!0});var g=f.find(".steam-user-info[data-steam-username]");g&&g.length>0&&g.each(function(){i(this)})}}),b){c.observe(wikiMod.body,{childList:!0});var e=$("#EditPageDialog");e&&e.length>0&&d.observe(e.get(0),{childList:!0,subtree:!0})}var f=$("#WikiaArticle");f&&f.length>0&&d.observe(f.get(0),{childList:!0,subtree:!0})}}var l=this,m=!0,n="undefined",o=typeof unsafeWindow!==n&&"window"===Object.prototype.toString.call(unsafeWindow).replace(/^\[object |\]$/g,"").toLowerCase()?unsafeWindow:null,p="",q=!1,steamAPI=l.wikiaSteamAPI||window.wikiaSteamAPI||l.SteamAPI||window.SteamAPI;wikiMod.require(["wikimod.animate","wikimod.velocity"],function(a,b){q=!0});var r={cache:{UserGameStatsMaxTime:30,ProfileInfoMaxTime:20,ProfileSummaryMaxTime:20,UserBadgeInfoMaxTime:120,UserTopBadgeMaxTime:120},UI:{UserInfoFadeInDelay:50,UserInfoFadeInTime:800},MaxWorkers:1},s={UserGameStatsMaxTime:10,ProfileInfoMaxTime:5,ProfileSummaryMaxTime:5};if(!o&&(l.SteamUserInfo===!0||window.SteamUserInfo===!0))return void console.log("Steam User Info Already Loaded!");if(window.SteamUserInfo=l.SteamUserInfo=!0,o&&(o.SteamUserInfo=!0),!(window.location.search.indexOf("veaction=edit")>-1)){var t=l.SteamAPI_Config||window.SteamAPI_Config||(o?o.SteamAPI_Config:null);"object"==typeof t&&t.games&&0!=t.games.length||console.log("No Steam API Settings detected");for(var u=0;u<t.games.length;u++){var v=t.games[u].appid;if(!v)return void console.log("Steam game must have an App ID!",t.games[u]);try{if(v.toString()!==parseInt(v).toString())return void console.log("Invalid Steam App ID!",t.games[u])}catch(w){return void console.log("Err",w)}}var x=wikiMod.extend(!0,{},r,t);for(var y in s)x.cache[y]<s[y]&&(x.cache[y]=s[y]);x.MaxWorkers=parseInt(x.MaxWorkers)||1,x.MaxWorkers<=0?x.MaxWorkers=1:x.MaxWorkers>2&&(x.MaxWorkers=2);var z={0:{text:"Offline",className:"offline"},1:{text:"Online",className:"online"},2:{text:"Busy",className:"busy"},3:{text:"Away",className:"away"},4:{text:"Snooze",className:null},5:{text:"Looking to Trade",className:null},6:{text:"Looking to Play",className:null}},A={1:{display:"Private",state:"private"},2:{display:"Friends Only",state:"friends only"},3:{display:"Friends of Friends",state:"friends of friends"},4:{display:"Users Only",state:"users only"},5:{display:"Public",state:"public"}};a["static"]={},a.getGameInfo=function(b,c){var d=b.toString(),e=arguments,f=e.length;a["static"].gameInfo||(a["static"].gameInfo={});var g=a["static"].gameInfo[d];if(!g||1==f)return g;for(var h=1;f>h;h++)if(g=g[e[h]],!g)return g;return g},a.getWikiaMainContentWidth=function(a,b){var c=$("#WikiaMainContent"),d=parseInt(c.width());return d},a.hasGameInfo=function(b,c){var d=b.toString(),e=arguments,f=e.length,g;if(a["static"].gameInfo||(a["static"].gameInfo={}),g=a["static"].gameInfo[d],!g)return!1;if(c){for(var h=1;f>h;h++)if(g=g[e[h]],!g)return!1;return!0}return!0},a.horizontalScrollPanel=function(a){if("object"!=typeof this)throw new TypeError("Horizontal Scroll must be constructed via new");var b=this;b.data=a;var c=b.$el=$('<div class="steam-row row-span-4 steam-horizontal-scroll-panel '+(a.className||"")+'"></div>'),d=b.$steamUserGameInfo=$('<div class="steam-row-wrap" style="height: 100%; width: 100%; box-sizing: border-box;"></div>'),e=b.$steamHorizontalScrollWrapper=$('<div class="steam-horizontal-scroll-wrapper"></div>'),f=b.$steamHorizontalScrollContent=$('<div class="steam-horizontal-scroll-content" data-page-count="0" data-page="0"></div>'),g=b.$prevButton=$('<div class="prev-btn disabled"></div>'),h=b.$nextButton=$('<div class="next-btn disabled"></div>'),i=!1;if(b.pages=[],a.flipper?(b.flipper={onBackClicked:a.flipper.onBackClicked,onFrontClicked:a.flipper.onFrontClicked,onBeforeShowFront:a.flipper.onBeforeShowFront,onBeforeShowBack:a.flipper.onBeforeShowBack},c.addClass("flip-container"),b.$flipper=$('<div class="flipper"></div>'),b.$flipperFront=$('<div class="steam-row front"></div>'),b.$flipperBack=$('<div class="steam-row back"></div>'),b.$flipperBack.click(function(a){"function"==typeof b.flipper.onBackClicked&&b.flipper.onBackClicked.apply(this,a,b)}),b.$flipperFront.click(function(a){"function"==typeof b.flipper.onFrontClicked&&b.flipper.onFrontClicked.apply(this,a,b)}),c.append(b.$flipper),b.$flipper.append(b.$flipperFront,b.$flipperBack),b.$flipperFront.append(d)):c.append(d),d.append(e),e.append(f),d.append(g,h),a.pages&&a.pages.length>0)for(var j=0;j<a.pages.length;j++)b.addPage(a.pages[j]);else a.page&&a.singlePageScroll&&b.addPage(a.page);var k=function(a){var b=a.children().slice(-6),c,d=-1e4;return b.each(function(){var a=$(this),b=a.position();parseInt(b.left)>d&&(d=b.left,c=a)}),c};return g.click(function(){if(!i&&!g.hasClass("disabled")){var c=parseInt(f.attr("data-page")||0),d=c-1,e=b.pages.length,j=!1;if(0>d&&(d=0),a.singlePageScroll){var l=$(b.pages[0]);if("object"==typeof a.singlePageScroll&&"function"==typeof a.singlePageScroll.getRightElement){var m=a.singlePageScroll.getRightElement(l);m&&0!=m.length||(m=k(l))}else m=k(l);var n=m.position(),o=l.position(),p=parseInt(n.left)+parseInt(o.left);c>0?(g.siblings(".next-btn").removeClass("disabled"),0>=d&&g.addClass("disabled"),j=!0):g.addClass("disabled")}else c>0?(j=!0,0==d&&g.addClass("disabled")):(i=!1,g.addClass("disabled"));j&&(i=!0,b.setPage(d),h.removeClass("disabled"),setTimeout(function(){i=!1},500))}}),h.click(function(){if(!i&&!h.hasClass("disabled")){var c=parseInt(f.attr("data-page")||0),d=c+1,e=b.pages.length,j=!1;if(a.singlePageScroll){var l=$(b.pages[0]),m;if("object"==typeof a.singlePageScroll&&"function"==typeof a.singlePageScroll.getRightElement){var m=a.singlePageScroll.getRightElement(l);m&&0!=m.length||(m=k(l))}else m=k(l);var n=m.position(),o=l.position(),p=parseInt(n.left)+parseInt(o.left);p>200?(h.siblings(".next-btn").removeClass("disabled"),(15>=p-250||parseInt(m.width())+p-250<=299)&&h.addClass("disabled"),j=!0):(i=!1,h.addClass("disabled"))}else e-1>c?(j=!0,d==e&&h.addClass("disabled")):(i=!1,h.addClass("disabled"));j&&(d>5&&(d=0),i=!0,b.setPage(d),g.removeClass("disabled"),setTimeout(function(){i=!1},500))}}),b},a.horizontalScrollPanel.prototype.setPage=function(a){var b=this,c=parseInt(a),d=parseInt(b.$steamHorizontalScrollContent.attr("data-page")||0);return c>d?b.$steamHorizontalScrollContent.addClass("slidingRight").removeClass("slidingLeft").attr("data-page",c.toString()):d>c&&b.$steamHorizontalScrollContent.addClass("slidingLeft").removeClass("slidingRight").attr("data-page",c.toString()),b},a.horizontalScrollPanel.prototype.addPage=function(a,b){var c=this,d=parseInt(c.$steamHorizontalScrollContent.attr("data-page-count")),e;try{e=$('<div class="steam-horizontal-scroll-page '+(b||"")+'"></div>').append(a),c.$steamHorizontalScrollContent.append(e),c.pages.push(e),c.$steamHorizontalScrollContent.attr("data-page-count",(d||0)+1),c.$nextButton.removeClass("disabled")}catch(f){console.log("error",f,e)}return c},a.horizontalScrollPanel.prototype.removeAllPages=function(){var a=this;a.$steamHorizontalScrollContent.attr("data-page-count","0"),a.$steamHorizontalScrollContent.removeClass("slidingLeft").removeClass("slidingRight").attr("data-page","0"),a.$prevButton.addClass("disabled"),a.$nextButton.addClass("disabled");for(var b=0;b<a.pages.length;b++)$(a.pages[b]).remove();return a.pages=[],a},a.horizontalScrollPanel.prototype.getPage=function(a){var b=this;return a<b.pages.length?b.pages[a]:void 0},a.horizontalScrollPanel.prototype.showFront=function(a){var b=this,c=b.flipper&&b.$el.hasClass("flipped");if(c){if("function"==typeof b.flipper.onBeforeShowFront)try{c=b.flipper.onBeforeShowFront.apply(b.$flipperFront,a,b)!==!1}catch(a){c=!1}c&&b.$el.removeClass("flipped")}return c},a.horizontalScrollPanel.prototype.showBack=function(a){var b=this,c=b.flipper&&!b.$el.hasClass("flipped");if(c){if("function"==typeof b.flipper.onBeforeShowBack)try{c=b.flipper.onBeforeShowBack.apply(b.$flipperFront,a,b)!==!1}catch(a){c=!1}c&&b.$el.addClass("flipped")}return c},a.loadAllDeferredImages=function(a){for(var b=0,c=function(b){a===!0&&(N[b].deferImagesEnabled=!1);try{wikiMod.setAsap(function(){N[b].loadDeferredImages()})}catch(c){}};b<N.length;b++)c(b)};var B,C=!1;a.resizeAndRepositionAll=function(a,b){B&&(wikiMod.cancelAnimationFrame(B),B=null);var c=function(){if(B=null,C)setTimeout(function(){B||(B=wikiMod.requestAnimationFrame(c))},10);else{C=!0;for(var a=0;a<N.length;a++)try{N[a].boxResizeAndReposition()}catch(b){}C=!1}};B=wikiMod.requestAnimationFrame(c)},a.updateGameInfo=function(b,c){var d=b.toString(),e=arguments,f=e.length;if(a["static"].gameInfo||(a["static"].gameInfo={}),a["static"].gameInfo[d]||(a["static"].gameInfo[d]={}),c)if(2==f)a["static"].gameInfo[d]=wikiMod.extend(!0,a["static"].gameInfo[d],c);else{for(var g=a["static"].gameInfo[d],h=1;f-2>h;h++)if(g=g[e[h]],!g)return!1;"object"==typeof c?g[e[f-2]]=wikiMod.extend(!0,g[e[f-2]],e[f-1]):"string"==typeof c?g[e[f-2]]=e[f-1].toString()+"":g[e[f-2]]=e[f-1]}},a.prototype.addAvatar=function(){var a=this;return a.working.addAvatar?a.working.addAvatar:(a.working.addAvatar=new wikiMod.Promise(function(b,c){a.getProfileInfo().then(function(c){var d="online"==c.onlineState.toLowerCase();a.$steamUserInfoAvatar.addClass(d?"online":"offline"),a.$steamUserInfoAvatar.append('<a href="steam://friends/add/'+c.steamID64+'" data-title="Add '+c.steamID+'"><img src="'+c.avatarFull+'"></img></a><div class="status-online">Online</div><div class="status-offline" title="'+c.stateMessage+'">Offline</div>'),a.getProfileSummary().then(function(b){J.make(a.$steamUserInfoAvatar,{content:'<div class="steam-user-info-avatar-popup" style="width:175px;height:144px;"><div class="wikiaThrobber"></div></div><div style="height:15px;text-align:center;color:#fff;">Click To Add On Steam</div>',position:"right-top",offsets:{right:-10},onBeforeShow:function(c,d,e){if(b&&b.gameid){var f=$(".steam-user-info-avatar-popup",c);f.css("display","block");var g=f.attr("data-load-state");!b||g&&"0"!=g||(f.attr("data-load-state","loading"),b.gameid&&b.gameextrainfo?steamAPI.getGameSchema(b.gameid).then(function(c){steamAPI.getUserGameAchievements(a.username,b.gameid).then(function(a){for(var d=[],e=0;e<a.achievements.length;e++)a.achievements[e].achieved&&d.push(a.achievements[e].apiname);for(var g=[],h=[],i=function(a,b){var c='<div class="steam-achievement-small animated fadeIn"><img style="width:30px;height:30px;" src="'+(b?a.icon:a.icongray)+'" /></div>';return c},j=15,k=0;k<c.availableGameStats.achievements.length&&(d.indexOf(c.availableGameStats.achievements[k].name)>-1?g.push(i(c.availableGameStats.achievements[k],!0)):d.length<j&&h.push(i(c.availableGameStats.achievements[k],!1)),!(g.length+h.length>=j));k++);f.html(""),f.css({height:"109px","padding-left":"2px"});var l="16px",m=b.gameextrainfo.toString().length;m>30?l="12px":m>20&&(l="14px"),f.parent().prepend('<div class="steam-user-info-avatar-popup-title" style="font-size:'+l+';">'+b.gameextrainfo+"</div>");for(var k=0;k<g.length;k++)f.append(g[k]);for(var k=0;k<h.length;k++)f.append(h[k]);f.attr("data-load-state","complete")})}):(f.css("height",""),f.html('<div style="width:100%;text-align:center;margin:20px 0; font-size:14px;opacity:0.7;">User Not In-Game<br />No Stats To Show</div>')))}else{var f=$(".steam-user-info-avatar-popup",c);f.css("display","none")}}}),a.status.inc("init")}),a.working.addAvatar=null,b(a.$steamUserInfoAvatar)})["catch"](function(a){c(a)})}),a.working.addAvatar)},a.prototype.addCol2=function(){var a=this;return a.working.addCol2?a.working.addCol2:a.col2Added?wikiMod.Promise.resolve(!0):(a.working.addCol2=new wikiMod.Promise(function(b,c){var d=!1,e=function(e,f){if(!d){if(d=!0,a.col2Added=!0,a.working.addCol2=null,f===!1)return c(e);a.status.inc("init"),b(e)}};wikiMod.setAsap(function(){a.getProfileInfo().then(function(b){return!b.onlineState&&b.privacyMessage&&/not yet set up their Steam Community profile/i.test(b.privacyMessage)?(setTimeout(function(){a.$steamUserInfoContent.html("<b>Error</b> - User Profile Not Set Up!")},250),e("Profile Not Set Up",!1)):void a.getUserGameStats().then(function(b){a.$userProfileTimeBox=$('<div class="steam-row"><div class="steam-user-profile-time"></div></div>'),a.$userBadgeCollectionFlipContainer=$('<div class="steam-row flip-container"></div>'),a.$userBadgeCollectionFlipper=$('<div class="flipper"></div>'),a.$userBadgeCollectionFlipper_Front=$('<div class="steam-row front"></div>'),a.$userBadgeCollectionFlipper_Back=$('<div class="steam-row back"></div>'),a.$userBadgeCollectionFlipper.append(a.$userBadgeCollectionFlipper_Front,a.$userBadgeCollectionFlipper_Back),a.$userBadgeCollectionFlipContainer.append(a.$userBadgeCollectionFlipper),a.$userBadgeCollectionBox=$('<div class="steam-row"><div class="steam-row-wrap"></div></div>'),$(".steam-row-wrap",a.$userBadgeCollectionBox).append(a.$userBadgeCollectionFlipContainer),a.$userBadgeCollection_InfoContainer=$('<div class="steam-row-wrap"></div>'),a.$userBadgeCollection=$('<div class="steam-badge-collection animated fast"><div class="wikiaThrobber animated fast"></div></div>'),a.$userBadgeCollection_InfoContainer.append(a.$userBadgeCollection),a.$userBadgeCollectionFlipper_Front.append(a.$userBadgeCollection_InfoContainer),a.$steamUserInfoCol2.append(a.$userProfileTimeBox,a.$userBadgeCollectionFlipContainer),a.$userBadgeCollectionFlipper_Back.click(function(){a.$userBadgeCollectionFlipContainer.removeClass("flipped"),J.hideAllPopups()}),steamAPI.getUserGameTime(a.username).then(function(b){var c=(parseInt(b.playtime_forever/60*100)/100).toString(),d=(parseInt(b.playtime_2weeks/60*100)/100).toString(),e="";parseInt(c)<10?e="0000":parseInt(c)<100?e="000":parseInt(c)<1e3?e="00":parseInt(c)<1e4&&(e="0"),e&&(c='<span style="opacity:0.3;">'+e+"</span>"+c);var f="";parseInt(d)<10?f="0000":parseInt(d)<100?f="000":parseInt(d)<1e3?f="00":parseInt(d)<1e4&&(f="0"),f&&(d='<span style="opacity:0.3;">'+f+"</span>"+d),"."!=c.substr(c.length-3,1)&&(c+="0"),"."!=d.substr(d.length-3,1)&&(d+="0");var g='<div style="float:left;"><div style="font-size: 23px;">'+c+'</div><div style="line-height:7px;letter-spacing:3px;font-size:10px;margin-left:11px;">Total Hours</div></div>',h='<div style="float:right;"><div style="font-size:23px;text-align:right;">'+d+'</div><div style="text-align:right;line-height:7px;letter-spacing:3px;font-size: 10px;margin-right:26px;">2Weeks</div></div>';a.$userProfileTime=$(".steam-user-profile-time",a.$userProfileTimeBox),a.$userProfileTime.append(g+h),J.make($(".steam-user-profile-time > div:first-of-type",a.$userProfileTimeBox),{content:"Total Hours On Steam",position:"bottom-center",offsets:{bottom:-5}}),J.make($(".steam-user-profile-time > div:last-of-type",a.$userProfileTimeBox),{content:"Time Played Last 2 Weeks",position:"bottom-center",offsets:{bottom:-5}})},function(a){console.log("timeErr",a)}),a.addTopBadges().then(function(a){},function(a){console.log("err",a)}),wikiMod.setAsap(function(){e(!0)})},function(a){e(a,!1)})},function(a){console.log("Error addCol2",a),e(a,!1)})})}),a.working.addCol2)},a.prototype.addCol3=function(){var a=this,b="addCol3";return a.working[b]?a.working[b]:a.col3Added?wikiMod.Promise.resolve(!0):(a.working[b]=new wikiMod.Promise(function(c,d){var e=!1,f=function(f,g){if(!e){if(e=!0,a.col3Added=!0,a.working[b]=null,g===!1)return d(f);a.status.inc("init"),c(f)}},g;wikiMod.setAsap(function(){a.getProfileInfo().then(function(b){var c=function(a){var b=a.style||"",c=$('<div class="steam-user-profile-info-wrap" style="'+b+'"></div>');if(a.title)if("string"==typeof a.title)c.append("<h2>"+a.title+"</h2>");else if("object"==typeof a.title)if(wikiMod.isElement(a.title))c.append($("<h2></h2>").append(a.title));else if(wikiMod.isPlainObject(a.title)){var d=wikiMod.createNewElement(a.title);c.append($("<h2></h2>").append(d))}if(a.body||"string"==typeof a.body){var e=a.bodyClass||"",f=a.bodyStyle||"",g="";if(a.bodyTitle&&(g=' title="'+a.bodyTitle+'"'),"string"==typeof a.body)c.append('<div class="'+e+'" style="'+f+'"'+g+">"+a.body+"</div>");else if("object"==typeof a.body)if(wikiMod.isElement(a.body))c.append($('<div class="'+e+'" style="'+f+'"'+g+"></div>").append(a.body));else if(wikiMod.isPlainObject(a.body)){var h=wikiMod.createNewElement(a.body);c.append($('<div class="'+e+'" style="'+f+'"'+g+"></div>").append(h))}}return c},d=[{title:"Member Since",bodyClass:"steam-user-profile-member-since",body:b.memberSince},{title:"Player State",bodyClass:"steam-user-profile-state",body:"N/A"},{title:"Playing",bodyClass:"steam-user-profile-playing",body:"N/A",style:"display:none;"},{title:"Profile",bodyClass:"steam-user-profile-id",body:'<a href="http://steamcommunity.com/id/'+(b.customURL||b.steamID)+'/">'+b.steamID+"</a>"},{title:"Level",bodyClass:"steam-user-level",bodyStyle:"text-align:center;float:right;padding-right:0px;",body:'<div class="steam-user-level-num">?</div>',style:"height:54px;"},{bodyClass:"steam-user-infobtn",bodyStyle:'float:right;text-decoration:underline;text-decoration-style:dotted;"><div style="font-size:11px;opacity:0.3;cursor:pointer;',bodyTitle:"Click to Refresh",body:"debug"}],e=0,h=0,i=function(b){var d=c(b);return a.$steamUserInfoCol3.append(d),d},j=!1,k=function(){if(!j){j=!0;var b=z[g.personastate.toString()],c=b.text,d=b.className,e="Online",h="online",i=a.$steamUserInfoAvatar,k=$(".status-online",i),l=$(".steam-user-profile-playing",a.$steamUserInfoCol3);g.gameid&&g.gameextrainfo?(a.addCol2().then(function(){setTimeout(function(){var b=$('.steam-row-game[data-steam-game-appid="'+g.gameid.toString()+'"]',a.$steamUserInfoContent);b&&b.length>0&&b.addClass("playing").attr("title","Playing Now")},50)}),e="In-Game",h="in-game",l.html(g.gameextrainfo),$(".steam-user-profile-member-since",a.$steamUserInfoCol3).parent().css("display","none"),l.parent().css("display","block")):l.parent().css("display","none"),0==parseInt(g.personastate)?i.removeClass("online").removeClass("Online").addClass("offline"):(i.removeClass("offline").addClass("online"),i.addClass("offline"!=h.toLowerCase()?h:"online"),k.html(e).addClass("offline"!=h.toLowerCase()?h:"online"),"in-game"==e.toLowerCase()&&g.gameextrainfo&&k.attr("title",g.gameextrainfo)),c?(a.$profileStateEl.html(c),d&&a.$profileStateEl.addClass(d)):a.$profileStateEl.html("Unknown"),f(!0)}},l=function(){setTimeout(function(){a.refreshStatusPopup()},1e3),a.$profileStateEl=$(".steam-user-profile-state",a.$steamUserInfoCol3),g&&!j&&k()};$.each(d,function(a,b){e++,wikiMod.setAsap(function(){i(b),h++,h===e&&l()})}),a.getProfileSummary().then(function(a){g=a,h>=e&&k()},function(a){f(!1,!1)})})["catch"](function(a){f(a,!1)})})}),a.working[b])},a.prototype.addGamesCol=function(){var a=this,c="addGamesCol";return a.working[c]?a.working[c]:a.gamesColAdded?wikiMod.Promise.resolve(!0):(a.working[c]=new wikiMod.Promise(function(d,e){var f=!1,g=function(b,g){if(!f){if(f=!0,a.gamesColAdded=!0,a.working[c]=null,g===!1)return e(b);a.status.inc("init"),d(b)}};wikiMod.setAsap(function(){a.getUserGameStats().then(function(c){for(var d=0,e=0;e<a.games.length;e++){var f=c[a.games[e].appid.toString()];f&&(a.games[e].image||(a.games[e].image="http://cdn.akamai.steamstatic.com/steam/apps/"+a.games[e].appid+"/capsule_184x69.jpg"),a.$steamUserInfoCol1.append(b(a,{appid:a.games[e].appid,title:a.games[e].name,owned:-1==f.playtime_forever?!1:!0,playTime:f.playtime_forever,image:a.games[e].image})),d++,5==d&&a.$steamGamesBtnDown.removeClass("disabled"))}setTimeout(function(){$(".steam-row-game",a.$steamUserInfoCol1).each(function(){try{var b=$(this),d=c[b.attr("data-steam-game-appid").toString()];d&&d.playtime_forever>-1&&wikiMod.requestAnimationFrame(function(){var c="display:inline-block;width:45%;text-align:center;font-family: 'Motiva Sans Thin',Arial,Helvetica,Verdana,sans-serif;";J.make(b,{content:'<div style="width:170px;"><div style="'+c+'"><div style="font-size:20px;line-height:17px">'+parseInt(d.playtime_forever||0).toString()+'</div><div style="line-height:10px;font-size:8px;">Total Minutes</div></div><div style="float:right;'+c+'"><div style="font-size:20px;line-height:17px">'+parseInt(d.playtime_2weeks||0).toString()+'</div><div style="line-height:10px;font-size:8px;">2 Weeks</div></div></div>',position:"right",offsets:{}}),b.click(function(){a.updateGameInfo({$gameEl:b,appid:b.attr("data-steam-game-appid").toString()}).then(function(){})["catch"](function(a){console.log("error",a)}),wikiMod.requestAnimationFrame(function(){a.$steamUserInfoCol2.attr("data-page","1")})})})}catch(e){console.log("Games Col Error",e)}}),g(!0)},0)},function(a){g(a,!1)})})}),a.working[c])},a.prototype.addProfileDetail=function(a){
var b=this;b.working.profileDetailAnimations||(b.working.profileDetailAnimations=[]);var c=b.working.profileDetailAnimations.length,d=a.hasClass("col-2")?1:2,e=0,f=0,g;c>0&&(g=b.working.profileDetailAnimations[c-1],e=g.rowNum,2==d||2==g.width||1==g.colNum?e++:1==g.width&&0==g.colNum&&1==d&&(f=1)),1==f&&a.addClass("right"),b.$steamExtendedUserProfile.css("display","block");var h=function(a,c){try{b.$steamExtendedUserProfile.append(a),wikiMod.requestAnimationFrame(function(){a.addClass("animated").addClass("show").removeClass("collapsed"),c(!0)})}catch(d){c(!1)}};return b.working.profileDetailAnimations.push({el:a,width:d,rowNum:e,colNum:f,prom:new wikiMod.Promise(function(e,i){var j=!1,k=function(c){j||(j=!0,setTimeout(function(){b.boxResizeAndReposition()},4),setTimeout(function(){e(a)},25))};if(0==c||1==c&&1==f)wikiMod.setAsap(function(){h(a,k)});else{var l=0;c>1&&(l=0==f||2==d||2==g.width?c-1:c-2),b.working.profileDetailAnimations[l].prom.then(function(){h(a,k)})["catch"](function(){h(a,k)})}g&&c>0&&0==f&&1==g.width&&0==g.colNum&&g.el.removeClass("col-2")})}),b.working.profileDetailAnimations[c].prom},a.prototype.addTopBadges=function(){var a=this,b="addTopBadges";return a.working[b]?a.working[b]:a.topBadgesAdded?wikiMod.Promise.resolve(!0):(a.working[b]=new wikiMod.Promise(function(c,e){var f=!1,g=function(d,g){if(!f){if(f=!0,a.working[b]=null,g===!1)return e(d);c(d)}};a.topBadgesAdded=!0;var h,i=[],j,k,l=!1,m=!1,n=function(){if(j&&!l){if(l=!0,h&&h.length>0)try{for(var b=0;b<h.length;b++){var c=$('<div class="steam-user-badge" data-badge-title="'+h[b].name+'" data-badge-appid="'+h[b].appid+'" data-badge-level="'+h[b].badge.level+'" data-badge-border="'+h[b].border+'"></div>'),d=$('<img class="steam-user-badge-img" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" />');c.append(d),a.deferImage(d,h[b].icon),i.push(c)}}catch(e){}else i.push($('<div style="text-align:center;margin-top:30px;width:100%;">No Badges</div>'));var f=$(".wikiaThrobber",a.$userBadgeCollection);a.$badgeElements=$($.map(i,function(a){return a.get()})),a.$userBadgeCollection.addClass("fadeOut"),f.css("display","none"),a.$userBadgeCollection.append(a.$badgeElements),setTimeout(function(){a.$userBadgeCollection.addClass("fadeIn").removeClass("fadeOut")},10),a.addCol3().then(function(){var b=$(".steam-user-level",a.$steamUserInfoCol3),c=$(".steam-user-level-num",b);c.html(j.player_level.toString());var d=10*parseInt(parseInt(j.player_level)/10);b.addClass("lvl_"+d.toString()),J.make(b,{content:"XP: "+j.player_xp,position:"left-center",offsets:{left:-10}});var e=$(".steam-user-infobtn",a.$steamUserInfoCol3);e.click(function(){a.refreshStatusPopup()})})}},o=function(){if(k&&!m){if(m=!0,a.$badgeElements.each(function(){var b=$(this),c=b.attr("data-badge-appid"),e=k[c.toString()]||k[parseInt(c)],f=e.name;d(a,b,{appid:c,stats:k,border:b.attr("data-badge-border"),name:b.attr("data-badge-title")}),a.status.inc("badges"),b.click(function(){var c=b.attr("data-badge-appid");if(!a.working.badgeFlipper&&c){a.working.badgeFlipper=c;var d=b.attr("data-badge-border"),e=b.attr("data-badge-level"),f=b.attr("data-badge-title");$("[data-popup-id]",a.$userBadgeCollectionFlipper_Back).each(function(){J.destroyPopup($(this))}),a.$userBadgeCollectionFlipper_Back.html('<div class="steam-row-wrap steam-user-badge-cards-container"><div class="wikiaThrobber" style="background-color: transparent;"></div><div class="content"></div></div>'),a.$userBadgeCollectionFlipContainer.addClass("flipped");var g=$(".content",a.$userBadgeCollectionFlipper_Back);g.hide(),J.hideAllPopups(),steamAPI.getUserBadgeInfo(a.username,b.attr("data-badge-appid"),d||"0").then(function(b){var c=$('<div class="left-badge-info"><img src="'+b.icon+'" /><div class="level">Level '+e+"</div></div>"),d=$('<div class="right-card-container"></div>'),f=$('<div class="scroll" data-row="1" style="margin-top:0px;"></div>');if(d.append(f),b.cards.series[1]){var h=b.cards.series[1],i=0;for(var j in h){i++;var k=$('<div data-card-index="'+i+'" data-card-row="'+(parseInt((i-1)/4)+1)+'" class="card"><img src="'+h[j].image+'" style="width:35px;height:auto;" /></div>');f.append(k),J.make(k,{content:'<div><img src="'+h[j].image+'" /><div style="text-align:center;font-weight:bold;">'+h[j].desc.toString().replace(/\s*\(\s*\d+\s*\)\s*/g,"")+'</div><div style="text-align:center;">'+(h[j].owned||"0")+" Owned</div></div>",position:"top-center",offsets:{}})}}else f.append("No Cards Found");g.append('<div style="position:relative;"><div class="badge-title">'+b.name+"</div></div>",c,d),$(".wikiaThrobber",a.$userBadgeCollectionFlipper_Back).fadeOut(300),setTimeout(function(){g.fadeIn(250),a.working.badgeFlipper=null},200)})["catch"](function(b){console.log("badgeData error",b),a.working.badgeFlipper=null})}})}),a.$badgeElements.length<8)for(var b=a.$badgeElements.length;8>b;b++)a.status.inc("badges");g(!0)}};steamAPI.getUserTopBadge(a.username,8,a.gameAppids).then(function(a){j=a,h=j.badges,wikiMod.setAsap(function(){n(),wikiMod.setAsap(function(){k&&o()})})},function(a){console.log("topBadgeErr",a),g(a,!1)}),steamAPI.getAllUserGameStats(a.username).then(function(a){k=a,l&&wikiMod.setAsap(o)},function(a){console.log("AllUserGameStatsErr",a),g(a,!1)})}),a.working[b])},a.prototype.makeBoxEvent=function(a,b,c){var d=this,e=arguments.length;return d.boxEvents||(d.boxEvents={}),"object"==typeof d.boxEvents[a]?void console.log("Error! BoxEvent Exists",a,d.boxEvents[a]):"undefined"!=typeof d[a]?void console.log("Error! BoxEvent Cannot Overwrite Existing Function!",a):(d.boxEvents[a]={fired:!1,firing:!1,prevArgs:[],callWaiting:[],allowPersistent:"boolean"==typeof b?b:!0,keepFiredState:"boolean"==typeof c?c:!0,name:a,stack:[]},void(d[a]=function(b,c){var e=arguments.length,f=typeof b,g=!1,h=function(a,b,c){try{wikiMod.setAsap(function(){a.apply(b||d,c||null)})}catch(e){console.log("SteamBox Event Error",e)}};if("function"==f&&(b.persist=d.boxEvents[a].allowPersistent&&c===!0,(b.persist||!d.boxEvents[a].fired)&&d.boxEvents[a].stack.push(b),d.boxEvents[a].keepFiredState&&d.boxEvents[a].fired))try{h(b,d,d.boxEvents[a].prevArgs||[d])}catch(i){}else 0==e?d.fireBoxEvent(a,d.boxEvents[a].prevArgs||[d]):1==e&&"array"==wikiMod.RealTypeOf(b)&&d.fireBoxEvent(a,b)}))},a.prototype.fireBoxEvent=function(a,b){var c=this,d=arguments.length,e=0,f=0,g=0,h=[],i=!1;b=b||[c];var j=function(b,d){if(g++,-1!=d&&c.boxEvents[a].allowPersistent&&b===!1&&h.push(d),i&&g==f){if(h.length>0){for(var e=[],j=0;j<c.boxEvents[a].stack.length;j++)-1==h.indexOf(j)&&e.push(c.boxEvents[a].stack[j]);c.boxEvents[a].stack=e}if(c.boxEvents[a].firing=!1,c.boxEvents[a].callWaiting.length>0){var k=c.boxEvents[a].callWaiting[0];c.boxEvents[a].callWaiting.splice(0,1),wikiMod.setAsap(function(){c.fireBoxEvent.apply(c,k)})}}},k=function(a,b,d,e){wikiMod.setAsap(function(){var f;try{f=a.apply(b||c,d||null)}catch(g){console.log("SteamBox Event Error",g)}j(f,e)})};if(!c.boxEvents[a])return!1;if(c.boxEvents[a].firing)return c.boxEvents[a].callWaiting.push(Array.splice.call(arguments,0)),!0;for(c.boxEvents[a].prevArgs=b,c.boxEvents[a].firing=!0,c.boxEvents[a].keepFiredState&&(c.boxEvents[a].fired=!0);c.boxEvents[a].stack.length&&c.boxEvents[a].stack.length>e;){f++;var l=c.boxEvents[a].stack[e],m=c.boxEvents[a].stack[e].persist,n=e;m?e++:c.boxEvents[a].stack.splice(e,1),k(l,c,b,m?n:-1)}if(d>2)for(var o=2;d>o;o++)"function"==typeof arguments[o]&&(f++,k(arguments[o],c,b,-1));return i=!0,!0},a.prototype.needsResize=function(){var a=this;if(a.working.needsResize)return 0;var b=parseInt(a.$targetMirrorPlaceholder.width()),c=parseInt(a.$targetMirrorPlaceholder.height()),d=parseInt(a.$target.width()),e=parseInt(a.$target.height()),f=b!=d||c!=e?e-c:0;return a.working.needsResize=!0,0>=f?setTimeout(function(){a.working.needsResize=!1},8):setTimeout(function(){a.working.needsResize=!1},40),f},a.prototype.boxResize=function(){var a=this,b=a.needsResize();if(0==b||0>=b+30)return wikiMod.Promise.resolve(!1);if(a.working.boxResize){if(!(a.working.boxResizeCancel&&Math.abs(b)>15&&Math.abs(b-a.working.boxResizeDistance)>10))return a.working.boxResize;a.working.boxResizeCancel()}return a.working.boxResize=new wikiMod.Promise(function(b,c){var d=q,e=!1,f=!1,g=function(){e||f||(e=!0,a.working.boxResize=null,a.working.boxResizeCancel=null,a.working.boxResizeDistance=null,wikiMod.requestAnimationFrame(function(){a.working.boxResize||a.boxResize()}),b(!0))},h=function(){e||f||(f=!0,d?a.$targetMirrorPlaceholder.velocity("stop",!0):a.$targetMirrorPlaceholder.clearQueue().stop(),e=!0,a.working.boxResize=null,a.working.boxResizeCancel=null,a.working.boxResizeDistance=null,b(!1))};a.working.boxResizeCancel=h,wikiMod.setAsap(function(){if(!f){d=q;var b=parseInt(a.$targetMirrorPlaceholder.width()),c=parseInt(a.$targetMirrorPlaceholder.height()),e=parseInt(a.$target.width()),h=parseInt(a.$target.height()),i={};b!=e&&(i.width=e+"px"),c!=h&&(i.height=h+"px");var j=Math.abs(parseFloat(c)-parseFloat(h)),k=parseInt(1.75*j);if(k>300)k=300;else{if(25>j)return a.working.boxResizeCancel=null,a.$targetMirrorPlaceholder.css(i),g();48>k&&(k=48)}a.working.boxResizeDistance=j,d?a.$targetMirrorPlaceholder.velocity(i,{duration:k,easing:"linear",complete:g}):a.$targetMirrorPlaceholder.animate(i,{duration:k,easing:"linear",always:g})}})}),a.working.boxResize},a.prototype.boxReposition=function(){var a=this;return a.working.boxReposition?a.working.boxReposition:(a.working.boxReposition=new wikiMod.Promise(function(b,c){var d=!1,e=function(e,f){d||(d=!0,a.working.boxReposition=null,f===!1&&c(e),b(e))};wikiMod.setAsap(function(){var b=a.$targetMirrorPlaceholder.offset(),c=a.$targetContainer.offset(),d=!1;(parseInt(b.left)!=parseInt(c.left)||parseInt(b.top)!=parseInt(c.top))&&(a.$targetContainer.css({left:b.left,top:b.top}),d=!0),setTimeout(function(){e(d)},15)})}),a.working.boxReposition)},a.prototype.boxResizeAndReposition=function(a){var b=this;return wikiMod.Promise.all([b.boxReposition(),b.boxResize()]).then(function(){if("function"==typeof a)try{a()}catch(b){}})["catch"](function(a){console.log("Error boxResizeAndReposition",a)})},a.prototype.createShell=function(){var a=this;return a.working.createShell?a.working.createShell:a.shellCreated?wikiMod.Promise.resolve(!0):(a.working.createShell=new wikiMod.Promise(function(b,c){wikiMod.setAsap(function(){var c='<div class="steam-blue-bg" style="background-color: transparent;background-image: url(http://cdn.akamai.steamstatic.com/steam/apps/292030/page_bg_v6.jpg?t=1433249628);background-size: 100% auto;border:0 none;padding:0;margin:0;position:absolute;top:-20px;left:-20px;width:100%;width:calc(100% + 20px);height:100%;height:calc(100% + 20px);opacity: 0.9;display:block;z-index:1;"></div>',d="",e=a.options.message?!0:!1,f=a.options.messageTitle?!0:!1;if(e||f){var g='<div class="user-message-title">'+(f?"<h2>"+a.options.messageTitle+"</h2>":"")+"</div>",h=e?'<div class="user-message">'+a.options.message+"</div>":"",i=(f?"has-title":"")+" "+(e?"has-message":"");d='<div class="steam-extended-user-profile-container steam-message-wrapper '+i+'">'+g+h+"</div><br /><br />"}a.$steamExtendedUserProfile=$('<div class="steam-extended-user-profile animated slow" style="display:none;">'+c+d+"</div>"),a.$steamProfileBackgroundContainer=$('<div class="steam-profile-background-container animated"></div>'),a.$steamUserInfoBox=$('<div class="steam-user-info-box animated fast"></div>'),a.$steamUserInfoBoxInner=$('<div class="steam-user-info-box-inner animated fast"></div>'),a.$mainThrobber=$('<div class="wkMblThrobber-custom-wrap animated"><div class="wkMblThrobber-custom cntr"><span></span></div></div>'),a.$steamUserInfoContentWrap=$('<div class="steam-user-info-content-wrap"></div>'),a.$steamUserInfoContentWrap.append(a.$mainThrobber),a.$steamUserInfoContent=$('<div class="steam-user-info-content ex-small"></div>'),a.$steamUserInfoContentWrap.append(a.$steamUserInfoContent),a.$steamUserInfoBoxInner.append(a.$steamUserInfoContentWrap),a.$steamUserInfoBox.append(a.$steamUserInfoBoxInner),a.$steamUserInfoAvatar=$('<div class="steam-user-info-avatar animated"></div>'),a.$steamUserInfoCol1=$('<div class="steam-user-info-col1 animated fast" data-page="0"></div>'),a.$steamUserInfoCol2=$('<div class="steam-user-info-col2 animated fast"></div>'),a.$steamUserInfoCol3=$('<div class="steam-user-info-col3 animated fast"></div>'),a.$steamGamesBtns=$('<div class="steam-games-btns animated fast" style=""></div>'),a.$steamGamesBtnUp=$('<div class="steam-btn-up steam-games-btn-up disabled">&nbsp;</div>'),a.$steamGamesBtnDown=$('<div class="steam-btn-down steam-games-btn-down disabled">&nbsp;</div>'),a.$steamGamesBtns.append(a.$steamGamesBtnUp,a.$steamGamesBtnDown),a.$steamUserInfoContent.append(a.$steamUserInfoAvatar,a.$steamUserInfoCol1,a.$steamGamesBtns,a.$steamUserInfoCol2,a.$steamUserInfoCol3),a.$steamGamesBtnDown.click(function(){var b=$(this);if(!b.hasClass("disabled")){var c=a.$steamUserInfoCol1;c.attr("data-page")||c.attr("data-page","0");var d=c.children(".steam-row-game"),e=d.length,f=parseInt(c.attr("data-page")),g=4*f+4;if(g>=e)return void b.addClass("disabled");d.each(function(){var a=$(this),b=parseInt(a.css("top"))||0;a.css("top",b-195+"px")}),c.attr("data-page",(f+1).toString()),g+4>=e&&b.addClass("disabled"),e>4&&a.$steamGamesBtnUp.removeClass("disabled")}}),a.$steamGamesBtnUp.click(function(){var b=$(this);if(!b.hasClass("disabled")){var c=a.$steamUserInfoCol1;c.attr("data-page")||c.attr("data-page","0");var d=c.children(".steam-row-game"),e=d.length,f=parseInt(c.attr("data-page"));if(0>=f)return void b.addClass("disabled");var g=4*f-4;d.each(function(){var a=$(this),b=parseInt(a.css("top"))||0;a.css("top",b+195+"px")}),c.attr("data-page",(f-1).toString()),(0>=g||0>=f-1)&&b.addClass("disabled"),e>4&&a.$steamGamesBtnDown.removeClass("disabled")}}),a.$target.append(a.$steamUserInfoBox),a.$steamExtendedUserProfile&&a.$target.append(a.$steamExtendedUserProfile),a.$target.append(a.$steamProfileBackgroundContainer),setTimeout(function(){a.$target.css("display","block")},10),setTimeout(function(){a.show(),a.status.inc("init"),a.working.createShell=null,a.shellCreated=!0,a.fireBoxEvent("onShellReady"),b()},100),wikiMod.setAsap(function(){a.boxResizeAndReposition()})})}),a.working.createShell)},a.prototype.crop=function(b){var d=this;return d.working.crop&&d.working.cropCancel&&d.working.cropCancel(),d.working.crop=new wikiMod.Promise(function(e,f){var g=q,h=!1,i=!1,j=function(){h||i||(h=!0,d.working.crop=null,d.working.cropCancel=null,d.boxResizeAndReposition(),e())},k=function(){h||i||(i=!0,g?(d.$target.velocity("stop",!0),d.$targetContainer.velocity("stop",!0)):(d.$target.clearQueue().stop(),d.$targetContainer.clearQueue().stop()),h=!0,d.working.crop=null,d.working.cropCancel=null,f())};d.working.cropCancel=k;var l=b,m="1018px",n=0,o,p=c();wikiMod.setAsap(function(){if(!i){if(g=q,"string"==typeof b){if("all"==b.toLowerCase())p.wrapper>1020?(l=p.wrapper+"px",m=p.wrapper+"px"):l="1018px";else if("none"==b.toLowerCase())l=a.getWikiaMainContentWidth()+"px";else if(b&&(!isNaN(b)||/^\d+(?:\.\d+)?px$/i.test(b)))try{l=parseInt(b)+"px"}catch(c){l="1018px"}}else"number"==typeof b&&(l=b+"px");parseInt(d.$target.width())==parseInt(m)&&parseInt(d.$targetContainer.width())==parseInt(l)?j():(n=Math.abs(parseFloat(d.$targetContainer.width())-parseFloat(l)),o=parseInt(1.5625*n),g?(d.$target.velocity({width:m},{duration:o,easing:"ease-in-out",complete:function(){j()}}),d.$targetContainer.velocity({width:l},{duration:o,easing:"ease-in-out",complete:function(){j()}})):(d.$target.animate({width:m,easing:"linear",complete:function(){j()},fail:function(){j()},always:function(){j()}},o),d.$targetContainer.animate({width:l,easing:"linear",complete:function(){j()},fail:function(){j()},always:function(){j()}},o)))}})}),d.working.crop.then(function(){},function(){}),d.working.crop},a.prototype.deferImagesEnabled=!0,a.prototype.deferImage=function(a,b){var c=this;c.deferredImageStack||(c.deferredImageStack=[]),c.deferImagesEnabled?(a.attr("src","data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="),a.attr("data-deferred",b),c.deferredImageStack.push(a)):a.attr("src",b)},a.prototype.deferImages=function(a){var b=this;a.each(function(){b.deferImage($(this))})},a.prototype.loadDeferredImages=function(){var a=this,b,c=function(a){wikiMod.setAsap(function(){a.attr("src",a.attr("data-deferred")),a.attr("data-deferred","")})};return a.working.loadDeferredImages?a.working.loadDeferredImages:(a.working.loadDeferredImages=new wikiMod.Promise(function(b,d){wikiMod.setAsap(function(){if(a.deferredImageStack)for(;a.deferredImageStack.length;)c(a.deferredImageStack[0]),a.deferredImageStack.splice(0,1);a.working.loadDeferredImages=null,b(!0)})}),a.working.loadDeferredImages)},a.prototype.getAllUserGameStats=function(){var b=this;return b.working.getAllUserGameStats?b.working.getAllUserGameStats:b.allUserGameStats?wikiMod.Promise.resolve(b.allUserGameStats):(b.working.getAllUserGameStats=new wikiMod.Promise(function(c,d){wikiMod.setAsap(function(){steamAPI.getAllUserGameStats(b.username,b.gameAppids).then(function(e){if(e){b.allUserGameStats=e;for(var f in e)if("object"==typeof e[f]&&f.toString()==e[f].appid.toString())try{a.updateGameInfo(e[f].appid.toString(),{name:e[f].name,img_icon_url:e[f].img_icon_url,img_logo_url:e[f].img_logo_url})}catch(g){console.log("Update Game Info Failed",f,e[f])}return b.working.getAllUserGameStats=null,c(b.allUserGameStats)}return b.working.getAllUserGameStats=null,d(e)})["catch"](function(a){b.working.getAllUserGameStats=null,d(a)})})}),b.working.getAllUserGameStats)},a.prototype.getProfileBackground=function(){var a=this;if(a.working.getProfileBackground)return a.working.getProfileBackground;var b=steamAPI.steamUserInfoCache.getValue(a.username);return b.__profileBackgroundURL&&(a.profileBackgroundURL=b.__profileBackgroundURL),a.profileBackgroundURL?wikiMod.Promise.resolve(a.profileBackgroundURL):(a.working.getProfileBackground=new wikiMod.Promise(function(c,d){a.getProfileHTML().then(function(e){if(e&&e.length>0){var f=$(".profile_page",e);if(f.hasClass("has_profile_background")){var g,h,i=/^\s*url\(\s*(?:[\"\'])?(.+?)(?:[\"\'])?\s*\)\s*\;\s*?$/i,j=/background-image:\s*url\(\s*(?:[\"\'])?(.+?)(?:[\"\'])\s*\)/i;try{g=wikiMod.getComputedStyle(f[0]),a.profileBackgroundURL=g.getPropertyValue("background-image"),h=i.exec(a.profileBackgroundURL)}catch(k){h=null,a.profileBackgroundURL=null}if(h&&h.length>1&&"string"==typeof h[1]&&h[1].length>5)a.profileBackgroundURL=h[1];else{var l=f.attr("style");if(h=j.exec(l),!(h&&h.length>1&&"string"==typeof h[1]&&h[1].length>5))return null==a.profileBackgroundURL,a.working.getProfileBackground=null,d(e);a.profileBackgroundURL=h[1]}return b=steamAPI.steamUserInfoCache.getValue(a.username),b.__profileBackgroundURL=a.profileBackgroundURL,steamAPI.steamUserInfoCache.setValue(a.username,b),a.working.getProfileBackground=null,c(a.profileBackgroundURL)}}return a.working.getProfileBackground=null,d(null)})["catch"](function(b){a.working.getProfileBackground=null,d(b)})}),a.working.getProfileBackground)};var D={showcase:{}};a.prototype.getProfileDetails=function(){var a=this,b="getProfileDetails";if(a.working[b])return a.working[b];if(a.profileDetails&&"object"==typeof a.profileDetails)try{if(Object.keys(a.profileDetails).length)return wikiMod.Promise.resolve(a.profileDetails)}catch(c){}return a.working[b]=new wikiMod.Promise(function(c,d){var e,f=!1,g=function(g,h){if(!f){if(f=!0,e)try{clearTimeout(e)}catch(i){}if(a.status.complete("ProfileDetails",!0),a.working[b]=null,h===!1)return d(g);c(g)}};a.profileDetails=a.profileDetails||{},wikiMod.setAsap(function(){a.getProfileHTML().then(function(b){if(b&&b.length>0){var c=$(".profile_page",b),d=[],h=0,i=function(){h>=d.length&&g(a.profileDetails)},j=function(b,c){if(h++,c){a.status.inc("ProfileDetails");var d=b;if(a.profileDetails[d]){for(var e=0;a.profileDetails[d+e];)e++;d+=e}a.profileDetails[d]=c}wikiMod.setAsap(i)},k=function(b,e,f){var g=new wikiMod.Promise(function(d,g){var h,i,j,k,l=function(a){return k=a,k&&k.length?void d({name:b,colSpan:j.colSpan||e.colSpan||1,$html:k,data:j}):g()},m=function(b){return(j=b)?void wikiMod.setAsap(function(){try{i=e.toHTML.call(a,j)}catch(b){console.log("Detail Error",b)}i&&"function"==typeof i.then?i.then(function(a){l(a)},function(a){return j?void 0:g()}):l(i)}):g()};wikiMod.setAsap(function(){try{h=e.get.apply(a,f||[c])}catch(b){console.log("Detail Error",b)}h&&"function"==typeof h.then?h.then(function(a){m(a)},function(a){return g()}):m(h)})}).then(function(a){j(b,a)},function(){j(b)});return d.push(g),g},l=function(a){try{var b=$(".profile_customization_block",a),c=$(".profile_customization_block > div",a),d=c[0].className.toString().trim();if(d&&D.showcase[d]){var e=D.showcase[d];return k(d,e,[a,c])}console.log("Missing showcase name: ",d)}catch(f){console.log("cust error",f)}return null};wikiMod.setAsap(function(){if(c&&c.length>0){if(c.hasClass("private_profile"))return a.profileIsPrivate=!0,g(["Profile is Private!",b],!1);k("summary",D.summary,[c]),k("recentGame",D.recentGame,[c]);var d=$(".profile_content",c),j=$(".profile_customization_area",d),m={};if(j&&j.length>0){var n=$(".profile_customization",j);n.each(function(){var a=$(this);wikiMod.setAsap(function(){l(a)})})}}setTimeout(i,0),e=setTimeout(function(){f||g(a.profileDetails,h>0?!0:!1)},5e3)})}else g(a.profileDetails,!1)})["catch"](function(a){console.log("err",a),g(a,!1)})})}),a.working[b]},a.prototype.getProfileHTML=function(){var a=this;if(a.working.getProfileHTML)return a.working.getProfileHTML;var b=function(){try{if(a.$profileHTML&&a.$profileHTML.length>0&&a.$profileHTML.children().length>0&&a.$profileHTML.find(".profile_page").length>0)return!0}catch(b){}return!1};try{if(b())return wikiMod.Promise.resolve(a.$profileHTML)}catch(c){}return a.working.getProfileHTML=new wikiMod.Promise(function(c,d){var e=!1,f=function(b,f){if(!e){if(e=!0,a.working.getProfileHTML=null,f===!1)return d(b);c(b)}};a.getSteamId64().then(function(c){steamAPI.getProfileRawHTML(a.username,c).then(function(c){return b()?f(a.$profileHTML):c&&c.length>0&&c.children().length>0&&c.find(".profile_page").length>0?(a.$profileHTML=c,f(a.$profileHTML)):f(c,!1)})["catch"](function(a){f(a,!1)})})["catch"](function(a){f(a,!1)})}),a.working.getProfileHTML},a.prototype.getProfileInfo=function(){var a=this;return a.working.getProfileInfo?a.working.getProfileInfo:a.profileInfo&&"object"==typeof a.profileInfo?wikiMod.Promise.resolve(a.profileInfo):(a.working.getProfileInfo=new wikiMod.Promise(function(b,c){var d=!1,e=function(e,f){if(!d){if(d=!0,a.working.getProfileInfo=null,f===!1)return c(e);b(e)}};wikiMod.setAsap(function(){steamAPI.getProfileInfo(a.username).then(function(b){return b&&b.steamID&&b.steamID64?(a.profileInfo=b,a.steamId64||(a.steamId64=b.steamID64.toString()),e(b)):void e(b,!1)})["catch"](function(a){e(a,!1)})})}),a.working.getProfileInfo)},a.prototype.getProfileSummary=function(){var a=this;return a.working.getProfileSummary?a.working.getProfileSummary:a.profileSummary&&"object"==typeof a.profileSummary?wikiMod.Promise.resolve(a.profileSummary):(a.working.getProfileSummary=new wikiMod.Promise(function(b,c){var d=!1,e=function(e,f){if(!d){if(d=!0,a.working.getProfileSummary=null,f===!1)return c(e);b(e)}};wikiMod.setAsap(function(){a.getSteamId64().then(function(b){steamAPI.getProfileSummary(a.username,b.toString()).then(function(b){return b?(a.profileSummary=b,e(b)):void e(b,!1)},function(a){e(a,!1)})})["catch"](function(a){e(a,!1)})})}),a.working.getProfileSummary)},a.prototype.getSteamId64=function(){var a=this;return"string"==typeof a.steamId64&&a.steamId64.length>1?wikiMod.Promise.resolve(a.steamId64):a.working.getSteamId64?a.working.getSteamId64:(a.working.getSteamId64=new wikiMod.Promise(function(b,c){var d=!1,e=function(e,f){if(!d){if(d=!0,a.working.getSteamId64=null,f===!1)return c(e);"boolean"!=typeof a.userSteamIdIsValid&&e&&(a.userSteamIdIsValid=!0),a.status.complete("IDCache"),b(e)}},f=steamAPI.steamIdCache.getValue(a.username);a.status.set("IDCache",{success:f&&"string"==typeof f?!0:!1,status:f&&"string"==typeof f?"Cache Used":"No Cache"});var g=function(){return new wikiMod.Promise(function(b,c){steamAPI.resolveVanityURL(a.username).then(function(c){a.steamId64=c.toString(),b(c.toString())},function(a){console.log("getSteamId64 fail",a),c(a)})})},h=function(){return new wikiMod.Promise(function(b,c){steamAPI.getUserSteamIDs(a.username).then(function(d){return d&&d.steamID64?(a.steamId64=d.steamID64.toString(),d.steamID32&&(a.steamId32=d.steamID32.toString()),d.steamID3&&(a.steamId3=d.steamID3.toString()),d._steamID&&(a._steamId=d._steamID.toString()),b(a.steamId64)):void c(d)},function(a){console.log("getSteamId64 fail 2",a),c(a)})})};wikiMod.setAsap(function(){h().then(function(a){e(a)},function(a){console.log("ids error e",a),g().then(function(a){e(a)},function(a){e(a,!1)})})})}),a.working.getSteamId64)},a.prototype.getUserGameAchievements=function(a){var b=this,c=a.toString();if(b.working.getUserGameAchievements){if(b.working.getUserGameAchievements[c])return b.working.getUserGameAchievements[c]}else b.working.getUserGameAchievements={};return b.userGameAchievements&&b.userGameAchievements[c]?(b.working.getUserGameAchievements[c]=null,wikiMod.Promise.resolve(b.userGameAchievements[c])):(b.userGameAchievements||(b.userGameAchievements=[]),b.userGameStats||(b.userGameStats=[]),b.working.getUserGameAchievements[c]=new wikiMod.Promise(function(a,d){wikiMod.setAsap(function(){steamAPI.getUserGameAchievements(b.username,c).then(function(d){var e=0;for(b.userGameAchievements[c]||(b.userGameAchievements[c]=[]),e=0;e<d.achievements.length;e++)b.userGameAchievements[c].push(d.achievements[e]),b.userGameAchievements[c][d.achievements[e].name||d.achievements[e].apiname]=d.achievements[e];try{if(d.stats)for(b.userGameStats[c]||(b.userGameStats[c]=[]),e=0;e<d.stats.length;e++)b.userGameStats[c].push(d.stats[e]),b.userGameStats[c][d.stats[e].name||d.stats[e].apiname]=d.stats[e]}catch(f){}return b.working.getUserGameAchievements[c]=null,a(b.userGameAchievements[c])})["catch"](function(a){b.working.getUserGameAchievements[c]=null,d(a)})})}),b.working.getUserGameAchievements[c])},a.prototype.getUserGameStats=function(){var a=this;if(this.working.getUserGameStats)return this.working.getUserGameStats;var b=!1;if("object"==typeof a.userGameStats&&a.gameAppids.length>0){b=!0;for(var c=0;c<a.gameAppids.length;c++)if("object"!=typeof a.userGameStats[a.gameAppids[c].toString()]){b=!1;break}}return b?wikiMod.Promise.resolve(a.userGameStats):(a.working.getUserGameStats=new wikiMod.Promise(function(b,c){steamAPI.getUserGameStats(a.username,a.gameAppids).then(function(d){if(a.userGameStats||(a.userGameStats={}),d&&"object"==typeof d){for(var e in d)a.status.inc("games"),"object"==typeof d[e]?a.userGameStats[e.toString()]=d[e]:a.status.set("games",{success:!1,err:new Error("Game stats not found: "+e)});a.working.getUserGameStats=null,b(a.userGameStats)}else a.working.getUserGameStats=null,c(d)},function(b){a.working.getUserGameStats=null,c(b)})}),a.working.getUserGameStats)},a.prototype.initBox=function(){var a=this;return a.working.initBox?a.working.initBox:a.initBoxComplete?wikiMod.Promise.resolve(!0):(a._InitBoxTime=(new Date).getTime(),a.$steamUserInfoCol1||a.createShell(),a.working.initBox=new wikiMod.Promise(function(b,c){var d=!1,e=function(e,f){if(!d){if(d=!0,a.$target.addClass("complete").removeClass("processing"),a.initBoxComplete=!0,a.working.initBox=null,a.status.inc("init"),f===!1){var g;return g="undefined"!=typeof e?e instanceof Error?e:new Error("string"==typeof e?e:"initBox Error: "+("undefined"!=typeof e&&"function"==typeof e.toString?e.toString:"".toString)()):new Error("initBox Error"),a.status.set("init",{success:!1,err:g}),c(e)}b(e)}};wikiMod.setAsap(function(){a.validateUser().then(function(){var b={},c=function(){setTimeout(function(){a.removeThrobber(),a.fireBoxEvent("onMainBoxReady")},50),setTimeout(function(){a.loadDeferredImages(),a.$steamUserInfoAvatar.addClass("fadeIn"),setTimeout(function(){a.$steamUserInfoCol1.addClass("fadeIn"),a.$steamGamesBtns.addClass("fadeIn")},150),setTimeout(function(){a.$steamUserInfoCol2.addClass("fadeIn")},300),setTimeout(function(){a.$steamUserInfoCol3.addClass("fadeIn")},450)},200)},d=function(){a.getProfileDetails().then(function(b){if(b){var c=0,d=[],e=[],f;for(var g in b)if("object"==typeof b[g]&&b[g].colSpan){var h=b[g],i,j;0==d.length?(d.push(g+""),1==h.colSpan&&(c=1)):1==h.colSpan?(d.push(g+""),c=0==c?1:0):0==c?d.push(g+""):e.push(g+"")}for(f=0;f<e.length;f++)d.push(e[f]);var k=function(b){wikiMod.setAsap(function(){a.addProfileDetail(b)})};for(f=0;f<d.length;f++)b[d[f]]&&b[d[f]].$html&&k(b[d[f]].$html);a.fireBoxEvent("onExtendedBoxReady")}})["catch"](function(b){console.log("getProfileDetails error",b),a.fireBoxEvent("onExtendedBoxReady")})},f=[],g=!1,h=function(b){g||(g=!0,a.options.extended?d():(a.status.max("ProfileDetails",0),a.status.complete("ProfileDetails",!1),setTimeout(function(){a.fireBoxEvent("onExtendedBoxReady")},0)),setTimeout(function(){c()},50),e(!0))},i=function(a){console.log("Error",a,b),e(a,!1)};try{wikiMod.setAsap(function(){f.push(a.addAvatar().then(function(){b.addAvatar=!0})["catch"](function(a){b.addAvatar=!1}))}),setTimeout(function(){f.push(a.addGamesCol().then(function(){b.addGamesCol=!0})["catch"](function(a){b.addGamesCol=!1}))},15),setTimeout(function(){f.push(a.addCol2().then(function(){b.addCol2=!0})["catch"](function(a){b.addCol2=!1}))},30),setTimeout(function(){f.push(a.addCol3().then(function(){b.addCol3=!0})["catch"](function(a){b.addCol3=!1})),wikiMod.Promise.all(f).then(function(a){h(a)})["catch"](function(a){i(a)})},50),a.options.showBackground&&setTimeout(function(){a.setProfileBackground().then(function(a){b.profileBackground=!0})["catch"](function(a){console.log("fail url",a)})},25)}catch(j){console.log("Error, ",j,b),e(j,!1)}},function(b){var c="Username Not Found";b.err&&b.err.length&&(c=b.err.join("\n<br>")),a.removeThrobber(),setTimeout(function(){a.$steamUserInfoContent.html("<dl><dt><h3><b>Error</b></h3></dt><dd>"+c+"</dd></dl>")},150),e(b,!1)})})}),a.working.initBox)},D.showcase.achievement_showcase={displayName:"Achievements",colSpan:2,get:function(a,b){var c={achievements:[],stats:{},colSpan:2},d=c.achievements,e=$(".showcase_achievement:not(.plus_more)",b),f=/\/stats\/([\d]+)\/achievements/i;if(e.each(function(){var a=$(this),b=$("a",a),c=$("a img",a),e={},g=a.attr("data-community-tooltip"),h=g.toString().split("<br>");try{e.appid=f.exec(b.attr("href").toString())[1].toString()}catch(i){e.appid=null}if(h){e.gameName=h[0].toString().trim(),e.name=h[1].toString().trim();try{e.info=h[2].toString().trim()}catch(i){}}c&&c.length>0&&(e.image=c.attr("src")),e.appid&&/^[\d]+$/.test(e.appid)&&d.push(e)}),!d.length)return null;var g=$(".showcase_stats_row > .showcase_stat",b);return g.each(function(){var a=$(this),b=$(".label",a),d=b.text().toString().trim(),e=$(".value",a),f=e.text().toString().trim(),g=a.attr("data-community-tooltip");/Achievements/i.test(d)?c.stats.achievements={value:f,tooltip:g}:/Perfect\s*Games/i.test(d)?c.stats.perfect_games={value:f,tooltip:g}:/Game\s*Completion\s*Rate/i.test(d)&&(c.stats.game_completion_rate={value:f,tooltip:g})}),c},toHTML:function(a){for(var b=this,c=$('<div class="steam-extended-user-profile-container collapsed"></div>'),d=$('<div style="float:left;"></div>'),f=function(a,c){steamAPI.getGameSchema(c.appid).then(function(d){try{for(var f=d.availableGameStats.achievements,g=0;g<f.length;g++){var h=c.image.toLowerCase();if(f[g].icon&&h==f[g].icon.toLowerCase()||f[g].icongray&&h==f[g].icongray.toLowerCase()){e(b,a,{appid:c.appid,name:f[g].name,schema:d,info:c.info});break}}}catch(i){console.log("error getGameSchema->makeAchievementPopup",i)}},function(a){console.log("err",a)})},g=0;g<a.achievements.length;g++){var h=$('<img src="'+a.achievements[g].image+'" style="margin:0 0 20px 8px;height:60px;width:auto;" />');
d.append(h),f(h,a.achievements[g])}a.achievements.length<=6&&c.addClass("col-2");var i="text-align:center;font-size:25px;font-weight:bold;font-family: 'Motiva Sans Thin',Arial,Helvetica,Verdana,sans-serif;",j="text-align:center;font-family: 'Motiva Sans Thin',Arial,Helvetica,Verdana,sans-serif;",k=$('<div style="float:left;margin:12px 10px 0 15px;text-align:center;"><div style="'+i+'">'+a.stats.achievements.value+'</div><div style="'+j+'font-size:14px;">TOTAL</div></div>');J.make(k,{content:a.stats.achievements.tooltip,position:"top-center",offsets:{}});var l=$('<div style="float:left;margin:12px 10px 0 10px;text-align:center;"><div style="'+i+'">'+a.stats.perfect_games.value+'</div><div style="'+j+'font-size:14px;">PERFECT GAMES</div></div>');J.make(l,{content:a.stats.perfect_games.tooltip,position:"top-center",offsets:{}});var m=$('<div style="float:left;margin:12px 10px 0 10px;text-align:center;"><div style="'+i+'">'+a.stats.game_completion_rate.value+'</div><div style="'+j+'font-size:14px;">COMP. RATE</div></div>');J.make(m,{content:a.stats.game_completion_rate.tooltip,position:"top-center",offsets:{}});var n=$('<div class="steam-extended-user-profile-title"><div style="position: absolute;top:-3px;font-size:8.9px;line-height:8px;">ACHIEVEMENT</div><div style="position: absolute;top:5px;font-size:16px;line-height:16px;">DISPLAY</div></div>');return c.append(d,n,k,l,m),c}},D.showcase.badge_showcase={displayName:"Badge Collector",colSpan:2,get:function(a,b){var c=[],d={colSpan:2},e=$(".showcase_badges_icons > .showcase_slot.showcase_badge",b);e.each(function(){var a=$(this),b=$("a",a),d=$("a img",a),e={},f=a.attr("data-community-tooltip"),g=f.toString().split("<br>");if(g){e.name=g[0].toString().trim();try{e.info=g[1].toString().trim()}catch(h){}}d&&d.length>0&&(e.image=d.attr("src"));try{e.appid=/steamcommunity.com\/id\/[^\/]+\/gamecards\/([\d]+)/i.exec(b.attr("href").toString())[1]}catch(h){}try{e.border=/(?:\?|\&)border\=(\d+)/i.exec(b.attr("href").toString())[1]}catch(h){e.border="0"}c.push(e)}),d.badges=c;var f=$(".showcase_stats_row > .showcase_stat",b);return f.each(function(){var a=$(this),b=$(".label",a),c=b.text().toString().trim(),e=$(".value",a),f=e.text().toString().trim();/Badges\s*Earned/i.test(c)?d.badges_earned=f:/Game\s*Cards/i.test(c)&&(d.game_cards=f)}),d},toHTML:function(a,b){for(var b=this,c=$('<div class="steam-extended-user-profile-container collapsed"></div>'),e=$('<div style="float:left;"></div>'),f=0;f<a.badges.length;f++){var g=$('<img src="'+a.badges[f].image+'" style="margin:0px 0 20px 35px;height:60px;width:auto;" />');e.append(g),d(b,g,{appid:a.badges[f].appid,border:a.badges[f].border,name:a.badges[f].name})}var h=$('<div style="float:left;margin:5px 10px 0 60px;text-align:center;"><div style="text-align:center;font-size:25px;font-weight:bold;font-family: \'Motiva Sans Thin\',Arial,Helvetica,Verdana,sans-serif;">'+a.badges_earned+"</div><div style=\"text-align:center;font-size:18px;font-family: 'Motiva Sans Thin',Arial,Helvetica,Verdana,sans-serif;\">BADGES</div></div>"),i=$('<div style="float:left;margin:5px 10px 0 25px;text-align:center;"><div style="text-align:center;font-size:25px;font-weight:bold;font-family: \'Motiva Sans Thin\',Arial,Helvetica,Verdana,sans-serif;">'+a.game_cards+"</div><div style=\"text-align:center;font-size:18px;font-family: 'Motiva Sans Thin',Arial,Helvetica,Verdana,sans-serif;\">CARDS</div></div>"),j=$('<div class="steam-extended-user-profile-title"><div style="position: absolute;top:-5px;font-size:19px;line-height:18px;">BADGE</div><div style="position: absolute;top:13px;font-size:10px;line-height:12px;">COLLECTION</div></div>');return c.append(e,j,h,i),c}},D.showcase.favoritegame_showcase={displayName:"Favorite Game",colSpan:1,get:function(a,b){var c,d,e=null,f=$(".favoritegame_showcase_game .showcase_item_detail_title a",b);if(f&&f.length>0){c=f.text().toString().trim();try{d=/https?:\/\/steamcommunity\.com\/app\/(\d+)\/?/i.exec(f.attr("href"))[1]}catch(g){}}if(!d||!f||0==f.length){f=$(".workshop_showcase_item .showcase_item_detail_title a",b),c=f.text().toString().trim(),e="http://steamcommunity-a.akamaihd.net/public/images/header/globalheader_logo.png";try{d=/https?:\/\/steamcommunity\.com\/sharedfiles\/filedetails\/?\?id=(\d+)/i.exec(f.attr("href"))[1]}catch(g){}}return{appid:d,name:c,image:e,colSpan:1}},toHTML:function(a){var b=this,c=$('<div class="steam-extended-user-profile-container col-2 collapsed"></div>'),d=a.image?a.image:"http://cdn.akamai.steamstatic.com/steam/apps/"+a.appid+"/capsule_184x69.jpg",e=a.image&&"http://steamcommunity-a.akamaihd.net/public/images/header/globalheader_logo.png"==a.image?"padding: 14px 0;height:44px;":"",f=$('<img class="steam-extended-user-profile-capsule" style="'+e+'" src="'+d+'" />'),g=$('<div class="steam-extended-user-profile-text">'+a.name+"</div>"),h=$('<div class="steam-extended-user-profile-title"><div style="position: absolute;top:-3px;font-size:13.5px;line-height:12px;">FAVORITE</div><div style="position: absolute;top:5px;font-size:22px;line-height:20px;transform:scaleY(0.7);">GAME</div></div>');return c.append(f,g,h),c}},D.showcase.favoritegroup_showcase={displayName:"Favorite Group",colSpan:1,get:function(a,b){var c,d,e,f,g,h,i,j,k,l=$(".favoritegroup_avatar a",a);if(e=l.attr("href"))try{d=/steamcommunity\.com\/groups\/([^\/\?\#]+)(?:\/|\?|\#|$)/gi.exec(e)[1]}catch(m){}var n=$("img",l);f=n.attr("src");var o=$(".favoritegroup_content",a);c=$(".favoritegroup_name",o).text().toString().trim();var p=$(".favoritegroup_stats .showcase_stat",o),q=/members/i,r=/online/i,s=/in(?:\-?|\s+)game/i,t=/in(?:\-?|\s+)chat/i;p.each(function(){var a=$(this),b=a.children(".value"),c=a.children(".lable"),d=b.text().toString().trim(),e=c.text().toString().trim();t.test(e)?k=d:s.test(e)?i=d:r.test(e)?j=d:q.test(e)&&(h=d)});var u=$(".favoritegroup_description",o);g=u.text().toString().trim();var v={name:c,urlname:d,link:e,avatar:f,description:g,members:h,in_game:i,in_chat:k,online:j,colSpan:1};return new wikiMod.Promise(function(a,b){return v.name?void steamAPI.getGroupMembersList(v.urlname).then(function(b){v.data=b,a(v)},function(b){console.log("groupData error",b),a(v)}):b(v)})},toHTML:function(a){var b=this,c=a.data,d=$('<div class="steam-extended-user-profile-container col-2 collapsed"></div>'),e=c&&c.avatarMedium?c.avatarMedium:a.avatar,f='font-family: "Motiva Sans Thin",Arial,Helvetica,Verdana,sans-serif;',g="",h=$('<img class="steam-extended-user-profile-icon" style="'+g+'" src="'+e+'" />'),i=$('<div class="steam-extended-user-profile-text" style="font-size:14px;margin-top:-5px;max-width:350px;"><span style="max-height:16px;overflow-y:hidden;">'+a.name+"</span></div>"),j=$("<div></div>"),k="height:40px;line-height:40px;float:left;text-align:center;",l="font-size:22px;line-height:24px;font-weight: bold;"+f,m="font-size:14px;line-height:12px;"+f,n=$('<div style="'+k+'padding-left:20px;"><div style="'+l+'">'+(c&&c.memberCount?c.memberCount:a.members)+'</div><div style="'+m+'">Members</div></div>'),o=$('<div style="'+k+'padding-left:20px;"><div style="'+l+'">'+(c&&c.membersOnline?c.membersOnline:a.online)+'</div><div style="'+m+'">Online</div></div>'),p=$('<div style="'+k+'padding-left:20px;"><div style="'+l+'">'+(c&&c.membersInGame?c.membersInGame:a.in_game)+'</div><div style="'+m+'">In-Game</div></div>'),q=$('<div style="'+k+'padding-left:20px;"><div style="'+l+'">'+(c&&c.membersInChat?c.membersInChat:a.in_chat)+'</div><div style="'+m+'">In Chat</div></div>');j.append(n,o,p,q),i.append(j);var r=$('<div class="steam-extended-user-profile-title"><div style="position: absolute;top:-3px;font-size:13.5px;line-height:12px;">FAVORITE</div><div style="position: absolute;top:5px;font-size:18px;line-height:20px;transform:scaleY(0.9);">GROUP</div></div>');return d.append(h,i,r),d}},D.recentGame={displayName:"Recent Game",colSpan:1,get:function(a){var b=$(".profile_leftcol .recent_games .recent_game",a);if(b&&b.length>0){var c=$(b.get(0)),d=$(".game_info",c),e=$(".game_name a",d),f=$(".game_info_details",d),g=e.text().toString().trim(),h=f.text().toString().trim(),i,j;try{i=/last\s*played\s*on\s*(\w+\s+\d+)/i.exec(h)[1]}catch(k){}var l=$(".game_info_cap a",d);try{j=/steamcommunity\.com\/app\/(\d+)(?:\/|\?|\#|$)/i.exec(l.attr("href"))[1]}catch(k){}var m={appid:j,appName:g,last_played:i,colSpan:1};return m}return null},toHTML:function(a){var b=$('<div class="steam-extended-user-profile-container col-2 collapsed"></div>'),c=$('<img class="steam-extended-user-profile-capsule" src="http://cdn.akamai.steamstatic.com/steam/apps/'+a.appid+'/capsule_184x69.jpg" />'),d=$('<div class="steam-extended-user-profile-text">'+a.appName+"</div>"),e=$('<div style="position: absolute; height: 69px;"><div style="font-size: 13px; opacity: 0.6; width: 195px; position: absolute; left: 190px; bottom: 0px;">'+a.last_played+"</div></div>"),f=$('<div class="steam-extended-user-profile-title"><div style="position: absolute;top:-2px;font-size:12.5px;line-height:12px;">RECENTLY</div><div style="position: absolute;top:8px;font-size:17px;line-height:16px;">PLAYED</div></div>');return b.append(c,d,e,f),b}},D.summary={displayName:"Summary",colSpan:2,get:function(a){var b=$(".profile_summary",a);return b&&b.length>0?{$summary:b.clone(),colSpan:2}:null},toHTML:function(a){var b=this,c=$('<div class="steam-extended-user-profile-container collapsed" style="height:auto;max-height:300px;"></div>'),d=$('<div class="steam-extended-user-profile-title"><div style="position: absolute;top:-2px;font-size:16px;line-height:13px;">PROFILE</div><div style="position: absolute;top:12px;font-size:12.8px;line-height:10px;">SUMMARY</div></div>');return c.append(d,a.$summary),c}},a.prototype.removeThrobber=function(){var a=this;return a.throbberRemoved?wikiMod.Promise.resolve(!0):a.working.removeThrobber?a.working.removeThrobber:(a.working.removeThrobber=new wikiMod.Promise(function(b,c){a.show().then(function(){setTimeout(function(){a.$mainThrobber.addClass("fadeOut"),setTimeout(function(){a.$mainThrobber.css("display","none"),a.throbberRemoved=!0,a.boxResizeAndReposition()},1e3),a.boxResizeAndReposition()},250)})}).then(function(){},function(){}),a.working.removeThrobber)},!function(){function b(a){var b=a.__resizeTriggers__,c=b.firstElementChild,d=b.lastElementChild,e=c.firstElementChild;d.scrollLeft=d.scrollWidth,d.scrollTop=d.scrollHeight,e.style.width=c.offsetWidth+1+"px",e.style.height=c.offsetHeight+1+"px",c.scrollLeft=c.scrollWidth,c.scrollTop=c.scrollHeight}function c(a){var b=$(a),c=[];return(a.offsetWidth!=a.__resizeLast__.width||b.width()!=a.__resizeLast__.$width)&&c.push("width"),(a.offsetHeight!=a.__resizeLast__.height||b.height()!=a.__resizeLast__.$height)&&c.push("height"),c}function d(a){var d=this,e=$(this);b(this),this.__resizeRAF__&&wikiMod.cancelAnimationFrame(this.__resizeRAF__),this.__resizeRAF__=wikiMod.requestAnimationFrame(function(){var b=c(d);b&&b.length>0&&(d.__resizeLast__.width=d.offsetWidth,d.__resizeLast__.height=d.offsetHeight,d.__resizeLast__.$width=e.width(),d.__resizeLast__.$height=e.height(),d.__resizeListeners__.forEach(function(c){c.call(d,a,b)}))})}function e(){if(!f){var a=(o?o:"")+".resize-triggers { "+(p?p:"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }';wikiMod.addCSS(a),f=!0}}var f=!1,g=!1,h="animation",i="",j="animationstart",k="Webkit Moz O ms".split(" "),l="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),m="",n="steam-resizeanim",o,p,q=document.createElement("fakeelement");if(void 0!==q.style.animationName&&(g=!0),g===!1)for(var r=0;r<k.length;r++)if(void 0!==q.style[k[r]+"AnimationName"]){m=k[r],h=m+"Animation",i="-"+m.toLowerCase()+"-",j=l[r],g=!0;break}o="@"+i+"keyframes "+n+" { from { opacity: 0; } to { opacity: 0; } } ",p=i+"animation: 1ms "+n+"; ",a._addResizeListener=function(a,c){a.__resizeTriggers__||("static"==wikiMod.getComputedStyle(a).position&&(a.style.position="relative"),e(),a.__resizeLast__={},a.__resizeListeners__=[],(a.__resizeTriggers__=document.createElement("div")).className="resize-triggers",a.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',a.appendChild(a.__resizeTriggers__),b(a),a.addEventListener("scroll",d,!0),j&&a.__resizeTriggers__.addEventListener(j,function(c){c.animationName==n&&b(a)})),a.__resizeListeners__.push(c)},a._removeResizeListener=function(a,b){a.__resizeListeners__.splice(a.__resizeListeners__.indexOf(b),1),a.__resizeListeners__.length||(a.removeEventListener("scroll",d),a.__resizeTriggers__=!a.removeChild(a.__resizeTriggers__))},a.prototype.addResizeListener=function(b){var c=this;a._addResizeListener(c.$target.get(0),b)}}(),a.prototype.setProfileBackground=function(a){var b=this;return b.working.setProfileBackground?b.working.setProfileBackground:(b.working.setProfileBackground=new wikiMod.Promise(function(c,d){var e=function(a){if(b.options.showBackground){var c=b.$steamProfileBackgroundContainer.children("div");if(c&&c.length>0)c.addClass("exfast fadeOut").removeClass("fadeIn"),b.$steamProfileBackgroundContainer.addClass("exfast fadeOut").removeClass("fadeIn"),setTimeout(function(){c.css("background-image","url('"+a+"')"),setTimeout(function(){b.$steamProfileBackgroundContainer.addClass("fadeIn")},200),setTimeout(function(){c.addClass("fadeIn")},250)},200);else{b.$target.addClass("steam-profile-background");var c=$('<div class="animated" style="z-index:9;background-image: url(\''+a+"');\"></div>");b.$steamProfileBackgroundContainer.append(c),setTimeout(function(){c.addClass("fadeIn"),setTimeout(function(){b.$target.css({background:"transparent linear-gradient(to bottom, transparent 0%, black 100%) repeat scroll 0 0"})},550)},75)}}};setTimeout(function(){a?e(a):b.profileBackgroundURL?e(b.profileBackgroundURL):b.getProfileBackground().then(function(a){try{return e(a)}catch(c){return b.working.setProfileBackground=null,d(c)}})["catch"](function(a){b.working.setProfileBackground=null,d(a)})},0)}),b.working.setProfileBackground)},a.prototype.show=function(){var a=this;return a.isShown?wikiMod.Promise.resolve(!0):a.working.show?a.working.show:(a.working.show=new wikiMod.Promise(function(b,c){a.$targetMirrorPlaceholder.hasClass("show")||(a.$targetMirrorPlaceholder.addClass("show"),setTimeout(function(){a.$targetMirrorPlaceholder.removeClass("init")},100)),a.$steamUserInfoBox.hasClass("fadeIn")||a.$steamUserInfoBox.addClass("fadeIn"),a.boxResizeAndReposition(),setTimeout(function(){a.$steamExtendedUserProfile&&a.$steamExtendedUserProfile.length>0&&(a.$steamExtendedUserProfile.addClass("fadeInDown"),setTimeout(function(){a.$steamExtendedUserProfile.css("display","block"),a.boxResizeAndReposition()},15)),a.isShown=!0,a.working.show=null,b(!0)},400)}).then(function(){},function(){}),a.working.show)};var E='<span class="checkmark"><div class="checkmark_stem"></div><div class="checkmark_kick"></div></span>',F='<span class="checkmark checked"><div class="checkmark_stem"></div><div class="checkmark_kick"></div></span>',G='<span class="cross"><div class="cross_vert"></div><div class="cross_hor"></div></span>',H='<span class="cross checked"><div class="cross_vert"></div><div class="cross_hor"></div></span>';a.prototype.statusInit=function(a,b){var c=this;c._status={},c.status=function(a,b){var d=arguments.length;return d>=2?c.status.get.apply(c,arguments):1==d?c.status.get(a):c._status}.bind(c),c.status.get=function(a){return a?a in c._status?c._status[a]:null:c._status}.bind(c),c.status.getHTML=function(a){if(!(arguments.length>0)){var b=$('<table class="steam-debug-status-table"><thead><tr><th>Name</th><th title="Complete">Comp</th><th title="Success">Pass</th><th title="Total time elapsed after instance creation">Total</th><th title="Time elapsed after initBox() was call">InitBox</th><th>Message</th></tr></thead></table>'),d=$("<tbody></tbody>");b.append(d);for(var e in c._status){var f=c.status.getHTML(e);f&&f.length&&d.append(f)}return b}if(a&&a in c._status){var g=c._status[a];if(g&&"status"in g){var h=(new Date).getTime(),i=("boolean"==typeof g.success&&g.time?g.time:h)-c._StartTime,j=("boolean"==typeof g.success&&g.time?g.time:h)-c._InitBoxTime;0>j&&(j="("+j+")");var k=g.complete===!0?F:G,l=g.success===!0?F:g.success===!1?H:G,m=g.status?g.status.toString():g.err?g.err.toString():"N/A",n=$("<tr></tr>");return n.append('<td class="status-name"'+(g.description?' title="'+g.description+'"':"")+">"+a+"</td>",'<td class="status-complete">'+k+"</td>",'<td class="status-success">'+l+"</td>",'<td class="status-elapsed">'+i+" ms</td>",'<td class="status-elapsed">'+j+" ms</td>",'<td class="status-message">'+m+"</td>"),n}}return null}.bind(c),c.status.create=function(a,b){var d=arguments.length;if(c._status[a])return c.status;c._status[a]=c._status[a]||{time:null,success:null,complete:null,err:null};var e=c._status[a];return b.description&&(e.description=b.description),b.progressMax||b.max?(e.max=parseInt(b.progressMax||b.max),e.progress=b.progress||0,Object.defineProperty(c._status[a],"status",{enumerable:!0,configurable:!1,get:function(){return e.err?e.err.message+" || Line: "+(e.err.lineNumber||"-1"):(e.progress>=e.max?"Complete! ":"")+e.progress+"/"+e.max+("string"==typeof e.statusMessage?" "+e.statusMessage:"")},set:function(a){isNaN(a)?"string"==typeof a&&(e.statusMessage=a):(e.progress=parseInt(a),e.progress>=e.max&&(e.max=e.progress,e.complete=!0,e.success!==!1&&(e.success=!0)))}})):e.status=null,c.status}.bind(c),c.status.progress=function(a,b){var d=c._status[a];return d&&"progress"in d&&!isNaN(b)&&(d.status=b,d.time=(new Date).getTime()),c.status}.bind(c),c.status.complete=function(a,b){var d=c._status[a];return d&&!d.complete&&(d.complete=!0,"boolean"==typeof b&&(d.success=b),d.time=(new Date).getTime()),c.status}.bind(c),c.status.inc=function(a){var b=c._status[a];return b&&"number"==typeof b.progress&&(b.status=b.progress+1,b.time=(new Date).getTime()),c.status}.bind(c),c.status.max=function(a,b){var d=c._status[a];if(d&&"number"==typeof d.progress){var e=d.progress;d.max=parseInt(b),d.max>e&&d.complete?(d.complete=null,d.time=(new Date).getTime()):d.max<e&&d.max<=d.progress&&(d.complete=!0,d.time=(new Date).getTime())}return c.status}.bind(c),c.status.set=function(a,b,d){var e=arguments.length;a in c._status||(c._status[a]={time:null,status:null,success:null,complete:null,err:null});var f=c._status[a],g=function(a){a=a||(new Date).getTime(),f.time=a};return"boolean"==typeof d&&(f.success=d),b instanceof Error?(f.err=b,f.success="boolean"==typeof d?d:!1,b.message&&("undefined"!=typeof status.max?f.status=b:f.status=b.message+" || line: "+(b.lineNumber||"-1")),g()):"string"==typeof b?(f.status=b,g()):null===b||"object"==typeof b&&("boolean"==typeof b.success&&(f.success=b.success),b.progress&&!isNaN(b.progress)&&"progress"in f?(f.status=b.progress,(b.status||b.statusMessage||b.message)&&(f.statusMessage=b.status||b.statusMessage||b.message)):(b.statusMessage||b.message)&&"statusMessage"in f?(b.status&&(f.status=b.status),f.statusMessage=b.statusMessage||b.message):(b.status||b.statusMessage||b.message)&&(f.status=b.status||b.statusMessage||b.message),b.err&&(f.err=b.err),f.complete=b.complete,g(b.time)),c.status}.bind(c)},a.prototype.refreshStatusPopup=function(a){var b=this,c=$(".steam-user-infobtn",b.$steamUserInfoCol3),d=$("<div></div>"),e=!1,f={id:!1,summary:!1,profileInfo:!1,games:!1},g=function(g,h){if(f[g]=h||"",!e){for(var i in f)if(f[i]===!1)return;var j=$('<table class="steam-debug-table"></table>'),k=$("<tbody></tbody>");j.append(k);var m=2,n,o=0;for(var i in f)n||(n=$("<tr></tr>"),k.append(n)),n.append($('<td class="steam-debug-section"></td>').append(f[i])),o++,o>=m&&(n=null,o=0);var p=b.status.getHTML();if(p&&p.length){var q=$("<tr></tr>");q.append($('<td colspan="'+m+'"></td>').append('<h3 class="steam-debug-table-title" style="margin-top:5px;">Performance</h3>',p)),k.append(q)}else console.log("$statusHTML",p);d.append(j);var r=$('<a href="#">Clear Cache</a>'),s=$('<a href="#">Clear localStorage</a>'),t=$('<a href="#">Refresh</a>'),u=$('<div style="height:9px;line-height:9px;font-size:9px;margin-top:5px;width:100%;"></div>');u.append($('<div style="position:absolute;width:100%;text-align:center;"></div>').append($("<div></div>").append(t)),$('<div style="float:left;padding-left:5px;opacity:0.7;"></div>').append(r),$('<div style="float:right;text-align:right;padding-right:5px;opacity:0.7;"></div>').append(s)),r.click(function(a){if(r.hasClass("disabled"))return wikiMod.eventCancel(a),!1;r.addClass("disabled").css({cursor:"default",opacity:.3,"text-decoration":"none"});try{steamAPI.steamIdCache.clear(),steamAPI.steamGameStaticCache.clear(),steamAPI.steamUserInfoCache.clear(),steamAPI.steamUserSummaryCache.clear(),steamAPI.steamUserOwnedGamesCache.clear(),steamAPI.steamGameSchemaCache.clear(),steamAPI.steamUserGameInfoCache.clear(),steamAPI.steamUserAchievementsCache.clear(),steamAPI.steamUserGameTimeCache.clear(),steamAPI.steamAllUserGameStatsCache.clear(),steamAPI.steamUserBadgeCache.clear(),steamAPI.steamUserBadgeInfoCache.clear(),steamAPI.steamUserTopBadgesCache.clear(),r.text("Cache Cleared")}catch(a){r.text("Cache Clear Err")}return wikiMod.eventCancel(a),!1}),s.click(function(a){if(s.hasClass("disabled"))return wikiMod.eventCancel(a),!1;s.addClass("disabled").css({cursor:"default",opacity:.3,"text-decoration":"none"}),s.text("localStorage Cleared");try{console.log((l.localStorage||window.localStorage).clear())}catch(a){console.log("clearLocalStorage error",a)}return wikiMod.eventCancel(a),!1}),t.click(function(a){return t.hasClass("disabled")?(wikiMod.eventCancel(a),!1):(t.addClass("disabled"),setTimeout(function(){b.refreshStatusPopup()},0),wikiMod.eventCancel(a),!1)}),d.append(u),e=!0,b.$DebugInfoPopup?(b.$DebugInfoPopup.empty(),b.$DebugInfoPopup.append(d)):b.$DebugInfoPopup=J.make(c,{content:d,position:"left-center",offsets:{left:-10},delay:500,maxWidth:"700px",stickey:"click"}),a&&setTimeout(function(){c.trigger("click")},0)}},h=function(a){var c='<h3 class="steam-debug-table-title">ID Data</h3><table class="steam-debug-section-table"><tbody><tr><td>Username</td><td class="no-break">'+b.username+'</td></tr><tr><td>Steam64ID</td><td class="no-break">'+a.steamID64+'</td></tr><tr><td>Steam32ID</td><td class="no-break">'+a.steamID32+'</td></tr><tr><td>SteamID3</td><td class="no-break">'+a.steamID3+'</td></tr><tr><td>SteamID</td><td class="no-break">'+a._steamID+"</td></tr></tbody></table>";g("id",c)},i=function(a){var b="Denied",c="commentpermission"in a?a.commentpermission:0;c&&(b="Allowed");var d,e=a.communityvisibilitystate;if(isNaN(e))e="?",d="Unknown";else try{d=A[e.toString()].display}catch(f){d=d||"Unknown"}var h,i=a.personastate;if(isNaN(i))i="?",h="Unknown";else if(0==i&&1==a.communityvisibilitystate)h="Offline (Private)";else try{h=z[i.toString()].text}catch(f){h="Unknown"}var j=a.gameid&&a.gameextrainfo?"True ("+a.gameextrainfo+")":"False",k="primaryclanid"in a?a.primaryclanid:"N/A",l='<h3 class="steam-debug-table-title">Summary Data</h3><table class="steam-debug-section-table"><tbody><tr><td>visibilitystate</td><td class="no-break">'+e+": "+d+'</td></tr><tr><td>personastate</td><td class="no-break">'+i+": "+h+'</td></tr><tr><td>commentpermission</td><td class="no-break">'+c+": "+b+'</td></tr><tr><td>primaryclanid</td><td class="no-break">'+k+'</td></tr><tr><td>User In-Game</td><td class="no-break">'+j+"</td></tr></tbody></table>";g("summary",l)},j=function(a){var b=a.customURL||"Unknown",c=a.onlineState||"Unknown",d=a.stateMessage||"Unknown",e=a.privacyState||"Unknown",f="visibilityState"in a?a.visibilityState:"Unknown",h="isLimitedAccount"in a?a.isLimitedAccount:"Unknown",i="vacBanned"in a?a.vacBanned:"N/A",j="tradeBanState"in a?a.tradeBanState:"N/A",k="memberSince"in a?a.memberSince:"N/A",l='<h3 class="steam-debug-table-title">Profile XML</h3><table class="steam-debug-section-table"><tbody><tr><td>customURL</td><td class="no-break">'+b+'</td></tr><tr><td>Member Since</td><td class="no-break">'+k+'</td></tr><tr><td>onlineState</td><td class="no-break">'+c+'</td></tr><tr><td>stateMessage</td><td class="no-break">'+d+'</td></tr><tr><td>privacyState</td><td class="no-break">'+e+'</td></tr><tr><td>visibilityState</td><td class="no-break">'+f+'</td></tr><tr><td>isLimitedAccount</td><td class="no-break">'+h+'</td></tr><tr><td>vacBanned</td><td class="no-break">'+i+'</td></tr><tr><td>tradeBanState</td><td class="no-break">'+j+"</td></tr></tbody></table>";g("profileInfo",l)},k=function(a){for(var c=0,d=0,e=[],f=0;f<b.games.length;f++){var h=a[b.games[f].appid.toString()];if(h){var i=h.playtime_forever;(isNaN(i)||-1==parseInt(i))&&(i="N/A"),e.push({appid:b.games[f].appid.toString(),title:b.games[f].name||"N/A",playTimeForever:i}),c++}else e.push({appid:b.games[f].appid.toString(),missing:!0}),d++}for(var j=function(a){var b='<tr><td style="vertical-align: top;">'+a.appid+"</td><td>";return a.missing?b+='<span class="no-break"><i>App Not Found</i></span>':(b+='<div class="no-break">'+a.title+"</div>",b+='<div class="no-break" style="font-size:9px;">Time: '+a.playTimeForever+"</div>"),b+="</td></tr>"},k='<h3 class="steam-debug-table-title">Games</h3><table class="steam-debug-section-table"><tbody>',f=0;f<e.length;f++)k+=j(e[f]);k+="</tbody></table>",g("games",k)};steamAPI.getUserSteamIDs(b.username).then(function(a){h(a)},function(a){console.log("err",a),h({})}),b.getProfileSummary().then(function(a){i(a)},function(a){i({})}),b.getProfileInfo().then(function(a){j(a)},function(a){j({})}),b.getUserGameStats().then(function(a){k(a)},function(a){k({})})},a.prototype.updateAchievementDetails=function(a,b){var c=this,d=!1,e,f,g,h,i,j,k,l,m;return a.$achievement?(d=!0,e=a.$achievement,a.appid&&(f=a.appid.toString()),a.name&&(g=a.name)):e=$(a),f||(f=e.attr("data-achievement-appid")),g||(g=e.attr("data-achievement-name")),c.working.updateAchievementDetails?c.working.updateAchievementDetails.appid==f&&c.working.updateAchievementDetails.achievementName==g||b?c.working.updateAchievementDetails:new wikiMod.Promise(function(b,d){c.working.updateAchievementDetails.then(function(){c.working.updateAchievementDetails=null,c.updateAchievementDetails(a,1).then(function(){b()})["catch"](function(a){d(a)})})["catch"](function(a){c.working.updateAchievementDetails=null,d(a)})}):(h=e.attr("data-achievement-display-name"),i=e.attr("data-achievement-achieved"),j=e.attr("data-achievement-description"),k=e.children("img"),l=k.attr("src"),m=k.hasClass("desaturate"),c.working.updateAchievementDetails=new wikiMod.Promise(function(a,b){var d=c.achievementsHorizontalScroll.$flipperBack.children(".steam-achievement-details-wrapper"),e,k;return d&&d.length>0&&(e=d.attr("data-achievement-appid"),k=d.attr("data-achievement-name"),e==f&&k==g)?(c.working.updateAchievementDetails=null,a()):(J.destroyAllPopups(c.achievementsHorizontalScroll.$flipperBack),c.achievementsHorizontalScroll.$flipperBack.html('<div class="wikiaThrobber" style="background-color:transparent;"></div>'),void setTimeout(function(){try{c.working.updateAchievementDetails.appid=f,c.working.updateAchievementDetails.achievementName=g}catch(d){}steamAPI.getGlobalAchievementPercentages(f).then(function(d){for(var e=0;e<d.achievements.length;e++)if(d.achievements[e].name==g){var k=parseInt(100*parseFloat(d.achievements[e].percent))/100,n=$('<div class="steam-achievement-details-wrapper" data-achievement-appid="'+f+'" data-achievement-name="'+g+'"><div class="steam-achievement-details-title"><span>'+(h||g)+'</span></div><div class="steam-achievement-details-left"><img class="'+(m?"desaturate":"")+'" src="'+l+'" /></div><div class="steam-achievement-details-right"><div style="position:absolute;"><span class="steam-achievement-details-achieved-title">Achieved:</span> <span class="steam-achievement-details-achieved-value">'+("1"==i?"Yes":"No")+'</span></div><div class="steam-achievement-details-description">'+(j?j:"Hidden Achievement")+'</div></div><div class="steam-achievement-details-global" style="clear:both;padding-top:5px;padding-left: 2px;"><span class="steam-achievement-details-global-title">Global:</span> <span class="steam-achievement-details-global-percent">'+k+'%</span></div><div class="steam-progress-bar-wrap"><div class="steam-progress-bar" style="width:'+parseInt(k)+'%"></div></div><div class="steam-achievement-details-global-players"><div class="wikiaThrobber" style=""></div><span style="opacity:0;"></span></div></div>'),o=n.find(".steam-achievement-details-global"),p=n.find(".steam-achievement-details-global-players"),q=n.find(".steam-achievement-details-global-percent");return c.achievementsHorizontalScroll.$flipperBack.html(n),steamAPI.getSpyStats(f).then(function(a){var b=function(a){var b=a.toString().split(".");return b[0]=b[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),b.join(".")},c=p.children(".wikiaThrobber"),f=p.children("span"),g=a.players_forever,h=a.players_forever_variance,i,j="",k=parseInt(parseFloat(d.achievements[e].percent)/100*parseFloat(g));h&&(i=parseInt(parseFloat(d.achievements[e].percent)/100*parseFloat(h)),j=" &#177; "+b(i.toString())),f.html("<b>"+b(k.toString())+"</b>"+j+" players out of <b>"+b(g.toString())+"</b> &#177; "+b(h.toString())),wikiMod.requestAnimationFrame(function(){f.css("opacity","1"),c.css("opacity","0"),J.make(p,{content:'<span style="cursor:default;font-size:9px;">Data provided by Steam Spy</span>',position:"top",offsets:{}})})})["catch"](function(a){p.html("Error loading global player stats")}),J.make(q,{content:'<span style="cursor:default;">Percent of users with this achievement</span>',position:"top",offsets:{top:5}}),c.working.updateAchievementDetails=null,a()}c.working.updateAchievementDetails=null,b("error achievement not found")})["catch"](function(a){console.log("error",a),c.achievementsHorizontalScroll.$flipperBack.html("error"),c.working.updateAchievementDetails=null,b(a)})},0))}),c.working.updateAchievementDetails)},a.prototype.updateGameInfo=function(b,c){var d=this,e=b.$gameEl,f=b.appid;return d.working.updateGameInfo?(c&&d.working.updateGameInfo.next||(d.working.updateGameInfo.next=b),d.working.updateGameInfo):(d.working.updateGameInfo=new wikiMod.Promise(function(b,c){var f=function(a,e){var f=d.working.updateGameInfo.next;return d.working.updateGameInfo=null,f&&wikiMod.setAsap(function(){try{d.updateGameInfo(f,1).then(function(){},function(){})}catch(a){}}),e===!1?c(a):void b(a)};wikiMod.setAsap(function(){var b=d.$steamUserInfoCol2,c='<div class="wikiaThrobber animated" style="background-color:transparent;"></div>';if(d.achievementsHorizontalScroll)J.destroyAllPopups(d.achievementsHorizontalScroll.$flipperBack),J.destroyAllPopups(d.achievementsHorizontalScroll.$flipperFront),d.achievementsHorizontalScroll.removeAllPages(),d.achievementsHorizontalScroll.addPage(c,"steam-game-achievements-page"),d.achievementsHorizontalScroll.showFront();else{d.achievementsHorizontalScroll=new a.horizontalScrollPanel({page:c,singlePageScroll:{getRightElement:function(a){var b=a.children(".steam-achievement-container").children().slice(-6),c,d=-1e4;return b.each(function(){var a=$(this),b=a.position();parseInt(b.left)>d&&(d=b.left,c=a)}),c}},flipper:{onBackClicked:function(a,b){d.achievementsHorizontalScroll.showFront(),J.hideAllPopups();var c=d.achievementsHorizontalScroll.$flipperFront.children(".steam-row-wrap");setTimeout(function(){c.css("max-height",""),setTimeout(function(){wikiMod.requestAnimationFrame(function(){c.css("max-height","161px")})},100)},10)}},className:"game-info-extended"}),d.achievementsHorizontalScroll.getPage(0).addClass("steam-game-achievements-page");var g=$('<div class="close-btn"> </div>');g.click(function(){b.attr("data-page","0")});var h=$('<div class="more-btn"> </div>');
h.click(function(){h.hasClass("disabled")||b.attr("data-page","2")}),d.achievementsHorizontalScroll.$steamUserGameInfo.append(g,h),b.append(d.achievementsHorizontalScroll.$el)}d.achievementsHorizontalScroll.$el.attr("data-appid",e.attr("data-steam-game-appid"));var i=e.attr("data-steam-game-appid").toString();steamAPI.getGameSchema(i).then(function(c){steamAPI.getUserGameAchievements(d.username,i).then(function(e){for(var g=c.availableGameStats.achievements.length,h=c.availableGameStats.stats?!0:!1,j=[],k=0;k<e.achievements.length;k++)e.achievements[k].achieved&&j.push(e.achievements[k].apiname);for(var l=j.length,m='<div style="margin-top:3px;margin-bottom:5px;"><div style="height:12px;line-height:12px;width:100%;cursor:default;margin-bottom:2px;"><span styla="float:left;">Achievement Progress</span><span style="float:right;">'+l+" of "+g+'</span></div><div class="steam-progress-bar-wrap"><div class="steam-progress-bar" style="width:'+parseInt(parseFloat(l)/parseFloat(g)*100).toString()+'%;"></div></div></div>',n=[],o=[],p=function(a,b){var c="http://cdn.akamai.steamstatic.com/steamcommunity/public/images/avatars/de/de7c82107ecd84cc29b80497531ab7703c9703e3.jpg",d="",e=/\.(?:jpg|jpeg|png|gif)$/i;return b?e.test(a.icon)&&(c=a.icon):e.test(a.icongray)?c=a.icongray:e.test(a.icon)&&(c=a.icon,d="desaturate"),$('<div class="steam-achievement-small animated fast" data-achievement-achieved="'+(b?"1":"0")+'" data-achievement-appid="'+i+'" data-achievement-name="'+a.name+'" data-achievement-display-name="'+a.displayName+'" data-achievement-description="'+(a.description||"")+'"><img class="'+d+'" style="width:40px;height:40px;" src="'+c+'" /></div>')},q=0;q<c.availableGameStats.achievements.length;q++)j.indexOf(c.availableGameStats.achievements[q].name)>-1?n.push(p(c.availableGameStats.achievements[q],!0)):o.push(p(c.availableGameStats.achievements[q],!1));var r=d.achievementsHorizontalScroll.getPage(0);r.html("");var s=$('<div class="steam-achievement-container" style="max-height:161px;"></div>');setTimeout(function(){s.css("max-height",""),setTimeout(function(){wikiMod.requestAnimationFrame(function(){s.css("max-height","161px")})},50)},50),r.append(m),r.append(s);var t=function(a){d.updateAchievementDetails({$achievement:a}).then(function(){}),d.achievementsHorizontalScroll.showBack(),J.hideAllPopups()},u=[],v=function(a,b){s.append(a);var c=function(){25>=b?setTimeout(function(){a.addClass("fadeInPartial"),setTimeout(function(){a.addClass("isShowing")},500),b>16&&wikiMod.requestAnimationFrame(function(){s.css("max-height",s.css("max-height"))})},100+45*b):(a.addClass("instant fadeInPartial"),setTimeout(function(){a.addClass("isShowing")},0)),J.make(a,{content:'<span style="cursor:default;">'+a.attr("data-achievement-display-name")+"</span>",position:"top",offsets:{top:0}}),a.click(function(){t($(this))})};u.push(c)},w=0,x;for(x=0;x<n.length;x++)v(n[x],w+0),w++;for(x=0;x<o.length;x++)v(o[x],w+0),w++;return setTimeout(function(){for(var a=0;a<u.length;a++)wikiMod.setAsap(u[a])},250),h?wikiMod.setAsap(function(){steamAPI.getUserStatsForGame(d.username,i).then(function(e){for(var f={},g=e.playerstats.stats,h=[],i=0;i<g.length;i++)f[g[i].name]=g[i].value;for(var i=0;i<c.availableGameStats.stats.length;i++){var j=c.availableGameStats.stats[i].defaultvalue,k=c.availableGameStats.stats[i].displayName||c.availableGameStats.stats[i].name;f[c.availableGameStats.stats[i].name]&&(j=f[c.availableGameStats.stats[i].name]),h.push('<div class="steam-game-stats-row"><div>'+k+"</div><div>"+j.toString()+"</div></div>")}if(d.statsHorizontalScroll)d.statsHorizontalScroll.removeAllPages(),d.statsHorizontalScroll.addPage(h.join(""),"steam-game-stats-page");else{d.statsHorizontalScroll=new a.horizontalScrollPanel({page:h.join(""),singlePageScroll:!0});var l=$('<div class="close-btn"> </div>');l.click(function(){b.attr("data-page","1")}),d.statsHorizontalScroll.$steamUserGameInfo.append(l)}for(var m=0;m<d.statsHorizontalScroll.pages.length;m++)$(d.statsHorizontalScroll.pages[m]).addClass("steam-game-stats-page");b.append(d.statsHorizontalScroll.$el),h.length>0?$(".more-btn",d.achievementsHorizontalScroll.$el).removeClass("disabled"):$(".more-btn",d.achievementsHorizontalScroll.$el).addClass("disabled")})["catch"](function(a){console.log("error",a)})}):$(".more-btn",d.achievementsHorizontalScroll.$el).addClass("disabled"),f(!0)})["catch"](function(a){return f(a,!1)})})["catch"](function(a){return f(a,!1)})})}),d.working.updateGameInfo)},a.prototype.userHasAchievement=function(a,b){var c=this,d=a.toString();if(c.working.userHasAchievement){if(c.working.userHasAchievement[d]&&c.working.userHasAchievement[d][b])return c.working.userHasAchievement[d][b]}else c.working.userHasAchievement={};return c.working.userHasAchievement[d]||(c.working.userHasAchievement[d]={}),c.working.userHasAchievement[d][b]=new wikiMod.Promise(function(e,f){c.getUserGameAchievements(a).then(function(g){return g&&g[a.toString()]?(c.working.userHasAchievement[d][b]=null,e(!g[b]||1!=g[b].achieved&&"1"!=g[b].achieved.toString()?!1:!0)):(c.working.userHasAchievement[d][b]=null,f(g))})["catch"](function(a){c.working.userHasAchievement[d][b]=null,f(a)})}),c.working.userHasAchievement[d][b]},a.prototype.validateUser=function(){var a=this,b="validateUser";return a.working[b]?a.working[b]:a._validationResults?a._validationResults.isValid?wikiMod.Promise.resolve(a._validationResults):wikiMod.Promise.reject(a._validationResults):(a.working[b]=new wikiMod.Promise(function(c,d){var e=!1,f=function(f,g){if(!e){if(e=!0,a.working[b]=null,g===!1)return d(f);c(f)}},g={invalidUsername:"Invalid Username",profileNotFound:"Profile Not Found",notPublic:"Profile Is Not Public",profileNotSetUp:"Profile Not Set Up"},h={isValid:!1,err:[]},i=function(){e||"boolean"==typeof a.userSteamIdIsValid&&"boolean"==typeof a.userSteamInfoIsValid&&"boolean"==typeof a.userSteamProfileIsValid&&(a.userSteamIdIsValid&&a.userSteamInfoIsValid&&a.userSteamProfileIsValid?h.isValid=!0:h.isValid=!1,a._validationResults=h,f(h,h.isValid===!0))},j=function(){return"boolean"==typeof a.userSteamProfileIsValid?wikiMod.Promise.resolve(a.userSteamProfileIsValid):new wikiMod.Promise(function(b,c){a.getProfileSummary().then(function(c){var d=[];-1==["5","4","3"].indexOf(parseInt(c.communityvisibilitystate).toString())&&(a.userSteamProfileIsValid=!1,-1==h.err.indexOf(g.notPublic)&&d.push(g.notPublic)),a.userSteamProfileIsValid!==!1&&(a.userSteamProfileIsValid=!0),b(a.userSteamProfileIsValid||(d.length?d:!1))},function(b){console.log("validate summary fail",b),a.userSteamProfileIsValid=!1,c("validate summary fail")})})},k=function(){return"boolean"==typeof a.userSteamInfoIsValid?wikiMod.Promise.resolve(a.userSteamInfoIsValid):new wikiMod.Promise(function(b,c){a.getProfileInfo().then(function(c){var d=[];["friendsfriendsonly","friendsonly","private"].indexOf((c.privacyState||"").toLowerCase())>-1&&(a.userSteamInfoIsValid=!1,-1==h.err.indexOf(g.notPublic)&&d.push(g.notPublic)),a.userSteamInfoIsValid!==!1&&(a.userSteamInfoIsValid=!0),b(a.userSteamInfoIsValid||(d.length?d:!1))},function(b){console.log("validate profile fail",b),a.userSteamInfoIsValid=!1,c(g.profileNotFound)})})},l=function(){return"boolean"==typeof a.userSteamIdIsValid?wikiMod.Promise.resolve(a.userSteamIdIsValid):new wikiMod.Promise(function(b,c){a.getSteamId64().then(function(c){a.userSteamIdIsValid=!0,b(!0)},function(b){console.log("validate id fail",b),a.userSteamIdIsValid=!1,c(g.invalidUsername)})})},m=function(a,b){if(b&&a===!0)return!0;if("object"==typeof a&&a.length)try{h.err.concat(a)}catch(c){}else a&&"string"==typeof a&&h.err.push(a);return!1};wikiMod.setAsap(function(){l().then(function(a){m(a,!0)?(k().then(function(a){m(a,!0),i()},function(a){m(a,!1),i()}),j().then(function(a){m(a,!0),i()},function(a){m(a,!1),i()})):(h.isValid=!1,f(h,!1))},function(a){m(a,!1),h.isValid=!1,f(h,!1)})})}),a.working[b])};var I=0,J={};J.popupData={},J.popupPositiobns=["top","top-left","top-center","left","left-top","left-center","right","right-top","right-center","bottom","bottom-left","bottom-center"],J.getPopupData=function(a){var b=typeof a;if("number"==b)return J.popupData["steamPopup_"+a];if("string"==b)return isNaN(a)?J.popupData[a]:J.popupData["steamPopup_"+a];var c=function(a,b){return a.attr("data-popup-id")?J.popupData[a.attr("data-popup-id")]:a.attr("id")&&/^steamPopup_/i.test(a.attr("id"))?J.popupData[a.attr("id")]:b?void 0:c(a.parent(),!0)};return"object"==typeof a&&a.originalEvent&&a.currentTarget?c($(a.currentTarget)):a instanceof $||(a.jquery||a.jQuery)&&typeof a.length!=n?c(a):wikiMod.isElement(a)?c($(a)):void 0},J.getPopupPosition=function(a){for(var b=$(a),c=0;c<J.popupPositiobns.length;c++)if(b.hasClass(J.popupPositiobns[c]))return J.popupPositiobns[c]},J.repositionPopup=function(a,b,c){var d=b.offset(),e=J.getPopupPosition(a),f={top:"",left:"",right:"",bottom:""},g=parseFloat(a.outerWidth()),h=parseFloat(b.outerWidth()),i=parseFloat(a.outerHeight()),j=parseFloat(b.outerHeight());switch(e){case"left-top":f.top=parseInt(d.top)+"px",f.right=parseInt(parseFloat($(window).width())-parseFloat(d.left))+"px";break;case"left":case"left-center":var k=(i-j)/2;f.top=parseInt(d.top)-k+"px",f.right=parseInt(parseFloat($(window).width())-parseFloat(d.left))+"px";break;case"right":case"right-center":var k=(i-j)/2;f.top=parseInt(d.top)-k+"px",f.left=parseInt(parseFloat(d.left)+parseFloat(b.outerWidth()))+"px";break;case"right-top":f.top=parseInt(d.top)+"px",f.left=parseInt(parseFloat(d.left)+parseFloat(b.outerWidth()))+"px";break;case"bottom-left":f.top=parseInt(parseFloat(d.top)+parseFloat(b.height()))+"px",f.left=parseInt(d.left)+"px";break;case"bottom":case"bottom-center":var l=(g-h)/2;f.top=parseInt(parseFloat(d.top)+parseFloat(b.height()))+"px",f.left=parseInt(parseFloat(d.left)-l)+"px";break;case"top-left":f.top=parseInt(parseFloat(d.top)-parseFloat(a.outerHeight())-5)+"px",f.left=parseInt(d.left)+"px";break;case"top":case"top-center":default:var l=(g-h)/2;f.top=parseInt(parseFloat(d.top)-parseFloat(a.outerHeight())-5)+"px",f.left=parseInt(parseFloat(d.left)-l)+"px"}a.css(f)},J.showPopup=function(a,b){b=b||J.getPopupData(a)||{};var c=$(wikiMod.isElement(a)?a:this),d=c.attr("data-popup-id"),e=$("#"+d);$(".steam-popup").not(e).not('[data-stuck="true"]').addClass("hidden").removeClass("visible"),e&&e.length>0&&("function"==typeof b.onBeforeShow&&b.onBeforeShow.call(a,e,c,b),J.repositionPopup(e,c,b),e.removeClass("hidden").addClass("visible"))},J.hidePopup=function(a,b){b=b||J.getPopupData(a)||{};var c=$(wikiMod.isElement(a)?a:this),d=c.attr("data-popup-id"),e=$("#"+d);e&&e.length>0&&(b&&"function"==typeof b.onBeforeHide&&b.onBeforeHide.call(a,e,c,b),e.addClass("hidden").removeClass("visible"))},J.hideAllPopups=function(){$("#steam-popup-container > .steam-popup.visible").not('[data-stuck="true"]').addClass("hidden").removeClass("visible")},J.make=function(a,b){if(a&&a.length){var c=$("#steam-popup-container");if(!c||0==c.length){$("body").append('<div id="steam-popup-container"></div>');var c=$("#steam-popup-container")}b.popupNum=parseInt(I.toString()),a.attr("data-popup-id","steamPopup_"+b.popupNum),b.position&&-1!=J.popupPositiobns.indexOf(b.position.toLowerCase())||(b.position="right");var d="";(b["min-width"]||b.minWidth)&&(d+="min-width: "+(b["min-width"]||b.minWidth)+";"),(b["max-width"]||b.maxWidth)&&(d+="max-width: "+(b["max-width"]||b.maxWidth)+";"),(b["min-height"]||b.minHeight)&&(d+="min-height: "+(b["min-height"]||b.minHeight)+";"),(b["max-height"]||b.maxHeight)&&(d+="max-height: "+(b["max-height"]||b.maxHeight)+";"),b.offsets&&(b.offsets.top&&b.offsets.bottom?d+="margin-top:"+(parseInt(b.offsets.top)-parseInt(b.offsets.bottom))+"px;":b.offsets.top?d+="margin-top:"+parseInt(b.offsets.top)+"px;":b.offsets.bottom&&(d+="margin-top:"+-1*parseInt(b.offsets.bottom)+"px;margin-bottom:"+parseInt(b.offsets.bottom)+"px;"),b.offsets.left&&b.offsets.right?d+="margin-left:"+(parseInt(b.offsets.left)-parseInt(b.offsets.right))+"px;":b.offsets.left?d+="margin-left:"+parseInt(b.offsets.left)+"px;margin-right:"+-1*parseInt(b.offsets.left)+"px":b.offsets.right&&(d+="margin-left:"+-1*parseInt(b.offsets.right)+"px;margin-right:"+parseInt(b.offsets.right)+"px;"));var e=$('<div id="steamPopup_'+b.popupNum+'" class="steam-popup hidden '+b.position.toLowerCase()+'" style="'+d+'"></div>');e.append(b.content),c.append(e),J.popupData["steamPopup_"+b.popupNum]=b;var f,g=function(a,c){if(f){f=null;try{if(J.repositionPopup(a,c,b),!a.hasClass("visible"))return;f=wikiMod.requestAnimationFrame(function(){g(a,c)})}catch(d){console.log("err",d)}}},h,i=b.stickey?!0:!1,j="click"===b.stickey,k="hover"===b.stickey,l=!1;a.hover(function(c){var d=this,i=function(){k&&(l=!0,e.attr("data-stuck","true")),J.showPopup.call(d,c,b),f=wikiMod.requestAnimationFrame(function(){g(e,a)})};b.delay&&!isNaN(b.delay)?h=setTimeout(function(){h=null,i()},b.delay):i()},function(a){if(!l){if(h){try{clearTimeout(h)}catch(c){}h=null}if(f){try{wikiMod.cancelAnimationFrame(f)}catch(c){}f=null}J.hidePopup.call(this,a,b)}});var m=function(c){if(l){if(l=!1,e.attr("data-stuck","false"),h){try{clearTimeout(h)}catch(d){}h=null}if(f){try{wikiMod.cancelAnimationFrame(f)}catch(d){}f=null}J.hidePopup.call(a,a,b)}},n=function(c){l||(l=!0,e.attr("data-stuck","true"),J.showPopup.call(a,a,b),f=wikiMod.requestAnimationFrame(function(){g(e,a)}))};return j&&a.click(n),(j||k)&&(e.on("click",m),e.on("click","*:not(a):not(button):not(input)",m)),I++,b.$target=a,b.$popupEl=e,e}},J.destroyPopup=function(a){var b=!0,c,d,e,f=$("#steam-popup-container");return a.attr("data-popup-id")?(c=a,e=a.attr("data-popup-id"),d=f.find("#"+e)):a.hasClass("steam-popup")?(d=a,e=d.attr("id").toString(),c=$('[data-popup-id="'+e+'"]')):b=!1,d&&d.length>0?d.remove():b=!1,c&&c.length>0?(J.popupData[c.attr("data-popup-id")]=void 0,delete J.popupData[c.attr("data-popup-id")],c.removeAttr("data-popup-id"),c.unbind("mouseenter mouseleave")):b=!1,b},J.destroyAllPopups=function(a){a.find("[data-popup-id]").each(function(){J.destroyPopup($(this))})},$.mlp={x:0,y:0},$(f),$.fn.ismouseover=function(a){var b=!1;return this.eq(0).each(function(){var a=$(this),c=a.is("iframe")?a.contents().find("body"):a,d=c.offset();b=d.left<=$.mlp.x&&d.left+c.outerWidth()>$.mlp.x&&d.top<=$.mlp.y&&d.top+c.outerHeight()>$.mlp.y}),b};var K=[{name:"width",handler:function(a){var b={el:a};return $(b.el).data("mutate-width")||$(b.el).data("mutate-width",$(b.el).width()),$(b.el).data("mutate-width")&&$(b.el).width()!=$(b.el).data("mutate-width")?($(b.el).data("mutate-width",$(b.el).width()),!0):!1}},{name:"height",handler:function(a){var b=a;return $(b).data("mutate-height")||$(b).data("mutate-height",$(b).height()),$(b).data("mutate-height")&&$(b).height()!=$(b).data("mutate-height")?($(b).data("mutate-height",$(b).height()),!0):void 0}},{name:"top",handler:function(a){return $(a).data("mutate-top")||$(a).data("mutate-top",$(a).css("top")),$(a).data("mutate-top")&&$(a).css("top")!=$(a).data("mutate-top")?($(a).data("mutate-top",$(a).css("top")),!0):void 0}},{name:"bottom",handler:function(a){return $(a).data("mutate-bottom")||$(a).data("mutate-bottom",$(a).css("bottom")),$(a).data("mutate-bottom")&&$(a).css("bottom")!=$(a).data("mutate-bottom")?($(a).data("mutate-bottom",$(a).css("bottom")),!0):void 0}},{name:"right",handler:function(a){return $(a).data("mutate-right")||$(a).data("mutate-right",$(a).css("right")),$(a).data("mutate-right")&&$(a).css("right")!=$(a).data("mutate-right")?($(a).data("mutate-right",$(a).css("right")),!0):void 0}},{name:"left",handler:function(a){return $(a).data("mutate-left")||$(a).data("mutate-left",$(a).css("left")),$(a).data("mutate-left")&&$(a).css("left")!=$(a).data("mutate-left")?($(a).data("mutate-left",$(a).css("left")),!0):void 0}},{name:"hide",handler:function(a){return $(a).is(":hidden")?!0:void 0}},{name:"show",handler:function(a){return $(a).is(":visible")?!0:void 0}},{name:"scrollHeight",handler:function(a){return $(a).data("prev-scrollHeight")||$(a).data("prev-scrollHeight",$(a)[0].scrollHeight),$(a).data("prev-scrollHeight")&&$(a)[0].scrollHeight!=$(a).data("prev-scrollHeight")?($(a).data("prev-scrollHeight",$(a)[0].scrollHeight),!0):void 0}},{name:"scrollWidth",handler:function(a){return $(a).data("prev-scrollWidth")||$(a).data("prev-scrollWidth",$(a)[0].scrollWidth),$(a).data("prev-scrollWidth")&&$(a)[0].scrollWidth!=$(a).data("prev-scrollWidth")?($(a).data("prev-scrollWidth",$(a)[0].scrollWidth),!0):void 0}},{name:"scrollTop",handler:function(a){return $(a).data("prev-scrollTop")||$(a).data("prev-scrollTop",$(a)[0].scrollTop()),$(a).data("prev-scrollTop")&&$(a)[0].scrollTop()!=$(a).data("prev-scrollTop")?($(a).data("prev-scrollTop",$(a)[0].scrollTop()),!0):void 0}},{name:"scrollLeft",handler:function(a){return $(a).data("prev-scrollLeft")||$(a).data("prev-scrollLeft",$(a)[0].scrollLeft()),$(a).data("prev-scrollLeft")&&$(a)[0].scrollLeft()!=$(a).data("prev-scrollLeft")?($(a).data("prev-scrollLeft",$(a)[0].scrollLeft()),!0):void 0}},{name:"offsetLeft",handler:function(a){var b=$(a);return b.data("prev-offsetLeft")||b.data("prev-offsetLeft",b.offset().left),b.data("prev-offsetLeft")&&b.offset().left!=b.data("prev-offsetLeft")?(b.data("prev-offsetLeft",b.offset().left),!0):void 0}},{name:"offsetTop",handler:function(a){var b=$(a);return b.data("prev-offsetTop")||b.data("prev-offsetTop",b.offset().top),b.data("prev-offsetTop")&&b.offset().top!=b.data("prev-offsetTop")?(b.data("prev-offsetTop",b.offset().top),!0):void 0}}];!function($){function a(){var c=b;"undefined"!=c.event_stack&&c.event_stack.length&&$.each(c.event_stack,function(a,c){b.add_event(c)}),c.event_stack=[],$.each(c.stack,function(a,b){$(b.selector).each(function(a,d){c.events[b.event_name](d)===!0?b.callback&&b.callback(d,b):b.false_callback&&b.false_callback(d,b)})}),setTimeout(a,b.speed)}var b={speed:100,event_stack:K,stack:[],events:{},add_event:function(a){b.events[a.name]=a.handler},add:function(a,c,d,e){b.stack[b.stack.length]={event_name:a,selector:c,callback:d,false_callback:e}}};a(),$.fn.extend({mutate:function(){var a=!1,c=arguments[1],d=this,e=arguments[2]?arguments[2]:function(){};return"extend"==arguments[0].toLowerCase()?(b.add_event(c),this):($.each($.trim(arguments[0]).split(" "),function(f,g){a=g,b.add(a,d,c,e)}),this)}})}($||jQuery);var L=!1,M,N=[],O=[],P=0,Q=0,R,S=!1,T=!1;x.MaxWorkers=1;var U=function(){!S&&T&&(L||j(),S=!0,setTimeout(function(){g()},100))};wikiMod.require(["wikimod.steamapi"],function(_steamAPI){steamAPI="object"==typeof _steamAPI&&"function"==typeof _steamAPI.resolveVanityURL?_steamAPI:l.wikiaSteamAPI||window.wikiaSteamAPI||l.SteamAPI||window.SteamAPI,T=!0,j(),$(function(){U()})}),$(function(){U()}),$(window).load(function(){var b=3e3;L&&S||(U(),b=4e3),setTimeout(function(){a.loadAllDeferredImages(!0)},b)});try{$.preloadThrobber()}catch(w){}}});